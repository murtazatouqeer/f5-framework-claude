name: planner-use-cases
display_name: Material & Production Planner Use Cases
display_name_vi: Các ca sử dụng hoạch định vật tư và sản xuất
version: "1.0"
domain: manufacturing
subdomain: inventory

description: |
  Use cases for material planners and production schedulers
  covering MRP, demand management, and supply planning.

actors:
  - id: material_planner
    name: Material Planner
    name_vi: Nhân viên hoạch định vật tư
    description: Plans material requirements and inventory levels

  - id: production_planner
    name: Production Planner
    name_vi: Nhân viên hoạch định sản xuất
    description: Plans and schedules production orders

  - id: demand_planner
    name: Demand Planner
    name_vi: Nhân viên hoạch định nhu cầu
    description: Manages demand forecasts and planning

  - id: master_scheduler
    name: Master Scheduler
    name_vi: Người lập lịch tổng thể
    description: Manages master production schedule

  - id: inventory_analyst
    name: Inventory Analyst
    name_vi: Chuyên viên phân tích tồn kho
    description: Analyzes inventory performance and optimization

use_cases:
  # ============================================
  # MRP USE CASES
  # ============================================
  - id: UC-PL-001
    name: Execute MRP Run
    name_vi: Thực thi MRP
    actor: material_planner
    priority: high

    description: |
      Run Material Requirements Planning to calculate material
      needs and generate planned orders.

    preconditions:
      - Master data current and valid
      - Demand loaded (orders, forecasts)
      - Previous MRP messages processed

    main_flow:
      - step: 1
        action: Review pre-run checklist
        system_action: Display data validation status
      - step: 2
        action: Set MRP parameters
        system_action: Configure scope, horizon, processing key
      - step: 3
        action: Initiate MRP run
        system_action: Execute MRP calculation engine
      - step: 4
        action: Monitor run progress
        system_action: Display processing status
      - step: 5
        action: Review completion statistics
        system_action: Show items processed, exceptions
      - step: 6
        action: Generate exception report
        system_action: List action messages by priority

    alternative_flows:
      - id: AF1
        name: Data Validation Error
        trigger: Critical master data issues found
        steps:
          - Stop MRP run
          - Generate error report
          - Correct data issues
          - Re-run MRP

    postconditions:
      - Planned orders generated
      - Exception messages created
      - Net requirements calculated

  - id: UC-PL-002
    name: Process MRP Exceptions
    name_vi: Xử lý ngoại lệ MRP
    actor: material_planner
    priority: high

    description: |
      Review and act on MRP exception messages to ensure
      supply meets demand requirements.

    preconditions:
      - MRP run completed
      - Exception messages generated

    main_flow:
      - step: 1
        action: Open exception worklist
        system_action: Display prioritized exceptions
      - step: 2
        action: Filter by priority/type
        system_action: Apply filter criteria
      - step: 3
        action: Review exception details
        system_action: Show supply/demand situation
      - step: 4
        action: Determine resolution action
        system_action: Display available actions
      - step: 5
        action: Execute action (expedite/defer/cancel)
        system_action: Update order or create task
      - step: 6
        action: Document resolution
        system_action: Log action taken
      - step: 7
        action: Mark exception processed
        system_action: Update exception status

    exception_types:
      - type: Expedite
        action: Contact supplier or reschedule production earlier
      - type: Defer
        action: Push out delivery to avoid excess inventory
      - type: Cancel
        action: Evaluate cancellation of unneeded orders
      - type: Past Due
        action: Immediate attention to supply shortage
      - type: Below Safety Stock
        action: Expedite replenishment

    postconditions:
      - Exceptions resolved or escalated
      - Actions documented
      - Supply plan updated

  - id: UC-PL-003
    name: Convert Planned to Firm Orders
    name_vi: Chuyển đổi đơn hàng theo kế hoạch thành đơn hàng chắc chắn
    actor: material_planner
    priority: high

    description: |
      Review and firm planned orders to prevent regeneration
      by future MRP runs, then release to execution.

    preconditions:
      - Planned orders exist within firm horizon
      - Supply/demand validated

    main_flow:
      - step: 1
        action: Review planned orders
        system_action: Display orders within firm horizon
      - step: 2
        action: Verify quantities and dates
        system_action: Check against current demand
      - step: 3
        action: Adjust if needed
        system_action: Modify quantity, date, source
      - step: 4
        action: Firm planned orders
        system_action: Set firm indicator
      - step: 5
        action: Release for execution
        system_action: Convert to requisition or production order

    postconditions:
      - Orders firmed
      - Converted to executable orders
      - Commitment created

  # ============================================
  # DEMAND MANAGEMENT USE CASES
  # ============================================
  - id: UC-PL-004
    name: Manage Demand Forecast
    name_vi: Quản lý dự báo nhu cầu
    actor: demand_planner
    priority: high

    description: |
      Create and maintain demand forecasts that drive
      material and production planning.

    preconditions:
      - Historical sales data available
      - Planning period defined

    main_flow:
      - step: 1
        action: Review historical demand
        system_action: Display demand history and trends
      - step: 2
        action: Generate statistical forecast
        system_action: Apply forecasting algorithms
      - step: 3
        action: Review and adjust forecast
        system_action: Allow manual overrides
      - step: 4
        action: Incorporate market intelligence
        system_action: Add promotional, seasonal factors
      - step: 5
        action: Validate with sales team
        system_action: Share for collaboration
      - step: 6
        action: Release forecast to planning
        system_action: Load into MRP demand

    alternative_flows:
      - id: AF1
        name: New Product Launch
        trigger: No history for new product
        steps:
          - Use analogous products
          - Apply launch curve
          - Set review frequency higher

    postconditions:
      - Forecast loaded
      - Available for MRP
      - Accuracy tracking enabled

  - id: UC-PL-005
    name: Perform Demand-Supply Balancing
    name_vi: Cân bằng cung-cầu
    actor: master_scheduler
    priority: high

    description: |
      Balance aggregate demand against supply capacity
      to identify gaps and develop resolution plans.

    preconditions:
      - Demand plan loaded
      - Capacity constraints defined

    main_flow:
      - step: 1
        action: Load demand plan
        system_action: Aggregate demand by period
      - step: 2
        action: Load supply capacity
        system_action: Aggregate available capacity
      - step: 3
        action: Compare demand vs supply
        system_action: Calculate gaps by period
      - step: 4
        action: Identify constraint periods
        system_action: Highlight under/over capacity
      - step: 5
        action: Develop resolution options
        system_action: Simulate alternatives
      - step: 6
        action: Select and implement plan
        system_action: Update master schedule

    resolution_options:
      - Shift demand between periods
      - Add capacity (overtime, outsource)
      - Prioritize high-value orders
      - Build inventory in advance

    postconditions:
      - Demand-supply balanced
      - Master schedule updated
      - Commitments communicated

  # ============================================
  # INVENTORY PLANNING USE CASES
  # ============================================
  - id: UC-PL-006
    name: Set Safety Stock Levels
    name_vi: Thiết lập mức tồn kho an toàn
    actor: inventory_analyst
    priority: medium

    description: |
      Calculate and maintain safety stock levels to buffer
      against demand and supply variability.

    preconditions:
      - Historical demand data available
      - Service level targets defined

    main_flow:
      - step: 1
        action: Analyze demand variability
        system_action: Calculate demand standard deviation
      - step: 2
        action: Analyze lead time variability
        system_action: Calculate lead time variation
      - step: 3
        action: Set service level target
        system_action: Define target fill rate
      - step: 4
        action: Calculate safety stock
        system_action: Apply statistical formula
      - step: 5
        action: Review and adjust
        system_action: Consider business constraints
      - step: 6
        action: Update material master
        system_action: Set safety stock quantity

    formulas:
      basic: SS = Z × σ_demand × √(LT)
      with_lt_variability: SS = Z × √(LT × σ_d² + d² × σ_LT²)

    postconditions:
      - Safety stock calculated
      - Material master updated
      - MRP will maintain levels

  - id: UC-PL-007
    name: Perform ABC-XYZ Classification
    name_vi: Phân loại ABC-XYZ
    actor: inventory_analyst
    priority: medium

    description: |
      Classify inventory by value (ABC) and demand variability (XYZ)
      to optimize inventory strategies.

    preconditions:
      - Transaction history available
      - Classification thresholds defined

    main_flow:
      - step: 1
        action: Extract usage data
        system_action: Pull consumption history
      - step: 2
        action: Calculate ABC classification
        system_action: Rank by annual consumption value
      - step: 3
        action: Calculate XYZ classification
        system_action: Rank by coefficient of variation
      - step: 4
        action: Generate classification matrix
        system_action: Combine ABC and XYZ
      - step: 5
        action: Review and validate
        system_action: Allow manual overrides
      - step: 6
        action: Update material classifications
        system_action: Store in material master

    classification_rules:
      ABC:
        A: Top 80% of value (typically 20% of items)
        B: Next 15% of value (typically 30% of items)
        C: Remaining 5% of value (typically 50% of items)
      XYZ:
        X: CV < 0.5 (stable demand)
        Y: CV 0.5-1.0 (moderate variability)
        Z: CV > 1.0 (highly variable)

    postconditions:
      - Items classified
      - Inventory strategies defined
      - Count frequencies set

  - id: UC-PL-008
    name: Plan Inventory Optimization
    name_vi: Lập kế hoạch tối ưu hóa tồn kho
    actor: inventory_analyst
    priority: medium

    description: |
      Analyze inventory levels and develop plans to optimize
      working capital while maintaining service levels.

    preconditions:
      - Current inventory visible
      - Classification complete
      - Targets defined

    main_flow:
      - step: 1
        action: Analyze current inventory
        system_action: Calculate DOS, turns, excess
      - step: 2
        action: Identify slow-moving items
        system_action: Flag items exceeding thresholds
      - step: 3
        action: Identify excess inventory
        system_action: Compare to demand coverage
      - step: 4
        action: Develop disposition plan
        system_action: Recommend actions by category
      - step: 5
        action: Calculate optimization potential
        system_action: Project working capital impact
      - step: 6
        action: Track execution
        system_action: Monitor progress against plan

    disposition_options:
      - Return to supplier
      - Sell at discount
      - Transfer to other locations
      - Scrap/write-off
      - Hold for future demand

    postconditions:
      - Optimization plan created
      - Actions assigned
      - Progress tracked

  # ============================================
  # PRODUCTION PLANNING USE CASES
  # ============================================
  - id: UC-PL-009
    name: Create Production Schedule
    name_vi: Tạo lịch sản xuất
    actor: production_planner
    priority: high

    description: |
      Develop detailed production schedule from MPS
      considering capacity constraints and sequencing.

    preconditions:
      - MPS approved
      - Capacity available
      - Materials planned

    main_flow:
      - step: 1
        action: Review production requirements
        system_action: Display MPS items for scheduling
      - step: 2
        action: Check material availability
        system_action: Verify component availability dates
      - step: 3
        action: Check capacity availability
        system_action: Display resource loading
      - step: 4
        action: Sequence production orders
        system_action: Apply scheduling rules
      - step: 5
        action: Level resource loading
        system_action: Balance across time periods
      - step: 6
        action: Release production orders
        system_action: Convert planned to released orders

    scheduling_rules:
      - Priority-based (customer due date)
      - Changeover minimization
      - Campaign scheduling
      - Pull-based (kanban)

    postconditions:
      - Schedule created
      - Orders released
      - Resources loaded

  - id: UC-PL-010
    name: Manage Production Order Changes
    name_vi: Quản lý thay đổi lệnh sản xuất
    actor: production_planner
    priority: high

    description: |
      Handle changes to production orders due to demand
      changes, material shortages, or capacity issues.

    preconditions:
      - Production order exists
      - Change requirement identified

    main_flow:
      - step: 1
        action: Identify change requirement
        system_action: Display order and issue details
      - step: 2
        action: Assess change impact
        system_action: Check downstream effects
      - step: 3
        action: Evaluate alternatives
        system_action: Simulate options
      - step: 4
        action: Communicate change
        system_action: Notify affected parties
      - step: 5
        action: Execute change
        system_action: Update order quantity/date
      - step: 6
        action: Update dependent plans
        system_action: Cascade changes to components

    change_types:
      - Quantity increase/decrease
      - Date change (expedite/defer)
      - Order cancellation
      - Priority change
      - Split order

    postconditions:
      - Order updated
      - Dependencies adjusted
      - Stakeholders notified

  # ============================================
  # SUPPLIER COLLABORATION USE CASES
  # ============================================
  - id: UC-PL-011
    name: Share Supplier Forecast
    name_vi: Chia sẻ dự báo với nhà cung cấp
    actor: material_planner
    priority: medium

    description: |
      Share demand forecasts with suppliers to enable
      better capacity planning and responsiveness.

    preconditions:
      - Supplier collaboration enabled
      - Forecast approved

    main_flow:
      - step: 1
        action: Generate supplier forecast
        system_action: Roll up demand by supplier/item
      - step: 2
        action: Review and validate
        system_action: Check reasonableness
      - step: 3
        action: Select communication method
        system_action: Portal, EDI, email
      - step: 4
        action: Transmit forecast
        system_action: Send to supplier
      - step: 5
        action: Receive supplier acknowledgment
        system_action: Log response
      - step: 6
        action: Discuss capacity constraints
        system_action: Schedule review meeting if needed

    postconditions:
      - Forecast shared
      - Supplier acknowledged
      - Constraints identified

  - id: UC-PL-012
    name: Manage Supplier Schedules
    name_vi: Quản lý lịch trình nhà cung cấp
    actor: material_planner
    priority: high

    description: |
      Create and manage delivery schedules for JIT/Kanban
      suppliers with frequent deliveries.

    preconditions:
      - Scheduling agreement exists
      - Delivery pattern defined

    main_flow:
      - step: 1
        action: Generate delivery schedule
        system_action: Calculate requirements by delivery window
      - step: 2
        action: Apply delivery rules
        system_action: Round to delivery multiples
      - step: 3
        action: Review schedule
        system_action: Display schedule horizon
      - step: 4
        action: Send schedule to supplier
        system_action: Transmit via agreed method
      - step: 5
        action: Monitor schedule performance
        system_action: Track deliveries against schedule
      - step: 6
        action: Manage schedule changes
        system_action: Process supplier change requests

    postconditions:
      - Schedule sent
      - Supplier confirmed
      - Tracking enabled

  # ============================================
  # ANALYSIS & REPORTING USE CASES
  # ============================================
  - id: UC-PL-013
    name: Monitor Planning KPIs
    name_vi: Theo dõi KPI hoạch định
    actor: material_planner
    priority: medium

    description: |
      Track and analyze planning performance metrics
      for continuous improvement.

    preconditions:
      - Transaction history available
      - KPI definitions configured

    main_flow:
      - step: 1
        action: Access planning dashboard
        system_action: Display KPI summary
      - step: 2
        action: Review key metrics
        system_action: Show trends and targets
      - step: 3
        action: Drill into problem areas
        system_action: Provide detailed analysis
      - step: 4
        action: Identify root causes
        system_action: Display contributing factors
      - step: 5
        action: Document improvement actions
        system_action: Create action items
      - step: 6
        action: Track action completion
        system_action: Monitor progress

    key_metrics:
      - Forecast accuracy
      - Inventory turns
      - Days of supply
      - Service level (fill rate)
      - MRP exception rate
      - Schedule adherence
      - Stock-out frequency

    postconditions:
      - Performance reviewed
      - Issues identified
      - Actions assigned

  - id: UC-PL-014
    name: Conduct Inventory Review
    name_vi: Thực hiện đánh giá tồn kho
    actor: inventory_analyst
    priority: medium

    description: |
      Periodic review of inventory health including
      excess, obsolete, and slow-moving analysis.

    preconditions:
      - Inventory data current
      - Review period defined

    main_flow:
      - step: 1
        action: Generate inventory report
        system_action: Extract inventory by category
      - step: 2
        action: Analyze aging
        system_action: Stratify by age bucket
      - step: 3
        action: Identify E&O (Excess & Obsolete)
        system_action: Flag items exceeding thresholds
      - step: 4
        action: Calculate reserve requirements
        system_action: Apply reserve policy
      - step: 5
        action: Present findings
        system_action: Generate review presentation
      - step: 6
        action: Get disposition approval
        system_action: Route for management approval
      - step: 7
        action: Execute dispositions
        system_action: Process approved actions

    e_and_o_criteria:
      excess: Inventory > 12 months demand
      slow_moving: No usage in 6 months
      obsolete: No future demand

    postconditions:
      - Review completed
      - Reserves calculated
      - Dispositions approved

compliance_mapping:
  - standard: SOX
    use_cases:
      - UC-PL-006
      - UC-PL-014
    requirements:
      - Inventory valuation accuracy
      - Reserve calculations
      - Documentation control

  - standard: ISO 9001
    use_cases:
      - UC-PL-001
      - UC-PL-002
      - UC-PL-013
    requirements:
      - Documented planning procedures
      - Supplier evaluation data
      - Performance monitoring

integration_points:
  - system: ERP
    use_cases: all
    features:
      - MRP engine
      - Production scheduling
      - Inventory management

  - system: Demand Planning
    use_cases:
      - UC-PL-004
      - UC-PL-005
    features:
      - Forecast generation
      - Collaboration workflow

  - system: Supplier Portal
    use_cases:
      - UC-PL-011
      - UC-PL-012
    features:
      - Forecast sharing
      - Schedule management
