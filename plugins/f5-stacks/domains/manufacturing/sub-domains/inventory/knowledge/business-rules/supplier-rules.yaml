name: supplier-rules
display_name: Supplier Management Rules
display_name_vi: Quy tắc quản lý nhà cung cấp
version: "1.0"
domain: manufacturing
subdomain: inventory

description: |
  Business rules for supplier qualification, evaluation, performance
  management, and procurement restrictions. Ensures quality and
  compliance in the supply chain.

rule_categories:
  - qualification_rules
  - evaluation_rules
  - procurement_rules
  - performance_rules
  - compliance_rules

rules:
  # ============================================
  # QUALIFICATION RULES
  # ============================================
  - id: SUP-Q001
    name: New Supplier Qualification
    category: qualification_rules
    priority: critical
    description: |
      Requirements for qualifying new suppliers.
    requirements:
      mandatory:
        - Valid business registration
        - Tax ID verification
        - Financial stability check
        - Quality management system (ISO 9001 preferred)
        - Completed supplier questionnaire
      conditional:
        - ISO 14001 (for environmental-sensitive materials)
        - FDA approval (for food/pharma)
        - Hazmat certification (for hazardous materials)
    process:
      - Submit application with documents
      - Preliminary screening (finance, legal)
      - Quality assessment
      - On-site audit (for strategic suppliers)
      - Qualification committee approval

  - id: SUP-Q002
    name: Supplier Status Classification
    category: qualification_rules
    priority: high
    description: |
      Classification of suppliers by qualification status.
    statuses:
      prospect:
        description: Under evaluation
        can_order: false
      pending_approval:
        description: Awaiting committee decision
        can_order: false
      approved:
        description: Qualified for ordering
        can_order: true
      conditionally_approved:
        description: Limited approval with restrictions
        can_order: true
        restrictions: Material/value limits apply
      blocked:
        description: Temporarily suspended
        can_order: false
      inactive:
        description: No longer active
        can_order: false

  - id: SUP-Q003
    name: Qualification Renewal
    category: qualification_rules
    priority: medium
    description: |
      Periodic renewal of supplier qualification.
    rules:
      strategic_suppliers:
        renewal_period: 12 months
        audit_required: true
        documents: Full package
      preferred_suppliers:
        renewal_period: 18 months
        audit_required: false
        documents: Updated certifications
      approved_suppliers:
        renewal_period: 24 months
        audit_required: false
        documents: Self-declaration
    actions_on_expiry:
      - Send 60-day warning
      - Send 30-day reminder
      - Block ordering at expiry
      - Notify procurement team

  - id: SUP-Q004
    name: Certification Requirements
    category: qualification_rules
    priority: high
    description: |
      Required certifications by material category.
    requirements:
      raw_materials:
        required: [ISO 9001]
        preferred: [ISO 14001, IATF 16949]
      food_ingredients:
        required: [ISO 22000, FSSC 22000]
        preferred: [BRC, SQF]
      chemicals:
        required: [ISO 9001, Hazmat License]
        preferred: [ISO 14001, REACH compliance]
      electronics:
        required: [ISO 9001]
        preferred: [RoHS compliance, IATF 16949]

  # ============================================
  # EVALUATION RULES
  # ============================================
  - id: SUP-E001
    name: Supplier Performance Evaluation
    category: evaluation_rules
    priority: high
    description: |
      Periodic evaluation of supplier performance.
    frequency:
      strategic: Monthly
      preferred: Quarterly
      approved: Semi-annually
    dimensions:
      quality:
        weight: 40%
        metrics:
          - Defect rate (PPM)
          - Incoming inspection pass rate
          - Customer complaints traced to supplier
          - Certificate of Analysis accuracy
      delivery:
        weight: 30%
        metrics:
          - On-time delivery rate
          - Quantity accuracy
          - Lead time compliance
          - ASN accuracy
      price:
        weight: 15%
        metrics:
          - Price competitiveness
          - Cost reduction initiatives
          - Price stability
          - Payment terms
      service:
        weight: 15%
        metrics:
          - Responsiveness
          - Problem resolution
          - Technical support
          - Flexibility

  - id: SUP-E002
    name: Supplier Rating Calculation
    category: evaluation_rules
    priority: medium
    description: |
      Calculate overall supplier rating.
    formula: |
      Overall_Rating =
        (Quality_Score × 0.40) +
        (Delivery_Score × 0.30) +
        (Price_Score × 0.15) +
        (Service_Score × 0.15)

      Each score on 1-5 scale
    rating_classification:
      - range: "4.5 - 5.0"
        class: "A (Excellent)"
        action: Increase business share
      - range: "4.0 - 4.4"
        class: "B (Good)"
        action: Maintain relationship
      - range: "3.0 - 3.9"
        class: "C (Acceptable)"
        action: Improvement plan required
      - range: "< 3.0"
        class: "D (Poor)"
        action: Consider phase-out

  - id: SUP-E003
    name: Automatic Downgrade
    category: evaluation_rules
    priority: critical
    description: |
      Automatic supplier status downgrade triggers.
    triggers:
      immediate_block:
        - Major quality incident (safety/recall)
        - Fraud or unethical behavior
        - Bankruptcy or insolvency
        - License revocation
      probation:
        - 3 consecutive months below target OTD
        - Quality rejection rate > 5%
        - 2+ critical NCRs in 6 months
        - Failed audit
      warning:
        - Single month significantly below target
        - Repeated minor issues
        - Certification lapse

  # ============================================
  # PROCUREMENT RULES
  # ============================================
  - id: SUP-P001
    name: Approved Supplier List (ASL)
    category: procurement_rules
    priority: critical
    description: |
      Orders can only be placed with approved suppliers.
    rule: |
      FOR all Purchase Orders:
        Supplier.status IN ('approved', 'conditionally_approved')
        AND Material IN Supplier.approved_materials
        AND NOT Supplier.blocked
    exceptions:
      - Emergency procurement (requires VP approval)
      - Single source situations
      - Samples for evaluation

  - id: SUP-P002
    name: Source Selection Priority
    category: procurement_rules
    priority: high
    description: |
      Priority for selecting suppliers.
    priority_order:
      1: Contract suppliers (with valid agreement)
      2: Strategic suppliers
      3: Preferred suppliers
      4: Approved suppliers
      5: New source (requires approval)
    selection_criteria:
      - Price competitiveness
      - Quality rating
      - Delivery reliability
      - Available capacity
      - Risk profile

  - id: SUP-P003
    name: Sole Source Requirements
    category: procurement_rules
    priority: high
    description: |
      Rules for single source materials.
    requirements:
      documentation:
        - Justification for sole source
        - Risk assessment
        - Contingency plan
      approval:
        - Procurement Manager (< $50,000/year)
        - Director (< $200,000/year)
        - VP Supply Chain (> $200,000/year)
      review:
        - Annual review of sole source status
        - Alternative development plan

  - id: SUP-P004
    name: Multi-Source Requirements
    category: procurement_rules
    priority: medium
    description: |
      Requirements for multi-sourcing critical materials.
    rule: |
      FOR Material.criticality = 'critical':
        MIN 2 qualified suppliers required
        Primary supplier share <= 70%
        Secondary supplier regularly tested
    rationale: Supply chain risk mitigation

  # ============================================
  # PERFORMANCE RULES
  # ============================================
  - id: SUP-PF001
    name: On-Time Delivery (OTD) Standard
    category: performance_rules
    priority: high
    description: |
      On-time delivery performance standard.
    definition: |
      On-Time = Actual_Delivery_Date <= Promised_Date

      Window: +/- 1 day for domestic
              +/- 3 days for international
    targets:
      strategic_suppliers: ">= 98%"
      preferred_suppliers: ">= 95%"
      approved_suppliers: ">= 90%"
    consequences:
      below_target:
        - Root cause analysis required
        - Corrective action plan
        - Increased monitoring
        - Potential chargeback

  - id: SUP-PF002
    name: Quality Performance Standard
    category: performance_rules
    priority: critical
    description: |
      Quality performance requirements.
    metrics:
      defect_rate:
        measurement: Parts Per Million (PPM)
        targets:
          Class_A: "< 100 PPM"
          Class_B: "< 500 PPM"
          Class_C: "< 1000 PPM"
      lot_acceptance:
        measurement: Percent of lots accepted
        target: ">= 99%"
    consequences:
      exceeds_target:
        - Supplier quality hold
        - 100% inspection at supplier
        - Chargeback for sorting costs
        - Corrective action request (CAR)

  - id: SUP-PF003
    name: Supplier Improvement Plans
    category: performance_rules
    priority: medium
    description: |
      Required improvement plans for underperforming suppliers.
    trigger: |
      Supplier_Rating < 3.5
      OR OTD < target for 3 consecutive months
      OR Quality PPM > 2x target
    requirements:
      - Root cause analysis
      - Corrective actions with timeline
      - Preventive measures
      - Progress milestones
      - Regular review meetings
    timeline: 90 days to show improvement
    escalation: Consider phase-out if no improvement

  # ============================================
  # COMPLIANCE RULES
  # ============================================
  - id: SUP-C001
    name: Supplier Code of Conduct
    category: compliance_rules
    priority: critical
    description: |
      All suppliers must agree to code of conduct.
    requirements:
      - Signed acknowledgment on file
      - Annual reconfirmation
      - Right to audit clause
    areas_covered:
      - Legal compliance
      - Labor practices
      - Environmental responsibility
      - Anti-corruption
      - Conflict minerals
      - Data protection

  - id: SUP-C002
    name: Supplier Audit Requirements
    category: compliance_rules
    priority: high
    description: |
      Supplier audit requirements by classification.
    requirements:
      strategic_suppliers:
        frequency: Annual
        type: Full on-site audit
        auditor: Internal or third-party
      high_risk_suppliers:
        frequency: Every 18 months
        type: Risk-based audit
        auditor: Internal
      new_suppliers:
        frequency: Before qualification
        type: Initial qualification audit
        auditor: Internal
    findings_management:
      - Major findings: Block until resolved
      - Minor findings: 30-day resolution
      - Observations: Track and review

  - id: SUP-C003
    name: Document Retention
    category: compliance_rules
    priority: medium
    description: |
      Supplier document retention requirements.
    retention_periods:
      contracts: 7 years after expiry
      quality_records: 10 years
      audit_reports: 7 years
      evaluations: 5 years
      correspondence: 3 years

compliance:
  standards:
    - ISO 9001 (Purchasing)
    - ISO 14001 (Environmental)
    - SOX (Sarbanes-Oxley)
    - FCPA (Anti-corruption)

metrics:
  - name: Supplier Quality Index
    formula: Weighted average of supplier quality scores
    target: "> 95%"

  - name: Supplier On-Time Delivery
    formula: (On-time deliveries / Total deliveries) × 100
    target: "> 95%"

  - name: Supplier Count by Status
    formula: Count of suppliers by status
    monitor: Ensure adequate approved suppliers

  - name: Single Source Exposure
    formula: (Single source spend / Total spend) × 100
    target: "< 20%"
