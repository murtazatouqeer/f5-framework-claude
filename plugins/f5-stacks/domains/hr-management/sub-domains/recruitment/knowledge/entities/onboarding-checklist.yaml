name: onboarding-checklist
display_name: Onboarding Checklist
description: |
  Pre-hire and day-one onboarding tasks to prepare for a new hire.
  Bridges recruitment to employee management handoff.

domain: hr-management
subdomain: recruitment
category: entities
version: "1.0.0"
status: active

entity:
  name: OnboardingChecklist
  table_name: onboarding_checklists
  primary_key: id

  attributes:
    # Identity
    - name: id
      type: uuid
      primary_key: true

    - name: checklist_id
      type: string
      length: 20
      unique: true
      format: "OBC-{YYYYMMDD}-{NNNN}"

    - name: offer_id
      type: uuid
      required: true

    - name: candidate_id
      type: uuid
      required: true

    - name: application_id
      type: uuid
      required: true

    # Status
    - name: status
      type: enum
      values: [not_started, in_progress, completed, cancelled]
      default: not_started

    - name: phase
      type: enum
      values: [pre_offer, post_offer, pre_start, day_one, first_week]
      default: post_offer

    # New Hire Info
    - name: new_hire_name
      type: string
      length: 200
      required: true

    - name: new_hire_email
      type: string
      length: 255

    - name: personal_email
      type: string
      length: 255
      required: true
      description: Pre-company email for communication

    - name: job_title
      type: string
      length: 200
      required: true

    - name: department_id
      type: uuid
      required: true

    - name: start_date
      type: date
      required: true

    - name: location_id
      type: uuid

    - name: is_remote
      type: boolean
      default: false

    - name: hiring_manager_id
      type: uuid
      required: true

    # Template
    - name: template_id
      type: uuid
      description: Onboarding template used

    - name: template_name
      type: string
      length: 200

    # Tasks
    - name: tasks
      type: jsonb
      description: Onboarding tasks
      example: |
        [
          {
            "id": "task_1",
            "category": "hr_paperwork",
            "name": "Send offer letter",
            "description": "Generate and send official offer letter",
            "assignee_type": "recruiter",
            "assignee_id": "xxx",
            "due_date": "2024-01-10",
            "status": "completed",
            "completed_at": "2024-01-09",
            "completed_by_id": "xxx",
            "phase": "pre_offer"
          },
          {
            "id": "task_2",
            "category": "it_setup",
            "name": "Create email account",
            "description": "Set up company email and workspace accounts",
            "assignee_type": "it",
            "assignee_id": "yyy",
            "due_date": "2024-01-15",
            "status": "pending",
            "phase": "pre_start"
          }
        ]

    - name: total_tasks
      type: integer
      default: 0

    - name: completed_tasks
      type: integer
      default: 0

    - name: completion_percent
      type: decimal
      precision: 5
      scale: 2
      computed: true

    # Task Categories Summary
    - name: category_progress
      type: jsonb
      description: Progress by category
      example: |
        {
          "hr_paperwork": {"total": 5, "completed": 3},
          "it_setup": {"total": 4, "completed": 1},
          "facilities": {"total": 2, "completed": 0},
          "team_intro": {"total": 3, "completed": 0}
        }

    # Key Dates
    - name: offer_accepted_at
      type: timestamp

    - name: background_check_completed_at
      type: timestamp

    - name: employee_id_created_at
      type: timestamp
      description: When employee record was created

    - name: equipment_ordered_at
      type: timestamp

    - name: access_provisioned_at
      type: timestamp

    # Assignments
    - name: hr_coordinator_id
      type: uuid
      description: HR person managing onboarding

    - name: it_assignee_id
      type: uuid

    - name: facilities_assignee_id
      type: uuid

    - name: buddy_id
      type: uuid
      description: Assigned onboarding buddy

    # Documents Collected
    - name: documents_collected
      type: jsonb
      description: Required documents status
      example: |
        {
          "i9_form": {"required": true, "received": false},
          "w4_form": {"required": true, "received": false},
          "direct_deposit": {"required": true, "received": false},
          "emergency_contact": {"required": true, "received": false},
          "nda": {"required": true, "received": true, "signed_at": "..."},
          "employee_handbook_ack": {"required": true, "received": false}
        }

    - name: all_documents_received
      type: boolean
      default: false

    # Equipment
    - name: equipment_list
      type: jsonb
      description: Equipment to provision
      example: |
        [
          {"item": "Laptop", "model": "MacBook Pro 14", "status": "ordered", "tracking": "xxx"},
          {"item": "Monitor", "model": "Dell 27\"", "status": "ready"},
          {"item": "Headset", "model": "Jabra", "status": "ready"}
        ]

    - name: equipment_ready
      type: boolean
      default: false

    # Workspace
    - name: workspace_type
      type: enum
      values: [office_desk, remote, hybrid]

    - name: desk_location
      type: string
      length: 100

    - name: parking_assigned
      type: boolean
      default: false

    - name: badge_created
      type: boolean
      default: false

    # Systems Access
    - name: systems_access
      type: jsonb
      description: System access to provision
      example: |
        [
          {"system": "Email", "status": "created", "username": "john.doe@company.com"},
          {"system": "Slack", "status": "pending"},
          {"system": "Jira", "status": "pending"},
          {"system": "GitHub", "status": "created"}
        ]

    - name: all_access_provisioned
      type: boolean
      default: false

    # Notifications
    - name: welcome_email_sent
      type: boolean
      default: false

    - name: welcome_email_sent_at
      type: timestamp

    - name: first_day_instructions_sent
      type: boolean
      default: false

    - name: team_notified
      type: boolean
      default: false

    # Handoff
    - name: handoff_to_employee_management
      type: boolean
      default: false

    - name: handoff_at
      type: timestamp

    - name: employee_record_id
      type: uuid
      description: Created employee record

    # Notes
    - name: notes
      type: text

    - name: special_requirements
      type: text
      description: Any special accommodations or requirements

    # Timestamps
    - name: created_at
      type: timestamp
      required: true
      default: now()

    - name: updated_at
      type: timestamp
      required: true
      default: now()

  relationships:
    - name: offer
      type: belongs_to
      entity: Offer
      foreign_key: offer_id

    - name: candidate
      type: belongs_to
      entity: Candidate
      foreign_key: candidate_id

    - name: application
      type: belongs_to
      entity: Application
      foreign_key: application_id

    - name: department
      type: belongs_to
      entity: Department
      foreign_key: department_id

    - name: hiring_manager
      type: belongs_to
      entity: User
      foreign_key: hiring_manager_id

    - name: hr_coordinator
      type: belongs_to
      entity: User
      foreign_key: hr_coordinator_id

    - name: buddy
      type: belongs_to
      entity: Employee
      foreign_key: buddy_id

    - name: employee_record
      type: belongs_to
      entity: Employee
      foreign_key: employee_record_id

  indexes:
    - columns: [checklist_id]
      unique: true
    - columns: [offer_id]
    - columns: [candidate_id]
    - columns: [status]
    - columns: [start_date]
    - columns: [hr_coordinator_id]

  state_machine:
    field: status
    initial: not_started
    transitions:
      - from: not_started
        to: in_progress
        action: start
        triggers: [create_tasks, assign_owners, send_notifications]

      - from: in_progress
        to: completed
        action: complete
        guards: [all_required_tasks_done]
        triggers: [handoff_to_hr, create_employee_record]

      - from: [not_started, in_progress]
        to: cancelled
        action: cancel
        triggers: [cancel_pending_tasks, notify_stakeholders]

  hooks:
    on_offer_accepted:
      - create_checklist_from_template
      - calculate_task_due_dates
      - assign_task_owners
      - send_initial_notifications

    on_task_completed:
      - update_completion_counts
      - check_category_completion
      - send_progress_notifications

    on_all_pre_start_complete:
      - send_first_day_instructions
      - notify_hiring_manager
      - prepare_day_one_schedule

    before_start_date:
      - verify_all_critical_tasks_complete
      - escalate_if_incomplete
      - send_reminders

  computed_fields:
    - name: completion_percent
      formula: "(completed_tasks / total_tasks) * 100"

    - name: days_until_start
      formula: "start_date - current_date"

    - name: on_track
      formula: "all_due_tasks_completed_or_not_overdue"

compliance:
  - standard: I9_compliance
    requirement: Complete I-9 within 3 days of start
  - standard: tax_forms
    requirement: W-4 before first paycheck
  - standard: policy_acknowledgments
    requirement: Employee handbook acknowledgment
