name: finance-use-cases
display_name: Finance Team Payroll Use Cases
description: |
  Use cases for finance team members managing payroll approvals,
  payments, accounting entries, and financial reporting.

domain: hr-management
subdomain: payroll
category: use-cases
version: "1.0.0"
status: active

actor:
  name: Finance Manager
  description: Finance team member responsible for payroll payments and accounting
  goals:
    - Approve payroll disbursements
    - Process salary payments
    - Maintain accurate accounting records
    - Ensure statutory compliance
    - Manage cash flow for payroll

use_cases:
  # Payroll Approval
  - id: UC-FIN-001
    name: review_payroll_for_approval
    title: Review Payroll Run for Approval
    description: Finance manager reviews payroll run before authorizing payment

    preconditions:
      - payroll_run_completed
      - hr_approval_received
      - pending_finance_approval

    main_flow:
      - step: 1
        action: Receive approval notification
        actor: finance_manager
      - step: 2
        action: Open payroll run for review
        actor: finance_manager
      - step: 3
        action: Review financial summary
        actor: finance_manager
        review_items:
          - total_gross_amount
          - total_net_disbursement
          - employer_insurance_contributions
          - tax_withholding_total
          - variance_from_budget
          - variance_from_previous_month
      - step: 4
        action: Review department breakdown
        actor: finance_manager
        view:
          - cost_by_department
          - headcount_by_department
      - step: 5
        action: Verify budget availability
        actor: finance_manager
        checks:
          - salary_budget
          - employer_contribution_budget
          - department_allocations
      - step: 6
        action: Review exception report
        actor: finance_manager
      - step: 7
        action: Make approval decision
        actor: finance_manager
        options:
          - approve
          - request_changes
          - reject_with_reason
      - step: 8
        action: Record approval with notes
        actor: finance_manager

    alternative_flows:
      - id: AF-001
        condition: request_changes
        steps:
          - Document required changes
          - Return to payroll admin
          - Track resubmission

    postconditions:
      - approval_decision_recorded
      - workflow_updated
      - stakeholders_notified

    sla:
      approval_time: 24_hours

  - id: UC-FIN-002
    name: approve_payment_authorization
    title: Authorize Payment Processing
    description: Authorize the release of funds for salary payment

    preconditions:
      - payroll_approved
      - bank_file_generated
      - funds_available

    main_flow:
      - step: 1
        action: Open payment authorization request
        actor: finance_manager
      - step: 2
        action: Verify bank file details
        actor: finance_manager
        verify:
          - total_amount_matches_approved
          - transaction_count_correct
          - file_format_correct
      - step: 3
        action: Confirm fund availability
        actor: finance_manager
        check:
          - company_account_balance
          - scheduled_outflows
          - cash_flow_impact
      - step: 4
        action: Authorize payment
        actor: finance_manager
        authorization:
          - digital_signature
          - approval_code
      - step: 5
        action: Release for submission
        actor: finance_manager

    postconditions:
      - payment_authorized
      - funds_reserved
      - ready_for_bank_submission

  # Payment Processing
  - id: UC-FIN-003
    name: submit_bank_payment
    title: Submit Payment to Bank
    description: Submit bank file for salary disbursement

    preconditions:
      - payment_authorized
      - bank_file_validated
      - bank_portal_accessible

    main_flow:
      - step: 1
        action: Open bank payment interface
        actor: finance_manager
      - step: 2
        action: Select submission method
        actor: finance_manager
        methods:
          - online_banking_portal
          - bank_api
          - sftp_upload
      - step: 3
        action: Upload bank file
        actor: finance_manager
      - step: 4
        action: Verify upload success
        actor: system
      - step: 5
        action: Enter authorization
        actor: finance_manager
        authorization:
          - otp_verification
          - token_authentication
      - step: 6
        action: Confirm submission
        actor: finance_manager
      - step: 7
        action: Record submission reference
        actor: finance_manager
        record:
          - bank_reference_number
          - submission_timestamp
      - step: 8
        action: Update system status
        actor: system

    postconditions:
      - bank_file_submitted
      - submission_recorded
      - monitoring_initiated

  - id: UC-FIN-004
    name: monitor_payment_status
    title: Monitor Payment Processing Status
    description: Track and confirm bank payment processing

    preconditions:
      - bank_file_submitted
      - awaiting_bank_confirmation

    main_flow:
      - step: 1
        action: Check payment status
        actor: finance_manager
        methods:
          - bank_portal
          - api_status_check
          - bank_statement
      - step: 2
        action: Review processing result
        actor: finance_manager
        results:
          - all_successful
          - partial_success
          - failed
      - step: 3
        action: Download bank response file
        actor: finance_manager
      - step: 4
        action: Reconcile with submitted file
        actor: system
      - step: 5
        action: Update individual payment statuses
        actor: system
      - step: 6
        action: Handle failed transactions
        actor: finance_manager
        actions:
          - identify_failure_reason
          - initiate_correction
          - schedule_retry

    alternative_flows:
      - id: AF-001
        condition: partial_failure
        steps:
          - List failed transactions
          - Investigate each failure
          - Process manual payments if needed
          - Update employee records

    postconditions:
      - payment_status_confirmed
      - payslips_updated
      - reconciliation_complete

  - id: UC-FIN-005
    name: process_manual_payment
    title: Process Manual Payment
    description: Process payment manually for failed or special transactions

    preconditions:
      - regular_payment_failed
      - manual_payment_authorized

    main_flow:
      - step: 1
        action: Identify employees requiring manual payment
        actor: finance_manager
      - step: 2
        action: Verify payment details
        actor: finance_manager
      - step: 3
        action: Initiate manual transfer
        actor: finance_manager
        methods:
          - individual_bank_transfer
          - cash_payment
          - check
      - step: 4
        action: Record payment reference
        actor: finance_manager
      - step: 5
        action: Update payslip status
        actor: finance_manager
      - step: 6
        action: Notify employee
        actor: system

    postconditions:
      - manual_payment_processed
      - records_updated

  # Statutory Payments
  - id: UC-FIN-006
    name: process_insurance_payment
    title: Process Insurance Contribution Payment
    description: Pay BHXH/BHYT/BHTN contributions to social insurance authority

    preconditions:
      - monthly_contributions_calculated
      - declaration_submitted

    main_flow:
      - step: 1
        action: Review contribution summary
        actor: finance_manager
        amounts:
          - employee_bhxh
          - employer_bhxh
          - employee_bhyt
          - employer_bhyt
          - employee_bhtn
          - employer_bhtn
          - total_payable
      - step: 2
        action: Verify against declaration
        actor: finance_manager
      - step: 3
        action: Initiate transfer to BHXH account
        actor: finance_manager
      - step: 4
        action: Record payment
        actor: finance_manager
        record:
          - payment_reference
          - payment_date
          - amount_paid
      - step: 5
        action: Update statutory report status
        actor: system

    postconditions:
      - insurance_contributions_paid
      - payment_recorded

    deadline: "By end of declaration month"

  - id: UC-FIN-007
    name: process_tax_payment
    title: Process Tax Payment to Treasury
    description: Pay withheld personal income tax to tax authority

    preconditions:
      - monthly_tax_calculated
      - tax_declaration_prepared

    main_flow:
      - step: 1
        action: Review tax withholding summary
        actor: finance_manager
        amounts:
          - total_pit_withheld
          - adjustments
          - net_payable
      - step: 2
        action: Verify against declaration
        actor: finance_manager
      - step: 3
        action: Initiate transfer to treasury
        actor: finance_manager
      - step: 4
        action: Record payment
        actor: finance_manager
      - step: 5
        action: Update tax filing status
        actor: system

    postconditions:
      - tax_payment_made
      - declaration_updated

    deadline: "By 20th of following month"

  # Accounting Integration
  - id: UC-FIN-008
    name: post_payroll_journal_entries
    title: Post Payroll Journal Entries
    description: Create accounting entries for payroll transactions

    preconditions:
      - payroll_finalized
      - payment_confirmed

    main_flow:
      - step: 1
        action: Generate journal entry preview
        actor: system
        entries:
          - salary_expense_by_department
          - employer_insurance_expense
          - tax_liability
          - insurance_liability
          - cash_or_bank_credit
      - step: 2
        action: Review entries
        actor: finance_manager
        review:
          - account_codes_correct
          - amounts_accurate
          - cost_center_allocation
      - step: 3
        action: Approve entries
        actor: finance_manager
      - step: 4
        action: Post to general ledger
        actor: system
      - step: 5
        action: Generate posting reference
        actor: system

    postconditions:
      - journal_entries_posted
      - gl_updated
      - reconciliation_data_created

  - id: UC-FIN-009
    name: reconcile_payroll_accounts
    title: Reconcile Payroll Accounts
    description: Reconcile payroll-related accounts with supporting records

    preconditions:
      - period_closed
      - all_payments_processed

    main_flow:
      - step: 1
        action: Generate reconciliation report
        actor: system
        report_items:
          - payroll_run_totals
          - bank_disbursements
          - statutory_payments
          - journal_entries
      - step: 2
        action: Compare totals
        actor: finance_manager
        comparisons:
          - payroll_vs_bank
          - payroll_vs_gl
          - declarations_vs_payments
      - step: 3
        action: Identify discrepancies
        actor: finance_manager
      - step: 4
        action: Investigate differences
        actor: finance_manager
      - step: 5
        action: Make adjusting entries if needed
        actor: finance_manager
      - step: 6
        action: Document reconciliation
        actor: finance_manager
      - step: 7
        action: Sign off on reconciliation
        actor: finance_manager

    postconditions:
      - accounts_reconciled
      - discrepancies_resolved
      - documentation_complete

    frequency: monthly

  # Budget Management
  - id: UC-FIN-010
    name: monitor_payroll_budget
    title: Monitor Payroll Budget
    description: Track payroll spending against budget

    preconditions:
      - budget_established
      - payroll_data_available

    main_flow:
      - step: 1
        action: Open budget dashboard
        actor: finance_manager
      - step: 2
        action: View budget vs actual
        actor: finance_manager
        views:
          - company_total
          - by_department
          - by_cost_category
      - step: 3
        action: Analyze variances
        actor: finance_manager
        variance_reasons:
          - headcount_changes
          - salary_revisions
          - overtime
          - bonuses
      - step: 4
        action: Generate variance report
        actor: system
      - step: 5
        action: Flag significant variances
        actor: finance_manager
      - step: 6
        action: Report to management
        actor: finance_manager

    postconditions:
      - budget_status_reviewed
      - variances_documented

    frequency: monthly

  - id: UC-FIN-011
    name: forecast_payroll_cost
    title: Forecast Payroll Costs
    description: Project future payroll costs for planning

    preconditions:
      - historical_data_available
      - planning_parameters_set

    main_flow:
      - step: 1
        action: Set forecast parameters
        actor: finance_manager
        parameters:
          - forecast_period
          - headcount_assumptions
          - salary_increase_rate
          - benefit_changes
      - step: 2
        action: Generate forecast
        actor: system
        forecast_elements:
          - base_salary_projection
          - allowances
          - employer_contributions
          - bonuses
          - total_employer_cost
      - step: 3
        action: Review scenarios
        actor: finance_manager
        scenarios:
          - base_case
          - high_growth
          - conservative
      - step: 4
        action: Compare to budget
        actor: finance_manager
      - step: 5
        action: Export forecast
        actor: finance_manager

    postconditions:
      - forecast_generated
      - scenarios_documented

  # Reporting
  - id: UC-FIN-012
    name: generate_financial_reports
    title: Generate Payroll Financial Reports
    description: Generate financial reports for management and audit

    preconditions:
      - data_available
      - user_has_permission

    main_flow:
      - step: 1
        action: Select report type
        actor: finance_manager
        reports:
          - payroll_summary
          - cost_by_department
          - employer_contribution_report
          - tax_withholding_summary
          - statutory_payment_report
          - budget_variance_report
          - headcount_and_cost_trend
      - step: 2
        action: Set report parameters
        actor: finance_manager
        parameters:
          - period_range
          - departments
          - cost_categories
      - step: 3
        action: Generate report
        actor: system
      - step: 4
        action: Review report
        actor: finance_manager
      - step: 5
        action: Export or distribute
        actor: finance_manager
        formats:
          - pdf
          - excel
          - dashboard

    postconditions:
      - report_generated
      - distribution_recorded

  - id: UC-FIN-013
    name: support_audit
    title: Support Payroll Audit
    description: Provide documentation and support for internal or external audit

    preconditions:
      - audit_scheduled
      - audit_scope_defined

    main_flow:
      - step: 1
        action: Receive audit request
        actor: finance_manager
      - step: 2
        action: Gather required documents
        actor: finance_manager
        documents:
          - payroll_run_summaries
          - bank_payment_records
          - statutory_declarations
          - journal_entries
          - reconciliations
          - approval_records
      - step: 3
        action: Prepare audit package
        actor: finance_manager
      - step: 4
        action: Provide to auditors
        actor: finance_manager
      - step: 5
        action: Respond to queries
        actor: finance_manager
      - step: 6
        action: Address findings
        actor: finance_manager
      - step: 7
        action: Document resolution
        actor: finance_manager

    postconditions:
      - audit_supported
      - findings_addressed

  # Year-End
  - id: UC-FIN-014
    name: year_end_payroll_close
    title: Year-End Payroll Financial Close
    description: Complete year-end payroll accounting activities

    preconditions:
      - all_periods_closed
      - statutory_filings_complete

    main_flow:
      - step: 1
        action: Review annual payroll totals
        actor: finance_manager
      - step: 2
        action: Verify all journal entries posted
        actor: finance_manager
      - step: 3
        action: Complete final reconciliations
        actor: finance_manager
      - step: 4
        action: Accrue outstanding items
        actor: finance_manager
        accruals:
          - unpaid_salaries
          - bonus_provisions
          - leave_liability
      - step: 5
        action: Generate year-end reports
        actor: finance_manager
      - step: 6
        action: Support year-end audit
        actor: finance_manager
      - step: 7
        action: Sign off on payroll accounts
        actor: finance_manager

    postconditions:
      - year_closed
      - accounts_finalized
      - ready_for_new_year

permissions:
  required_roles:
    - finance_manager
    - finance_director

  data_access:
    - payroll_financial_data
    - budget_information
    - accounting_records

  approval_limits:
    finance_manager:
      payment_approval: 500_000_000
    finance_director:
      payment_approval: unlimited

audit:
  all_approvals_logged: true
  payment_records_retained: 10_years
  financial_records_retained: 10_years
