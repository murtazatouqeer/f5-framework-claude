name: leave-rules
display_name: Leave Rules
description: |
  Business rules for leave management including entitlements,
  accrual, carry forward, and approval processes.

domain: hr-management
subdomain: core
category: business-rules
version: "1.0.0"
status: active

compliance:
  vietnam_labor_code:
    reference: "Law 45/2019/QH14"
    effective_date: "2021-01-01"
    key_articles:
      - article: 113
        topic: "Annual Leave"
      - article: 114
        topic: "Seniority Leave"
      - article: 115
        topic: "Personal Leave"
      - article: 137-141
        topic: "Maternity Leave"

rules:
  # Annual Leave Rules
  annual_leave:
    - id: LEV-ANN-001
      name: "Annual Leave Entitlement"
      description: "Base annual leave entitlement"
      priority: critical

      entitlement:
        standard: 12
        unit: "working_days"
        per: "year"

      eligibility:
        minimum_tenure: "12 months"

      proration:
        new_employees: true
        method: "monthly_accrual"
        formula: "12 / 12 * months_worked"

    - id: LEV-ANN-002
      name: "Seniority Leave"
      description: "Additional leave for long-service employees"
      priority: high

      entitlement:
        increment: 1
        unit: "day"
        per: "5 years of service"

      calculation:
        5_years: "+1 day"
        10_years: "+2 days"
        15_years: "+3 days"
        20_years: "+4 days"

      maximum: "No legal limit"

    - id: LEV-ANN-003
      name: "Hazardous Work Leave"
      description: "Additional leave for hazardous work"
      priority: high

      entitlement:
        heavy_hazardous: 14
        hazardous: 14
        unit: "working_days"

      eligibility:
        job_classification: "hazardous_work_list"

    - id: LEV-ANN-004
      name: "Annual Leave Accrual"
      description: "How annual leave is accumulated"
      priority: high

      accrual:
        method: "monthly"
        rate: 1
        unit: "day_per_month"

      timing:
        credit_date: "end_of_month"
        available_immediately: true

      rounding:
        method: "round_up_half_day"

    - id: LEV-ANN-005
      name: "Annual Leave Carry Forward"
      description: "Unused leave carry forward rules"
      priority: high

      carry_forward:
        allowed: true
        maximum: "company_policy"
        default_max: 5
        unit: "days"
        expiry: "end_of_q1_next_year"

      exceptions:
        prevented_by_employer:
          carry_forward: "full_balance"
          encashment: "allowed_if_not_taken"

    - id: LEV-ANN-006
      name: "Leave Encashment"
      description: "Unused leave payment on separation"
      priority: critical

      encashment:
        on_separation: true
        calculation: "daily_rate * unused_days"
        daily_rate: "monthly_salary / 26"

      timing:
        payment: "with_final_settlement"

  # Sick Leave Rules
  sick_leave:
    - id: LEV-SIC-001
      name: "Sick Leave Entitlement"
      description: "Paid sick leave from social insurance"
      priority: critical

      entitlement:
        paid_by: "social_insurance"
        rate: "75%"
        base: "salary_for_SI_contribution"

      duration_limits:
        si_contribution_under_15_years: 30
        si_contribution_15_to_30_years: 40
        si_contribution_over_30_years: 60
        unit: "days_per_year"

    - id: LEV-SIC-002
      name: "Sick Leave Documentation"
      description: "Required documentation for sick leave"
      priority: high

      requirements:
        1_to_3_days:
          medical_certificate: "recommended"
          self_declaration: "allowed"

        over_3_days:
          medical_certificate: "required"
          hospital_certificate: "if_hospitalized"

      submission:
        timing: "within_3_days_of_return"
        exception: "hospitalization"

    - id: LEV-SIC-003
      name: "Long-term Sick Leave"
      description: "Extended sick leave handling"
      priority: high

      long_term:
        definition: "over_30_consecutive_days"

      requirements:
        medical_board_review: true
        periodic_updates: "monthly"
        return_to_work_certificate: "required"

      company_obligation:
        hold_position: "as_per_law"
        maintain_benefits: true

  # Maternity Leave Rules
  maternity_leave:
    - id: LEV-MAT-001
      name: "Maternity Leave Entitlement"
      description: "Maternity leave for female employees"
      priority: critical

      entitlement:
        duration: 6
        unit: "months"
        includes: "prenatal_and_postnatal"

      timing:
        prenatal_maximum: "2 months before due date"
        flexible: "employee_choice_with_medical_advice"

      multiple_births:
        twins: "+30 days"
        each_additional: "+30 days"

    - id: LEV-MAT-002
      name: "Maternity Leave Pay"
      description: "Payment during maternity leave"
      priority: critical

      payment:
        source: "social_insurance"
        rate: "100%"
        base: "average_salary_6_months_before"

      lump_sum:
        amount: "2 x base salary"
        timing: "upon_childbirth"

    - id: LEV-MAT-003
      name: "Maternity Protection"
      description: "Job protection during maternity"
      priority: critical

      protection:
        termination_prohibited: true
        during: "pregnancy_and_leave"
        return_guarantee: true
        same_position: "if_available"
        equivalent_position: "if_not_available"

      nursing_break:
        duration: "60 minutes per day"
        until: "child_12_months"
        paid: true

    - id: LEV-MAT-004
      name: "Miscarriage Leave"
      description: "Leave for pregnancy loss"
      priority: critical

      entitlement:
        under_1_month: "10 days"
        1_to_3_months: "20 days"
        3_to_6_months: "40 days"
        over_6_months: "50 days"

      payment:
        source: "social_insurance"
        rate: "100%"

  # Paternity Leave Rules
  paternity_leave:
    - id: LEV-PAT-001
      name: "Paternity Leave Entitlement"
      description: "Paternity leave for male employees"
      priority: critical

      entitlement:
        normal_delivery: 5
        c_section: 7
        twins: 10
        triplets_or_more: 14
        unit: "working_days"

      timing:
        must_take: "within_30_days_of_birth"
        consecutive: false

      payment:
        source: "social_insurance"
        rate: "100%"

  # Personal Leave Rules
  personal_leave:
    - id: LEV-PER-001
      name: "Bereavement Leave"
      description: "Leave for family death"
      priority: critical

      entitlement:
        spouse_death: 3
        parent_death: 3
        child_death: 3
        unit: "paid_working_days"

      relationship:
        includes:
          - spouse
          - biological_parents
          - spouse_parents
          - biological_children
          - adopted_children

    - id: LEV-PER-002
      name: "Marriage Leave"
      description: "Leave for marriage"
      priority: critical

      entitlement:
        own_marriage: 3
        child_marriage: 1
        unit: "paid_working_days"

  # Unpaid Leave Rules
  unpaid_leave:
    - id: LEV-UNP-001
      name: "Unpaid Leave Policy"
      description: "Rules for unpaid leave"
      priority: medium

      approval:
        required: true
        authority:
          up_to_5_days: "manager"
          6_to_30_days: "department_head"
          over_30_days: "hr_director"

      limits:
        maximum_consecutive: "company_policy"
        default: 30
        unit: "days"

      impact:
        salary_deduction: true
        benefits:
          social_insurance: "may_affect"
          annual_leave_accrual: "paused"

  # Leave Request Rules
  leave_requests:
    - id: LEV-REQ-001
      name: "Advance Notice"
      description: "Required advance notice for leave"
      priority: high

      notice_periods:
        annual_leave:
          1_to_3_days: "1 day advance"
          4_to_7_days: "3 days advance"
          over_7_days: "7 days advance"

        unpaid_leave:
          any_duration: "7 days advance"

        emergency_leave:
          notice: "as_soon_as_possible"
          documentation: "within_3_days"

    - id: LEV-REQ-002
      name: "Approval Workflow"
      description: "Leave approval process"
      priority: high

      approval_chain:
        standard:
          - manager
          - hr_admin (notification)

        long_leave:
          threshold: "7_days"
          approvers:
            - manager
            - department_head
            - hr_admin (notification)

        director_reports:
          approvers:
            - ceo
            - hr_admin (notification)

    - id: LEV-REQ-003
      name: "Leave Conflicts"
      description: "Handling overlapping leave requests"
      priority: medium

      conflict_resolution:
        same_team:
          max_concurrent: "50%_of_team"
          priority:
            - pre_approved
            - longer_tenure
            - first_submitted

        critical_periods:
          blackout_dates: "company_defined"
          exception: "emergency_only"

    - id: LEV-REQ-004
      name: "Leave Cancellation"
      description: "Rules for cancelling approved leave"
      priority: medium

      by_employee:
        allowed: true
        notice: "reasonable_advance"
        approval: "automatic"

      by_employer:
        allowed: "exceptional_circumstances"
        compensation: "travel_expenses_if_incurred"
        notice: "as_early_as_possible"

  # Leave Balance Rules
  leave_balance:
    - id: LEV-BAL-001
      name: "Balance Calculation"
      description: "How leave balance is calculated"
      priority: high

      calculation:
        available = entitlement + carry_forward - used - pending

      display:
        real_time: true
        breakdown:
          - current_year_entitlement
          - carry_forward
          - used_this_year
          - pending_requests
          - available_balance

    - id: LEV-BAL-002
      name: "Negative Balance"
      description: "Rules for negative leave balance"
      priority: high

      prevention:
        allow_negative: false
        exception: "emergency_with_director_approval"

      recovery:
        method: "salary_deduction"
        timing: "next_payroll"
        rate: "daily_wage"

    - id: LEV-BAL-003
      name: "Year-End Processing"
      description: "Leave balance year-end processing"
      priority: high

      timing:
        calculation_date: "December 31"
        carry_forward_date: "January 1"

      process:
        - calculate_unused_balance
        - apply_carry_forward_limit
        - forfeit_excess
        - credit_new_entitlement
        - generate_reports

notifications:
  - event: leave_requested
    recipients: [approver]
    template: "leave_request_pending"

  - event: leave_approved
    recipients: [employee, team_members]
    template: "leave_approved"

  - event: leave_rejected
    recipients: [employee]
    template: "leave_rejected"

  - event: balance_low
    threshold: 2
    recipients: [employee]
    template: "leave_balance_low"

  - event: leave_expiring
    timing: [30, 7]
    recipients: [employee]
    template: "leave_expiring_reminder"

audit:
  enabled: true
  tracked_events:
    - leave_requests
    - approvals
    - cancellations
    - balance_adjustments
  retention: "7 years"
