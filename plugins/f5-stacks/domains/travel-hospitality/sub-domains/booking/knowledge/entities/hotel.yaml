name: hotel
display_name: Hotel
display_name_vi: Khách sạn
version: "1.0"
domain: travel-hospitality
subdomain: booking

description: |
  Hotel property master data including location, amenities,
  room types, and policies.

attributes:
  # Identification
  - name: id
    type: uuid
    primary_key: true

  - name: hotel_code
    type: string
    unique: true
    description: Supplier hotel code

  - name: giata_id
    type: string
    nullable: true
    description: GIATA property ID for mapping

  # Basic Info
  - name: name
    type: string
    required: true
    max_length: 200

  - name: name_local
    type: string
    nullable: true
    description: Name in local language

  - name: chain_code
    type: string
    nullable: true
    description: Hotel chain code

  - name: chain_name
    type: string
    nullable: true

  - name: brand_name
    type: string
    nullable: true

  # Status
  - name: status
    type: enum
    values: [active, inactive, temporarily_closed, permanently_closed]
    default: active

  # Classification
  - name: star_rating
    type: decimal
    precision: 2
    scale: 1
    min: 1
    max: 5
    description: Official star rating

  - name: property_type
    type: enum
    values: [hotel, resort, apartment, hostel, guesthouse, villa, boutique, motel]
    default: hotel

  - name: category
    type: enum
    values: [budget, economy, midscale, upscale, luxury]

  # Location
  - name: address_line_1
    type: string
    required: true

  - name: address_line_2
    type: string
    nullable: true

  - name: city
    type: string
    required: true

  - name: state_province
    type: string
    nullable: true

  - name: postal_code
    type: string
    nullable: true

  - name: country_code
    type: string
    length: 2
    required: true

  - name: country_name
    type: string

  - name: latitude
    type: decimal
    precision: 10
    scale: 7

  - name: longitude
    type: decimal
    precision: 10
    scale: 7

  - name: timezone
    type: string

  # Distances
  - name: airport_distance_km
    type: decimal
    nullable: true

  - name: nearest_airport_code
    type: string
    length: 3
    nullable: true

  - name: city_center_distance_km
    type: decimal
    nullable: true

  - name: beach_distance_km
    type: decimal
    nullable: true

  # Contact
  - name: phone
    type: string

  - name: fax
    type: string
    nullable: true

  - name: email
    type: email
    nullable: true

  - name: website_url
    type: string
    nullable: true

  # Facilities
  - name: total_rooms
    type: integer

  - name: floors
    type: integer
    nullable: true

  - name: year_built
    type: integer
    nullable: true

  - name: year_renovated
    type: integer
    nullable: true

  # Amenities
  - name: amenities
    type: array
    items:
      type: string
    description: |
      wifi, pool, gym, spa, restaurant, bar, parking,
      airport_shuttle, room_service, business_center,
      meeting_rooms, laundry, concierge, etc.

  - name: room_amenities
    type: array
    items:
      type: string
    description: |
      ac, tv, minibar, safe, hairdryer, coffee_maker,
      balcony, bathtub, etc.

  # Policies
  - name: check_in_time
    type: time
    default: "14:00"

  - name: check_out_time
    type: time
    default: "12:00"

  - name: early_check_in_available
    type: boolean
    default: false

  - name: late_check_out_available
    type: boolean
    default: false

  - name: cancellation_policy
    type: text
    description: Default cancellation policy

  - name: child_policy
    type: object
    properties:
      free_age_limit:
        type: integer
        default: 6
      extra_bed_available:
        type: boolean
      extra_bed_charge:
        type: decimal

  - name: pet_policy
    type: enum
    values: [not_allowed, allowed, allowed_with_fee]
    default: not_allowed

  - name: smoking_policy
    type: enum
    values: [non_smoking, smoking_rooms_available, all_smoking]
    default: non_smoking

  # Payment
  - name: accepted_payment_methods
    type: array
    items:
      type: string

  - name: prepayment_required
    type: boolean
    default: true

  # Media
  - name: images
    type: array
    items:
      type: object
      properties:
        url:
          type: string
        category:
          type: string
        caption:
          type: string

  - name: description
    type: text

  - name: description_short
    type: string
    max_length: 500

  # Ratings & Reviews
  - name: guest_rating
    type: decimal
    precision: 2
    scale: 1
    min: 0
    max: 10

  - name: review_count
    type: integer
    default: 0

  - name: tripadvisor_rating
    type: decimal
    nullable: true

  - name: booking_com_rating
    type: decimal
    nullable: true

  # Room Types
  - name: room_types
    type: array
    items:
      type: uuid
      foreign_key: room_type.id

  # Timestamps
  - name: created_at
    type: timestamp
    auto_set: true

  - name: updated_at
    type: timestamp
    auto_update: true

validations:
  - rule: star_rating >= 1 AND star_rating <= 5
    message: Star rating must be between 1 and 5

  - rule: guest_rating >= 0 AND guest_rating <= 10
    message: Guest rating must be between 0 and 10

  - rule: latitude >= -90 AND latitude <= 90
    message: Invalid latitude

  - rule: longitude >= -180 AND longitude <= 180
    message: Invalid longitude

relationships:
  - name: room_types
    type: has_many
    entity: room_type
    foreign_key: hotel_id

  - name: reservations
    type: has_many
    entity: hotel_reservation
    foreign_key: hotel_id

indexes:
  - name: idx_hotel_code
    columns: [hotel_code]
    unique: true

  - name: idx_hotel_location
    columns: [city, country_code]

  - name: idx_hotel_geo
    columns: [latitude, longitude]
    type: spatial

  - name: idx_hotel_chain
    columns: [chain_code]

  - name: idx_hotel_rating
    columns: [star_rating, guest_rating]

  - name: idx_hotel_status
    columns: [status]

computed_fields:
  - name: full_address
    formula: |
      CONCAT_WS(', ', address_line_1, city, state_province, country_name)

  - name: display_rating
    formula: |
      CONCAT(star_rating, '-star, ', guest_rating, '/10 guest rating')

  - name: has_pool
    formula: "'pool' IN amenities"

  - name: has_free_wifi
    formula: "'wifi' IN amenities"

business_rules:
  - id: BR-HTL-001
    name: Rating Display
    rule: Show both star rating and guest rating where available

  - id: BR-HTL-002
    name: Image Requirements
    rule: Minimum 5 images required for listing

  - id: BR-HTL-003
    name: Location Accuracy
    rule: GPS coordinates must be verified accurate to property

events:
  - name: hotel.updated
    payload: [id, hotel_code, updated_fields]

  - name: hotel.status_changed
    payload: [id, old_status, new_status]
