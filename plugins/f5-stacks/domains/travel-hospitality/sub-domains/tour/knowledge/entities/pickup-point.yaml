name: PickupPoint
display_name: Pickup Point / Điểm đón khách
description: |
  Designated location where guests can be picked up before a tour.
  Used for tours offering hotel pickup or central meeting points.

domain: travel-hospitality
subdomain: tour
category: supporting

attributes:
  - name: id
    type: uuid
    required: true

  - name: tour_id
    type: uuid
    required: false
    description: If null, it's a shared pickup point

  - name: supplier_id
    type: uuid
    required: true

  - name: status
    type: enum
    required: true
    validation:
      values: [active, inactive]
    default: active

  - name: pickup_type
    type: enum
    required: true
    validation:
      values: [hotel, landmark, airport, bus_station, train_station, port, custom]

  - name: name
    type: string
    required: true
    validation:
      max_length: 200

  - name: name_local
    type: string
    required: false
    description: Name in local language

  - name: description
    type: text
    required: false

  # Location
  - name: address
    type: string
    required: true

  - name: city
    type: string
    required: true

  - name: district
    type: string
    required: false

  - name: latitude
    type: decimal
    required: true

  - name: longitude
    type: decimal
    required: true

  - name: google_place_id
    type: string
    required: false

  # Instructions
  - name: meeting_instructions
    type: text
    required: true
    description: Where exactly to meet

  - name: identification_info
    type: text
    required: false
    description: How driver/guide will identify themselves

  - name: landmark_description
    type: text
    required: false

  - name: photo_url
    type: string
    required: false
    description: Photo of exact meeting spot

  # Timing
  - name: default_pickup_time_offset
    type: integer
    required: true
    default: 0
    description: Minutes before tour start time

  - name: flexibility_minutes
    type: integer
    required: true
    default: 15
    description: Acceptable wait time window

  # Logistics
  - name: zone
    type: string
    required: false
    description: Zone for pricing purposes

  - name: additional_fee
    type: decimal
    required: true
    default: 0
    description: Extra charge for this pickup location

  - name: currency
    type: string
    required: true
    default: "VND"

  - name: max_passengers
    type: integer
    required: false
    description: If limited capacity at this point

  # Contact
  - name: contact_phone
    type: string
    required: false
    description: Local contact for pickup issues

  # Accessibility
  - name: wheelchair_accessible
    type: boolean
    required: true
    default: false

  - name: parking_available
    type: boolean
    required: true
    default: false

  - name: indoor_waiting
    type: boolean
    required: true
    default: false

  # Timestamps
  - name: created_at
    type: timestamp
    required: true

  - name: updated_at
    type: timestamp
    required: true

relationships:
  - name: tour
    type: belongs_to
    entity: Tour
    required: false

  - name: supplier
    type: belongs_to
    entity: Supplier
    required: true

  - name: bookings
    type: has_many
    entity: TourBooking

indexes:
  - [tour_id]
  - [supplier_id]
  - [city]
  - [pickup_type]
  - [status]
  - [latitude, longitude]

business_rules:
  - BR-PKP-001: Must have valid GPS coordinates
  - BR-PKP-002: Meeting instructions must be >= 50 characters
  - BR-PKP-003: Airport pickups require terminal/gate info
  - BR-PKP-004: Hotel pickups should include lobby location

events:
  - name: pickup_point.created
    payload: [id, name, city]
  - name: pickup_point.updated
    payload: [id, changed_fields]
