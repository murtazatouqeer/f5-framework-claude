name: Permission
display_name: Permission / Quyền hạn
description: |
  Defines granular permissions that can be assigned to roles.
  Enables fine-grained access control for SaaS applications.

domain: saas-platform
entity_type: reference
version: "1.0"

attributes:
  # Primary Identifiers
  - name: id
    type: uuid
    primary_key: true
    description: Internal unique identifier

  - name: name
    type: string
    required: true
    unique: true
    max_length: 100
    description: Permission identifier
    description_vi: Mã định danh quyền
    pattern: "^[a-z]+:[a-z_]+$"
    examples: ["users:create", "billing:manage", "settings:update"]

  - name: display_name
    type: string
    required: true
    max_length: 255
    description: Human-readable permission name
    description_vi: Tên quyền dễ đọc

  - name: description
    type: text
    description: Permission description
    description_vi: Mô tả quyền

  # Categorization
  - name: resource
    type: string
    required: true
    max_length: 50
    description: Resource this permission applies to
    description_vi: Tài nguyên mà quyền này áp dụng
    examples: [users, billing, settings, api_keys, audit_logs]

  - name: action
    type: enum
    values: [create, read, update, delete, manage, execute, export, invite]
    required: true
    description: Action being permitted
    description_vi: Hành động được phép

  - name: category
    type: string
    max_length: 50
    description: Permission category for grouping
    description_vi: Danh mục quyền để nhóm
    examples: [team_management, billing_finance, security, integrations]

  # Tier Requirements
  - name: min_tier
    type: enum
    values: [free, starter, professional, enterprise]
    default: free
    description: Minimum plan tier required
    description_vi: Cấp gói tối thiểu yêu cầu

  # Flags
  - name: is_sensitive
    type: boolean
    default: false
    description: Requires additional confirmation
    description_vi: Yêu cầu xác nhận bổ sung

  - name: requires_2fa
    type: boolean
    default: false
    description: Requires 2FA to use
    description_vi: Yêu cầu 2FA để sử dụng

  - name: is_active
    type: boolean
    default: true
    description: Permission is active
    description_vi: Quyền đang hoạt động

  # Audit
  - name: created_at
    type: timestamp
    auto: true

  - name: updated_at
    type: timestamp
    auto: true

indexes:
  - name: idx_permission_name
    columns: [name]
    unique: true

  - name: idx_permission_resource_action
    columns: [resource, action]
    unique: true

  - name: idx_permission_category
    columns: [category]

business_rules:
  - id: BR-PER-001
    name: Permission Name Format
    description: Permission names must follow resource:action format
    description_vi: Tên quyền phải theo định dạng resource:action

  - id: BR-PER-002
    name: Tier Enforcement
    description: Permissions respect minimum tier requirements
    description_vi: Quyền tôn trọng yêu cầu cấp gói tối thiểu

  - id: BR-PER-003
    name: Sensitive Permission Audit
    description: Sensitive permission usage is logged
    description_vi: Việc sử dụng quyền nhạy cảm được ghi log

system_permissions:
  # Team Management
  - name: users:create
    display_name: Create Users
    resource: users
    action: create
    category: team_management
    description: Invite new users to the organization

  - name: users:read
    display_name: View Users
    resource: users
    action: read
    category: team_management
    description: View user list and profiles

  - name: users:update
    display_name: Edit Users
    resource: users
    action: update
    category: team_management
    description: Edit user profiles and settings

  - name: users:delete
    display_name: Remove Users
    resource: users
    action: delete
    category: team_management
    description: Remove users from organization
    is_sensitive: true

  - name: users:invite
    display_name: Invite Users
    resource: users
    action: invite
    category: team_management
    description: Send invitations to new team members

  # Roles
  - name: roles:create
    display_name: Create Roles
    resource: roles
    action: create
    category: team_management
    min_tier: professional
    description: Create custom roles

  - name: roles:update
    display_name: Edit Roles
    resource: roles
    action: update
    category: team_management
    min_tier: professional
    description: Modify role permissions

  - name: roles:delete
    display_name: Delete Roles
    resource: roles
    action: delete
    category: team_management
    min_tier: professional
    is_sensitive: true

  # Billing & Finance
  - name: billing:read
    display_name: View Billing
    resource: billing
    action: read
    category: billing_finance
    description: View invoices, payment history, usage

  - name: billing:manage
    display_name: Manage Billing
    resource: billing
    action: manage
    category: billing_finance
    is_sensitive: true
    description: Update payment methods, change plan

  - name: subscription:update
    display_name: Modify Subscription
    resource: subscription
    action: update
    category: billing_finance
    is_sensitive: true
    description: Upgrade, downgrade, or cancel subscription

  # Settings
  - name: settings:read
    display_name: View Settings
    resource: settings
    action: read
    category: settings
    description: View organization settings

  - name: settings:update
    display_name: Update Settings
    resource: settings
    action: update
    category: settings
    description: Modify organization settings

  - name: branding:update
    display_name: Update Branding
    resource: branding
    action: update
    category: settings
    min_tier: professional
    description: Customize logo, colors, domain

  # Security
  - name: api_keys:create
    display_name: Create API Keys
    resource: api_keys
    action: create
    category: security
    min_tier: starter
    description: Generate new API keys

  - name: api_keys:read
    display_name: View API Keys
    resource: api_keys
    action: read
    category: security
    min_tier: starter
    description: View API key list

  - name: api_keys:delete
    display_name: Delete API Keys
    resource: api_keys
    action: delete
    category: security
    min_tier: starter
    is_sensitive: true
    description: Revoke API keys

  - name: sso:manage
    display_name: Manage SSO
    resource: sso
    action: manage
    category: security
    min_tier: enterprise
    requires_2fa: true
    description: Configure SAML/SSO settings

  - name: audit_logs:read
    display_name: View Audit Logs
    resource: audit_logs
    action: read
    category: security
    min_tier: professional
    description: View activity audit logs

  - name: audit_logs:export
    display_name: Export Audit Logs
    resource: audit_logs
    action: export
    category: security
    min_tier: enterprise
    description: Export audit logs to external systems

  # Integrations
  - name: integrations:create
    display_name: Add Integrations
    resource: integrations
    action: create
    category: integrations
    min_tier: starter
    description: Connect third-party services

  - name: integrations:read
    display_name: View Integrations
    resource: integrations
    action: read
    category: integrations
    description: View connected integrations

  - name: integrations:update
    display_name: Update Integrations
    resource: integrations
    action: update
    category: integrations
    min_tier: starter
    description: Modify integration settings

  - name: integrations:delete
    display_name: Remove Integrations
    resource: integrations
    action: delete
    category: integrations
    min_tier: starter
    description: Disconnect integrations

  - name: webhooks:manage
    display_name: Manage Webhooks
    resource: webhooks
    action: manage
    category: integrations
    min_tier: professional
    description: Configure webhook endpoints

  # Data Management
  - name: data:export
    display_name: Export Data
    resource: data
    action: export
    category: data
    description: Export organization data
    is_sensitive: true

  - name: data:delete
    display_name: Delete Data
    resource: data
    action: delete
    category: data
    is_sensitive: true
    requires_2fa: true
    description: Permanently delete data

permission_groups:
  - name: full_admin
    description: All administrative permissions
    permissions: ["users:*", "billing:*", "settings:*", "api_keys:*", "integrations:*"]

  - name: team_manager
    description: Team management permissions
    permissions: ["users:create", "users:read", "users:update", "users:invite"]

  - name: billing_manager
    description: Billing management permissions
    permissions: ["billing:read", "billing:manage", "subscription:update"]

  - name: security_admin
    description: Security-related permissions
    permissions: ["api_keys:*", "sso:manage", "audit_logs:*"]

  - name: read_only
    description: Read-only access
    permissions: ["users:read", "settings:read", "integrations:read"]
