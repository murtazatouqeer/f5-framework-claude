name: Platform Admin Use Cases
display_name: Platform Admin Use Cases / Các trường hợp sử dụng của quản trị viên nền tảng
description: |
  Use cases for platform administrators managing the SaaS platform itself,
  including tenant management, system operations, and platform-wide settings.

domain: saas-platform
actor: platform_admin
version: "1.0"
access_level: internal_only

# =============================================================================
# ACTOR DEFINITION
# =============================================================================
actor_definition:
  name: Platform Administrator
  name_vi: Quản trị viên nền tảng
  roles: [platform_admin, super_admin, support_agent, finance_admin]
  description: |
    Internal staff managing the SaaS platform operations.
    Has cross-tenant access with strict audit requirements.

  access_requirements:
    - strong_authentication: required
    - mfa: required
    - vpn: required_for_sensitive_operations
    - audit_logging: all_actions_logged
    - access_justification: required_for_tenant_data

# =============================================================================
# TENANT MANAGEMENT USE CASES
# =============================================================================
tenant_management:
  # ---------------------------------------------------------------------------
  # UC-PA-001: View All Tenants
  # ---------------------------------------------------------------------------
  - id: UC-PA-001
    name: View All Tenants
    name_vi: Xem tất cả khách thuê
    priority: high
    roles: [platform_admin, support_agent, finance_admin]

    description: |
      Platform admin views list of all tenants on the platform.

    main_flow:
      1: "Admin navigates to Platform Admin > Tenants"
      2: "System displays paginated tenant list"
      3: "Admin can search and filter tenants"
      4: "Admin can view tenant summary cards"
      5: "Admin can click to view tenant details"

    filter_options:
      - status: [active, suspended, cancelled, pending]
      - tier: [free, starter, professional, enterprise]
      - created_date_range
      - mrr_range
      - user_count_range
      - region

    displayed_metrics:
      - tenant_count_by_status
      - tenant_count_by_tier
      - total_mrr
      - new_tenants_this_month
      - churn_this_month

    audit_requirement:
      logged: true
      requires_justification: false

  # ---------------------------------------------------------------------------
  # UC-PA-002: View Tenant Details
  # ---------------------------------------------------------------------------
  - id: UC-PA-002
    name: View Tenant Details
    name_vi: Xem chi tiết khách thuê
    priority: high
    roles: [platform_admin, support_agent, finance_admin]

    description: |
      Platform admin views detailed information about a specific tenant.

    preconditions:
      - "Admin has tenant view permissions"

    main_flow:
      1: "Admin selects tenant from list"
      2: "System displays tenant detail view"
      3: "Admin can view various tabs/sections"
      4: "Admin logs access reason for audit"

    information_sections:
      overview:
        - tenant_id
        - name
        - slug
        - status
        - tier
        - created_at
        - primary_contact

      subscription:
        - current_plan
        - billing_cycle
        - mrr
        - next_billing_date
        - payment_status

      usage:
        - current_usage_by_metric
        - usage_trends
        - limit_utilization

      users:
        - user_count
        - active_users
        - admin_list

      billing_history:
        - recent_invoices
        - payment_history
        - credits_and_adjustments

      support_history:
        - recent_tickets
        - escalations
        - notes

    audit_requirement:
      logged: true
      requires_justification: true
      justification_options:
        - support_ticket: "Reference ticket #"
        - billing_inquiry: "Reference inquiry #"
        - security_investigation: "Reference incident #"
        - routine_audit: "Scheduled review"

  # ---------------------------------------------------------------------------
  # UC-PA-003: Suspend Tenant
  # ---------------------------------------------------------------------------
  - id: UC-PA-003
    name: Suspend Tenant
    name_vi: Đình chỉ khách thuê
    priority: high
    roles: [platform_admin]
    approval_required: true

    description: |
      Platform admin suspends a tenant account.

    preconditions:
      - "Admin has tenant suspension permissions"
      - "Tenant is currently active"
      - "Suspension reason documented"

    main_flow:
      1: "Admin navigates to tenant details"
      2: "Admin clicks 'Suspend Tenant'"
      3: "System displays suspension form"
      4: "Admin selects suspension reason"
      5: "Admin enters detailed justification"
      6: "Admin selects suspension type"
      7: "Admin submits for approval (if required)"
      8: "Approver reviews and approves"
      9: "System suspends tenant"
      10: "System notifies tenant contacts"

    suspension_reasons:
      - payment_failure: "Outstanding balance > 30 days"
      - terms_violation: "Violation of ToS"
      - security_incident: "Security-related suspension"
      - legal_requirement: "Legal/compliance requirement"
      - customer_request: "Requested by tenant"
      - abuse: "Platform abuse detected"

    suspension_types:
      soft_suspension:
        effect: "Read-only access, no new data"
        reversible: immediate

      hard_suspension:
        effect: "All access blocked"
        reversible: with_approval

    notifications:
      to_tenant:
        - primary_contact_email
        - all_admins_email
        - in_app_notice

      internal:
        - account_manager
        - support_team
        - finance_team

    audit_requirement:
      logged: true
      requires_justification: true
      requires_approval: true
      approval_chain: [platform_admin_lead]

    postconditions:
      - "Tenant status changed to suspended"
      - "All tenant users lose access"
      - "API keys disabled"
      - "Notification emails sent"
      - "Audit log entry with full details"

  # ---------------------------------------------------------------------------
  # UC-PA-004: Reactivate Tenant
  # ---------------------------------------------------------------------------
  - id: UC-PA-004
    name: Reactivate Tenant
    name_vi: Kích hoạt lại khách thuê
    priority: high
    roles: [platform_admin]

    description: |
      Platform admin reactivates a suspended tenant.

    preconditions:
      - "Tenant is currently suspended"
      - "Suspension issue resolved"

    main_flow:
      1: "Admin navigates to suspended tenant"
      2: "Admin clicks 'Reactivate'"
      3: "Admin documents resolution"
      4: "System reactivates tenant"
      5: "System notifies tenant"

    postconditions:
      - "Tenant status changed to active"
      - "User access restored"
      - "API keys re-enabled"
      - "Notification sent"

  # ---------------------------------------------------------------------------
  # UC-PA-005: Apply Manual Credit
  # ---------------------------------------------------------------------------
  - id: UC-PA-005
    name: Apply Manual Credit
    name_vi: Áp dụng tín dụng thủ công
    priority: medium
    roles: [finance_admin, platform_admin]
    approval_required: conditional

    description: |
      Platform admin applies credit to tenant account.

    preconditions:
      - "Valid reason for credit"
      - "Approval if amount > threshold"

    main_flow:
      1: "Admin navigates to tenant billing"
      2: "Admin clicks 'Apply Credit'"
      3: "Admin enters credit amount and reason"
      4: "System checks approval requirements"
      5: "Admin submits (or routes for approval)"
      6: "Credit applied to account"
      7: "Tenant notified"

    credit_reasons:
      - service_credit: "SLA violation compensation"
      - goodwill: "Customer satisfaction"
      - billing_error: "Correction of billing error"
      - promotional: "Marketing promotion"
      - migration: "Migration from competitor"
      - referral: "Referral bonus"

    approval_thresholds:
      no_approval: "< $100"
      manager_approval: "$100 - $500"
      director_approval: "$500 - $2000"
      vp_approval: "> $2000"

    audit_requirement:
      logged: true
      requires_justification: true
      requires_approval: amount_dependent

  # ---------------------------------------------------------------------------
  # UC-PA-006: Override Plan Limits
  # ---------------------------------------------------------------------------
  - id: UC-PA-006
    name: Override Plan Limits
    name_vi: Ghi đè giới hạn gói
    priority: medium
    roles: [platform_admin]
    approval_required: true

    description: |
      Platform admin overrides standard plan limits for a tenant.

    use_cases:
      - "Enterprise negotiated custom limits"
      - "Temporary limit increase during migration"
      - "Trial extension with enhanced limits"

    main_flow:
      1: "Admin navigates to tenant subscription"
      2: "Admin clicks 'Custom Limits'"
      3: "Admin specifies limit overrides"
      4: "Admin sets expiration if temporary"
      5: "Admin documents justification"
      6: "Submit for approval"
      7: "System applies overrides"

    overridable_limits:
      - max_users
      - api_rate_limit
      - storage_limit
      - feature_flags

    audit_requirement:
      logged: true
      requires_justification: true
      requires_approval: true

# =============================================================================
# SUPPORT OPERATIONS USE CASES
# =============================================================================
support_operations:
  # ---------------------------------------------------------------------------
  # UC-PA-010: Impersonate User
  # ---------------------------------------------------------------------------
  - id: UC-PA-010
    name: Impersonate User
    name_vi: Mạo danh người dùng
    priority: high
    roles: [support_agent, platform_admin]
    security_level: sensitive

    description: |
      Support agent temporarily assumes user identity for troubleshooting.

    preconditions:
      - "Valid support ticket exists"
      - "User or tenant admin consent documented"
      - "Agent has impersonation permissions"

    main_flow:
      1: "Agent opens support ticket"
      2: "Agent clicks 'Impersonate User'"
      3: "Agent enters ticket reference"
      4: "Agent confirms consent obtained"
      5: "System creates impersonation session"
      6: "Agent sees platform as user sees it"
      7: "All actions logged as impersonation"
      8: "Agent ends impersonation when done"

    restrictions:
      cannot_do:
        - change_password
        - change_email
        - modify_billing
        - delete_data
        - access_other_tenants

      session_limits:
        max_duration: 1_hour
        auto_terminate: true

    visibility:
      to_tenant: "Impersonation session visible in audit log"
      indicator: "Clear visual indicator during impersonation"

    audit_requirement:
      logged: true
      requires_justification: true
      ticket_reference: required
      all_actions_logged: true
      session_recorded: optional

    postconditions:
      - "Impersonation session created"
      - "All actions logged with impersonation flag"
      - "Session auto-terminates after limit"

  # ---------------------------------------------------------------------------
  # UC-PA-011: Access Tenant Audit Logs
  # ---------------------------------------------------------------------------
  - id: UC-PA-011
    name: Access Tenant Audit Logs
    name_vi: Truy cập nhật ký kiểm toán khách thuê
    priority: medium
    roles: [support_agent, platform_admin, security_admin]

    description: |
      Platform admin accesses tenant's audit logs for investigation.

    preconditions:
      - "Valid reason for access"
      - "Access documented in ticket or investigation"

    main_flow:
      1: "Admin navigates to tenant audit logs"
      2: "Admin enters access justification"
      3: "System displays audit log viewer"
      4: "Admin can search and filter logs"
      5: "Admin can export for investigation"

    filter_options:
      - date_range
      - actor
      - action_type
      - resource_type
      - ip_address

    audit_requirement:
      logged: true
      requires_justification: true
      access_logged_to_tenant: true

  # ---------------------------------------------------------------------------
  # UC-PA-012: Reset User Password (Admin)
  # ---------------------------------------------------------------------------
  - id: UC-PA-012
    name: Reset User Password
    name_vi: Đặt lại mật khẩu người dùng
    priority: medium
    roles: [support_agent, platform_admin]

    description: |
      Support agent triggers password reset for locked out user.

    preconditions:
      - "Identity verification completed"
      - "Support ticket documents request"

    main_flow:
      1: "Agent opens user record"
      2: "Agent clicks 'Trigger Password Reset'"
      3: "Agent enters ticket reference"
      4: "System sends reset email to user"
      5: "Agent does NOT see or set password"

    security_notes:
      - "Agent never sees or sets actual password"
      - "Only triggers standard reset flow"
      - "User must complete reset themselves"

    audit_requirement:
      logged: true
      requires_justification: true
      ticket_reference: required

# =============================================================================
# PLATFORM OPERATIONS USE CASES
# =============================================================================
platform_operations:
  # ---------------------------------------------------------------------------
  # UC-PA-020: Manage Plans and Pricing
  # ---------------------------------------------------------------------------
  - id: UC-PA-020
    name: Manage Plans and Pricing
    name_vi: Quản lý gói và giá cả
    priority: high
    roles: [platform_admin, product_admin]
    approval_required: true

    description: |
      Admin creates or modifies subscription plans and pricing.

    main_flow:
      1: "Admin navigates to Plans Management"
      2: "Admin creates new plan or edits existing"
      3: "Admin configures features and limits"
      4: "Admin sets pricing"
      5: "Admin submits for review"
      6: "Plan goes through approval workflow"
      7: "Plan published or scheduled"

    plan_configuration:
      basic_info:
        - name
        - description
        - tier
        - visibility

      features:
        - included_features
        - feature_limits
        - usage_allowances

      pricing:
        - monthly_price
        - annual_price
        - per_seat_pricing
        - usage_overage_rates

      rules:
        - trial_duration
        - upgrade_paths
        - downgrade_restrictions

    change_management:
      new_plan:
        - "Available immediately or scheduled"
        - "No impact on existing subscribers"

      price_change:
        - "Affects new subscribers immediately"
        - "Existing subscribers: next renewal"
        - "Communication required"

      feature_change:
        - "Addition: immediate for all"
        - "Removal: requires migration plan"

    audit_requirement:
      logged: true
      requires_approval: true
      approval_chain: [product_lead, finance_lead]

  # ---------------------------------------------------------------------------
  # UC-PA-021: Manage Feature Flags
  # ---------------------------------------------------------------------------
  - id: UC-PA-021
    name: Manage Feature Flags
    name_vi: Quản lý cờ tính năng
    priority: medium
    roles: [platform_admin, product_admin]

    description: |
      Admin manages platform-wide feature flags.

    main_flow:
      1: "Admin navigates to Feature Flags"
      2: "Admin creates or edits feature flag"
      3: "Admin configures rollout strategy"
      4: "Admin activates flag"
      5: "System applies to affected tenants"

    rollout_strategies:
      - all_tenants
      - percentage_rollout
      - tier_based
      - tenant_allowlist
      - tenant_blocklist

    flag_types:
      - boolean: "On/Off"
      - percentage: "Gradual rollout"
      - tenant_list: "Specific tenants"

    safety_features:
      - "Kill switch for immediate disable"
      - "Rollback capability"
      - "Metrics tracking"

  # ---------------------------------------------------------------------------
  # UC-PA-022: View Platform Metrics
  # ---------------------------------------------------------------------------
  - id: UC-PA-022
    name: View Platform Metrics
    name_vi: Xem số liệu nền tảng
    priority: high
    roles: [platform_admin, executive]

    description: |
      Admin views platform-wide metrics and KPIs.

    metric_categories:
      business_metrics:
        - total_mrr
        - mrr_growth
        - arr
        - net_revenue_retention
        - gross_churn
        - net_churn
        - ltv
        - cac

      operational_metrics:
        - total_tenants
        - active_tenants
        - total_users
        - dau_mau
        - api_requests_per_day
        - error_rate

      support_metrics:
        - open_tickets
        - avg_response_time
        - avg_resolution_time
        - csat_score

      infrastructure_metrics:
        - uptime
        - latency_p95
        - database_size
        - storage_used

    dashboard_features:
      - real_time_updates
      - historical_trends
      - cohort_analysis
      - export_to_csv

  # ---------------------------------------------------------------------------
  # UC-PA-023: Manage System Announcements
  # ---------------------------------------------------------------------------
  - id: UC-PA-023
    name: Manage System Announcements
    name_vi: Quản lý thông báo hệ thống
    priority: medium
    roles: [platform_admin]

    description: |
      Admin creates platform-wide announcements.

    announcement_types:
      maintenance:
        - scheduled_downtime
        - emergency_maintenance
        - degraded_performance

      product:
        - new_feature
        - deprecation_notice
        - policy_change

      security:
        - security_advisory
        - mandatory_action

    targeting:
      - all_tenants
      - specific_tiers
      - specific_regions
      - specific_tenants

    display_options:
      - banner
      - modal
      - email
      - status_page

# =============================================================================
# SECURITY OPERATIONS USE CASES
# =============================================================================
security_operations:
  # ---------------------------------------------------------------------------
  # UC-PA-030: Investigate Security Incident
  # ---------------------------------------------------------------------------
  - id: UC-PA-030
    name: Investigate Security Incident
    name_vi: Điều tra sự cố bảo mật
    priority: critical
    roles: [security_admin, platform_admin]

    description: |
      Security team investigates potential security incident.

    triggers:
      - automated_alert
      - user_report
      - external_notification
      - routine_audit

    main_flow:
      1: "Security event triggers investigation"
      2: "Admin creates security incident record"
      3: "Admin gathers relevant logs and data"
      4: "Admin analyzes impact scope"
      5: "Admin documents findings"
      6: "Admin executes containment if needed"
      7: "Admin reports to stakeholders"

    investigation_tools:
      - cross_tenant_audit_search
      - ip_activity_analysis
      - user_session_analysis
      - api_request_analysis

    containment_actions:
      - suspend_affected_users
      - revoke_api_keys
      - suspend_affected_tenants
      - block_ip_ranges
      - force_password_reset

    audit_requirement:
      logged: true
      requires_justification: true
      incident_reference: required
      all_access_logged: true

  # ---------------------------------------------------------------------------
  # UC-PA-031: Manage IP Blocklist
  # ---------------------------------------------------------------------------
  - id: UC-PA-031
    name: Manage IP Blocklist
    name_vi: Quản lý danh sách chặn IP
    priority: high
    roles: [security_admin, platform_admin]

    description: |
      Admin manages platform-wide IP blocking.

    main_flow:
      1: "Admin navigates to Security > IP Blocklist"
      2: "Admin adds IP or range to blocklist"
      3: "Admin documents reason"
      4: "Block takes effect immediately"

    block_types:
      - single_ip
      - cidr_range
      - country_level

    block_reasons:
      - abuse_detected
      - attack_source
      - compliance_requirement
      - customer_request

  # ---------------------------------------------------------------------------
  # UC-PA-032: Force MFA for Tenant
  # ---------------------------------------------------------------------------
  - id: UC-PA-032
    name: Force MFA for Tenant
    name_vi: Bắt buộc MFA cho khách thuê
    priority: medium
    roles: [security_admin, platform_admin]

    description: |
      Admin forces MFA requirement for specific tenant.

    use_cases:
      - security_incident_response
      - compliance_requirement
      - customer_request

    main_flow:
      1: "Admin navigates to tenant security settings"
      2: "Admin enables forced MFA"
      3: "Admin sets grace period for setup"
      4: "System notifies all tenant users"
      5: "Users must setup MFA within grace period"

    audit_requirement:
      logged: true
      requires_justification: true

# =============================================================================
# COMPLIANCE USE CASES
# =============================================================================
compliance:
  # ---------------------------------------------------------------------------
  # UC-PA-040: Process Data Subject Request
  # ---------------------------------------------------------------------------
  - id: UC-PA-040
    name: Process Data Subject Request
    name_vi: Xử lý yêu cầu chủ thể dữ liệu
    priority: high
    roles: [compliance_admin, platform_admin]

    description: |
      Admin processes GDPR/CCPA data subject requests.

    request_types:
      access:
        description: "Provide copy of personal data"
        timeline: 30_days
        action: generate_data_export

      rectification:
        description: "Correct inaccurate data"
        timeline: 30_days
        action: update_records

      erasure:
        description: "Delete personal data"
        timeline: 30_days
        action: delete_with_exceptions

      portability:
        description: "Provide data in portable format"
        timeline: 30_days
        action: generate_machine_readable_export

    main_flow:
      1: "Request received via support or form"
      2: "Admin creates DSR record"
      3: "Admin verifies requestor identity"
      4: "Admin processes request by type"
      5: "Admin documents completion"
      6: "Response sent to requestor"

    audit_requirement:
      logged: true
      requires_documentation: true
      retention: 7_years

  # ---------------------------------------------------------------------------
  # UC-PA-041: Generate Compliance Report
  # ---------------------------------------------------------------------------
  - id: UC-PA-041
    name: Generate Compliance Report
    name_vi: Tạo báo cáo tuân thủ
    priority: medium
    roles: [compliance_admin, platform_admin]

    description: |
      Admin generates compliance reports for auditors.

    report_types:
      soc2:
        - access_control_evidence
        - change_management_logs
        - incident_response_records
        - security_monitoring_data

      gdpr:
        - data_processing_activities
        - dsr_handling_records
        - breach_notification_log
        - consent_records

      pci_dss:
        - payment_handling_evidence
        - access_logs
        - vulnerability_scans

    main_flow:
      1: "Admin selects report type"
      2: "Admin specifies date range"
      3: "System gathers relevant data"
      4: "Admin reviews and exports"

    export_formats:
      - pdf
      - csv
      - json
