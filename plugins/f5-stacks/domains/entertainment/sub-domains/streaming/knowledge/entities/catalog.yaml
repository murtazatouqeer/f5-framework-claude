name: catalog
display_name: Catalog
description: |
  Content catalog organization for browsing and discovery.
  Supports collections, categories, and featured content management.

domain: entertainment
subdomain: streaming
category: entities
version: "1.0.0"
status: active

attributes:
  # Identity
  - name: id
    type: uuid
    required: true
    description: Unique catalog entry identifier

  - name: catalog_type
    type: enum
    values: [category, collection, featured, genre, network, trending, new_releases, continue_watching, top_rated, staff_picks]
    required: true
    description: Type of catalog grouping

  - name: name
    type: string
    required: true
    max_length: 200
    description: Catalog display name
    example: "Action Movies"

  - name: slug
    type: string
    required: true
    unique: true
    description: URL-friendly identifier

  - name: description
    type: text
    required: false
    max_length: 1000
    description: Catalog description

  # Hierarchy
  - name: parent_id
    type: uuid
    required: false
    description: Parent catalog for nested categories

  - name: level
    type: integer
    required: true
    default: 0
    description: Hierarchy level depth

  - name: path
    type: string
    required: false
    description: Full hierarchy path
    example: "/movies/action/sci-fi"

  # Display Settings
  - name: display_order
    type: integer
    required: true
    default: 0
    description: Sort order in navigation

  - name: layout_type
    type: enum
    values: [grid, carousel, hero, list, spotlight]
    required: true
    default: grid
    description: UI layout style

  - name: items_per_row
    type: integer
    required: false
    default: 6
    description: Items shown per row

  - name: max_items
    type: integer
    required: false
    description: Maximum items to display

  # Visual Assets
  - name: icon
    type: string
    required: false
    description: Icon identifier or URL

  - name: thumbnail_url
    type: url
    required: false
    description: Catalog thumbnail

  - name: banner_url
    type: url
    required: false
    description: Banner image for featured display

  - name: background_color
    type: string
    required: false
    description: Background color hex code

  # Content Rules
  - name: content_filter
    type: object
    required: false
    properties:
      content_types: array
      genres: array
      age_ratings: array
      languages: array
      release_year_min: integer
      release_year_max: integer
      min_rating: decimal
      quality_options: array
    description: Auto-populate filter rules

  - name: sort_by
    type: enum
    values: [manual, popularity, release_date, rating, title, added_date, random]
    required: true
    default: manual
    description: Content sorting method

  - name: sort_direction
    type: enum
    values: [asc, desc]
    required: true
    default: desc
    description: Sort direction

  # Content Items
  - name: content_ids
    type: array
    items: uuid
    required: false
    description: Manually curated content IDs

  - name: content_count
    type: integer
    required: false
    default: 0
    description: Cached item count

  # Targeting
  - name: regions
    type: array
    items: string
    required: false
    description: Available regions
    example: ["US", "CA", "GB"]

  - name: subscription_tiers
    type: array
    items: enum
    values: [free, basic, standard, premium]
    required: false
    description: Required subscription tiers

  - name: user_segments
    type: array
    items: string
    required: false
    description: Target user segments

  # Scheduling
  - name: start_date
    type: datetime
    required: false
    description: Catalog visibility start

  - name: end_date
    type: datetime
    required: false
    description: Catalog visibility end

  - name: schedule
    type: object
    required: false
    properties:
      recurring: boolean
      days_of_week: array
      time_slots: array
    description: Recurring schedule

  # Status
  - name: status
    type: enum
    values: [draft, active, scheduled, expired, archived]
    required: true
    default: draft
    description: Catalog status

  - name: is_visible
    type: boolean
    required: true
    default: true
    description: Visibility flag

  - name: is_searchable
    type: boolean
    required: true
    default: true
    description: Appears in search results

  # Analytics
  - name: view_count
    type: integer
    required: false
    default: 0
    description: Catalog view count

  - name: click_through_rate
    type: decimal
    required: false
    description: CTR percentage

  # Audit
  - name: created_at
    type: datetime
    required: true
    auto: true

  - name: updated_at
    type: datetime
    required: true
    auto: true

  - name: created_by
    type: uuid
    required: true

  - name: updated_by
    type: uuid
    required: false

relationships:
  - name: parent
    type: belongs_to
    target: catalog
    foreign_key: parent_id
    description: Parent catalog

  - name: children
    type: has_many
    target: catalog
    foreign_key: parent_id
    description: Child catalogs

  - name: content_items
    type: many_to_many
    target: content
    through: catalog_content
    description: Catalog contents

state_machine:
  initial: draft
  states:
    - name: draft
      description: Catalog being prepared
      allowed_transitions: [active, scheduled]

    - name: active
      description: Currently visible
      allowed_transitions: [archived, draft]

    - name: scheduled
      description: Scheduled for future
      allowed_transitions: [active, draft]

    - name: expired
      description: Past end date
      allowed_transitions: [archived, active]

    - name: archived
      description: No longer in use
      allowed_transitions: [draft]

indexes:
  - name: idx_catalog_type
    fields: [catalog_type]
    type: btree

  - name: idx_catalog_parent
    fields: [parent_id]
    type: btree

  - name: idx_catalog_status
    fields: [status, is_visible]
    type: btree

  - name: idx_catalog_slug
    fields: [slug]
    type: unique

  - name: idx_catalog_order
    fields: [display_order]
    type: btree

validations:
  - name: valid_dates
    condition: "end_date IS NULL OR end_date > start_date"
    message: "End date must be after start date"

  - name: valid_hierarchy
    condition: "parent_id != id"
    message: "Catalog cannot be its own parent"

business_rules:
  - rule: catalog-management-rules
    description: Rules for catalog organization
