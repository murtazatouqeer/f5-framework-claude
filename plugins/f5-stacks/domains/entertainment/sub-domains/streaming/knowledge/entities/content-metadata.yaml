name: content_metadata
display_name: Content Metadata
description: |
  Extended metadata for streaming content including cast, crew,
  production details, and technical specifications.

domain: entertainment
subdomain: streaming
category: entities
version: "1.0.0"
status: active

attributes:
  # Identity
  - name: id
    type: uuid
    required: true
    description: Unique metadata identifier

  - name: content_id
    type: uuid
    required: true
    description: Parent content reference

  # Cast & Crew
  - name: directors
    type: array
    items:
      type: object
      properties:
        name: string
        person_id: uuid
        role: string
    required: false
    description: Director information

  - name: writers
    type: array
    items:
      type: object
      properties:
        name: string
        person_id: uuid
        credit_type: enum[screenplay, story, teleplay]
    required: false
    description: Writer credits

  - name: cast
    type: array
    items:
      type: object
      properties:
        name: string
        person_id: uuid
        character_name: string
        billing_order: integer
        is_main_cast: boolean
    required: false
    description: Cast information

  - name: producers
    type: array
    items:
      type: object
      properties:
        name: string
        person_id: uuid
        producer_type: enum[executive, producer, co-producer]
    required: false
    description: Producer credits

  - name: composers
    type: array
    items:
      type: object
      properties:
        name: string
        person_id: uuid
    required: false
    description: Music composers

  # Production Details
  - name: production_companies
    type: array
    items:
      type: object
      properties:
        name: string
        company_id: uuid
        logo_url: url
    required: false
    description: Production companies

  - name: distributors
    type: array
    items:
      type: object
      properties:
        name: string
        region: string
    required: false
    description: Distribution companies

  - name: budget
    type: decimal
    required: false
    description: Production budget (USD)

  - name: box_office
    type: decimal
    required: false
    description: Box office revenue (USD)

  - name: filming_locations
    type: array
    items: string
    required: false
    description: Filming locations

  - name: production_status
    type: enum
    values: [announced, pre_production, filming, post_production, completed]
    required: false
    description: Production status

  # Technical Specs
  - name: aspect_ratio
    type: string
    required: false
    description: Video aspect ratio
    example: "2.39:1"

  - name: color_format
    type: enum
    values: [color, black_and_white, mixed]
    required: false
    default: color
    description: Color format

  - name: sound_mix
    type: array
    items: string
    required: false
    description: Sound mix formats
    example: ["Dolby Digital", "DTS"]

  - name: camera_equipment
    type: string
    required: false
    description: Camera used

  - name: film_format
    type: string
    required: false
    description: Original film format
    example: "35mm"

  # Awards & Recognition
  - name: awards
    type: array
    items:
      type: object
      properties:
        name: string
        category: string
        year: integer
        result: enum[nominated, won]
    required: false
    description: Awards and nominations

  # Content Warnings
  - name: content_warnings
    type: array
    items:
      type: object
      properties:
        type: enum[violence, language, nudity, drugs, smoking, flashing_lights]
        severity: enum[mild, moderate, severe]
        description: string
    required: false
    description: Detailed content warnings

  - name: parental_guide
    type: object
    properties:
      sex_nudity: integer
      violence_gore: integer
      profanity: integer
      alcohol_drugs: integer
      frightening_scenes: integer
    required: false
    description: Parental guide scores (0-10)

  # Keywords & Tags
  - name: keywords
    type: array
    items: string
    required: false
    description: Search keywords

  - name: themes
    type: array
    items: string
    required: false
    description: Thematic elements
    example: ["redemption", "artificial intelligence"]

  - name: moods
    type: array
    items: string
    required: false
    description: Content mood/tone
    example: ["dark", "thought-provoking"]

  # External References
  - name: external_ids
    type: object
    properties:
      imdb: string
      tmdb: integer
      tvdb: integer
      rottentomatoes: string
      metacritic: string
    required: false
    description: External database IDs

  - name: external_ratings
    type: object
    properties:
      imdb_rating: decimal
      imdb_votes: integer
      rotten_tomatoes_score: integer
      metacritic_score: integer
    required: false
    description: External ratings

  # Social Media
  - name: social_links
    type: object
    properties:
      facebook: url
      twitter: url
      instagram: url
      youtube: url
      official_site: url
    required: false
    description: Social media links

  # Trivia & Facts
  - name: trivia
    type: array
    items:
      type: object
      properties:
        fact: text
        source: string
        verified: boolean
    required: false
    description: Interesting facts/trivia

  - name: goofs
    type: array
    items:
      type: object
      properties:
        type: enum[continuity, factual, revealing, crew_visible]
        description: text
    required: false
    description: Movie mistakes/goofs

  - name: quotes
    type: array
    items:
      type: object
      properties:
        character: string
        quote: text
        context: string
    required: false
    description: Memorable quotes

  # Connections
  - name: connections
    type: array
    items:
      type: object
      properties:
        type: enum[sequel, prequel, spinoff, remake, based_on, referenced_in]
        content_id: uuid
        title: string
        description: string
    required: false
    description: Related content connections

  # Audit
  - name: created_at
    type: datetime
    required: true
    auto: true

  - name: updated_at
    type: datetime
    required: true
    auto: true

  - name: last_enriched_at
    type: datetime
    required: false
    description: Last metadata enrichment

relationships:
  - name: content
    type: belongs_to
    target: content
    foreign_key: content_id
    description: Parent content

indexes:
  - name: idx_metadata_content
    fields: [content_id]
    type: unique

  - name: idx_metadata_keywords
    fields: [keywords]
    type: gin

  - name: idx_metadata_cast
    fields: ["cast.person_id"]
    type: gin
