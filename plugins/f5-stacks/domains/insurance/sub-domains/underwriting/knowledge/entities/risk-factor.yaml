name: risk_factor
display_name: Risk Factor
description: |
  Master data entity defining individual risk factors used in underwriting
  assessment, including scoring rules, typical actions, and guidelines.

domain: insurance
subdomain: underwriting
category: entities
version: "1.0.0"
status: active

attributes:
  identification:
    - name: id
      type: uuid
      primary_key: true
      description: Unique factor identifier

    - name: factor_code
      type: string
      required: true
      unique: true
      description: Unique factor code (e.g., MED-DM-001)

    - name: name
      type: string
      required: true
      description: Factor name

    - name: description
      type: text
      description: Detailed description

    - name: status
      type: enum
      values:
        - active
        - inactive
        - under_review
      default: active
      description: Factor status

  classification:
    - name: category
      type: enum
      values:
        - medical
        - lifestyle
        - occupation
        - financial
        - family_history
        - geographic
        - behavioral
      required: true
      description: Risk category

    - name: subcategory
      type: string
      description: More specific classification

    - name: icd_codes
      type: array
      items:
        type: string
      description: Related ICD-10 codes (for medical)

  scoring:
    - name: default_score_impact
      type: integer
      min: 0
      max: 100
      description: Default score impact

    - name: severity_levels
      type: array
      items:
        type: object
        properties:
          level:
            type: enum
            values: [mild, moderate, severe, critical]
          description:
            type: string
          score_impact:
            type: integer
          loading_percent:
            type: decimal
          action:
            type: enum
            values: [accept, loading, exclusion, decline, postpone]
      description: Severity-based scoring

    - name: duration_adjustment
      type: array
      items:
        type: object
        properties:
          years_since:
            type: integer
          score_multiplier:
            type: decimal
          notes:
            type: string
      description: Time-based score adjustment

    - name: control_adjustment
      type: object
      properties:
        well_controlled_multiplier:
          type: decimal
        poorly_controlled_multiplier:
          type: decimal
      description: Control status adjustment

  action:
    - name: typical_action
      type: enum
      values:
        - accept
        - loading
        - exclusion
        - loading_and_exclusion
        - decline
        - postpone
        - individual_consideration
      description: Typical underwriting action

    - name: typical_loading_range
      type: object
      properties:
        min_percent:
          type: decimal
        max_percent:
          type: decimal
        flat_extra_applicable:
          type: boolean
        flat_extra_range:
          type: object
          properties:
            min:
              type: decimal
            max:
              type: decimal
      description: Typical loading range

    - name: typical_exclusion_wording
      type: text
      description: Standard exclusion wording

    - name: temporary_loading
      type: object
      properties:
        applicable:
          type: boolean
        typical_duration_years:
          type: integer
        review_criteria:
          type: string
      description: Temporary loading applicability

  combinations:
    - name: synergistic_factors
      type: array
      items:
        type: object
        properties:
          factor_code:
            type: string
          combination_effect:
            type: enum
            values: [additive, multiplicative, special]
          combined_loading_adjustment:
            type: decimal
          notes:
            type: string
      description: Factors that compound risk

    - name: contradictory_factors
      type: array
      items:
        type: object
        properties:
          factor_code:
            type: string
          notes:
            type: string
      description: Mutually exclusive factors

    - name: mitigating_factors
      type: array
      items:
        type: object
        properties:
          factor_code:
            type: string
          mitigation_effect:
            type: decimal
          notes:
            type: string
      description: Factors that reduce risk

  guidelines:
    - name: underwriting_guidelines
      type: text
      rich_text: true
      description: Detailed underwriting guidelines

    - name: medical_literature_reference
      type: array
      items:
        type: object
        properties:
          title:
            type: string
          source:
            type: string
          url:
            type: string
          summary:
            type: text
      description: Medical/research references

    - name: special_considerations
      type: text
      description: Special underwriting considerations

    - name: common_questions
      type: array
      items:
        type: object
        properties:
          question:
            type: string
          answer:
            type: text
      description: FAQ for underwriters

  requirements:
    - name: additional_requirements
      type: array
      items:
        type: object
        properties:
          requirement_type:
            type: string
          when_required:
            type: string
          notes:
            type: string
      description: Additional requirements when factor present

  coverage_impact:
    - name: coverage_restrictions
      type: array
      items:
        type: object
        properties:
          coverage_code:
            type: string
          restriction_type:
            type: enum
            values: [loading, exclusion, decline, limit]
          details:
            type: string
      description: Coverage-specific impacts

  audit:
    - name: effective_date
      type: date
      description: When factor became effective

    - name: last_reviewed_date
      type: date
      description: Last review date

    - name: reviewed_by
      type: string
      description: Reviewer name

    - name: created_at
      type: timestamp
      default: now()

    - name: updated_at
      type: timestamp

examples:
  - factor_code: MED-DM-001
    name: Type 2 Diabetes Mellitus
    category: medical
    severity_levels:
      - level: mild
        description: "HbA1c < 7%, no complications"
        score_impact: 15
        loading_percent: 25
        action: loading
      - level: moderate
        description: "HbA1c 7-8%, minor complications"
        score_impact: 30
        loading_percent: 75
        action: loading
      - level: severe
        description: "HbA1c > 8%, major complications"
        score_impact: 50
        loading_percent: 150
        action: loading_and_exclusion

  - factor_code: LST-SMK-001
    name: Cigarette Smoking
    category: lifestyle
    severity_levels:
      - level: mild
        description: "Occasional (<5/day)"
        score_impact: 10
        loading_percent: 25
        action: loading
      - level: moderate
        description: "Regular (5-20/day)"
        score_impact: 20
        loading_percent: 50
        action: loading
      - level: severe
        description: "Heavy (>20/day)"
        score_impact: 30
        loading_percent: 100
        action: loading

  - factor_code: OCC-HAZ-001
    name: Hazardous Occupation - Mining
    category: occupation
    default_score_impact: 40
    typical_action: loading_and_exclusion
    typical_loading_range:
      min_percent: 50
      max_percent: 100

indexes:
  - columns: [factor_code]
    unique: true
  - columns: [category]
  - columns: [status]
  - columns: [typical_action]

relationships:
  - name: risk_assessments
    type: has_many
    entity: risk_assessment
    through: assessment_risk_factors
    description: Assessments using this factor
