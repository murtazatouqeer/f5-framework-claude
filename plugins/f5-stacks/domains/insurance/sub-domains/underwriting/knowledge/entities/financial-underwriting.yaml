name: financial_underwriting
display_name: Financial Underwriting
description: |
  Financial underwriting assessment record for verifying income, assets,
  and justification for sum insured in high-value insurance applications.

domain: insurance
subdomain: underwriting
category: entities
version: "1.0.0"
status: active

attributes:
  identification:
    - name: id
      type: uuid
      primary_key: true
      description: Unique financial UW identifier

    - name: case_id
      type: uuid
      required: true
      foreign_key: underwriting_cases.id
      unique: true
      description: Reference to underwriting case

    - name: assessment_number
      type: string
      format: "FU-{case_number}"
      unique: true
      generated: true
      description: Assessment reference number

  status:
    - name: status
      type: enum
      values:
        - pending
        - in_progress
        - verified
        - concerns
        - rejected
      default: pending
      description: Assessment status

    - name: verification_level
      type: enum
      values:
        - basic
        - standard
        - enhanced
        - comprehensive
      description: Level of verification performed

  income_verification:
    - name: stated_annual_income
      type: decimal
      precision: 15
      scale: 2
      description: Applicant's stated annual income

    - name: verified_annual_income
      type: decimal
      precision: 15
      scale: 2
      description: Verified annual income

    - name: income_currency
      type: string
      default: VND
      description: Income currency

    - name: income_source
      type: enum
      values:
        - employment
        - self_employment
        - business_ownership
        - investment
        - rental
        - pension
        - multiple_sources
      description: Primary income source

    - name: employment_details
      type: object
      properties:
        employer_name:
          type: string
        position:
          type: string
        years_employed:
          type: decimal
        employment_type:
          type: enum
          values: [permanent, contract, part_time]
      description: Employment details if employed

    - name: business_details
      type: object
      properties:
        business_name:
          type: string
        business_type:
          type: string
        ownership_percentage:
          type: decimal
        years_in_business:
          type: integer
        annual_revenue:
          type: decimal
      description: Business details if self-employed

    - name: income_documents
      type: array
      items:
        type: object
        properties:
          document_type:
            type: enum
            values:
              - salary_slip
              - employment_letter
              - tax_return
              - bank_statement
              - business_registration
              - financial_statement
              - other
          document_url:
            type: string
          document_date:
            type: date
          verified:
            type: boolean
          verified_by:
            type: uuid
          verification_notes:
            type: string
      description: Income verification documents

    - name: income_verified
      type: boolean
      default: false
      description: Whether income is verified

    - name: income_verification_notes
      type: text
      description: Income verification notes

  asset_verification:
    - name: stated_net_worth
      type: decimal
      precision: 15
      scale: 2
      description: Stated net worth

    - name: verified_net_worth
      type: decimal
      precision: 15
      scale: 2
      description: Verified net worth

    - name: assets
      type: array
      items:
        type: object
        properties:
          asset_type:
            type: enum
            values:
              - real_estate
              - bank_deposits
              - investments
              - business_equity
              - vehicles
              - other
          description:
            type: string
          stated_value:
            type: decimal
          verified_value:
            type: decimal
          document_url:
            type: string
          verified:
            type: boolean
      description: Asset details

    - name: liabilities
      type: array
      items:
        type: object
        properties:
          liability_type:
            type: enum
            values:
              - mortgage
              - personal_loan
              - business_loan
              - credit_card
              - other
          description:
            type: string
          amount:
            type: decimal
      description: Liability details

  justification:
    - name: sum_insured_requested
      type: decimal
      precision: 15
      scale: 2
      description: Requested sum insured

    - name: income_multiple
      type: decimal
      precision: 5
      scale: 2
      computed: true
      description: Sum insured to income ratio

    - name: acceptable_multiple_range
      type: object
      properties:
        min:
          type: decimal
        max:
          type: decimal
      description: Acceptable income multiple range

    - name: justification_provided
      type: text
      description: Applicant's justification for sum

    - name: justification_acceptable
      type: boolean
      description: Whether justification is acceptable

    - name: justification_notes
      type: text
      description: Assessor notes on justification

    - name: purpose_of_insurance
      type: array
      items:
        type: enum
        values:
          - income_replacement
          - mortgage_protection
          - business_protection
          - key_person
          - estate_planning
          - education_fund
          - wealth_transfer
      description: Stated purposes for insurance

  existing_coverage:
    - name: existing_life_insurance
      type: array
      items:
        type: object
        properties:
          company_name:
            type: string
          policy_number:
            type: string
          sum_insured:
            type: decimal
          premium:
            type: decimal
          policy_type:
            type: string
          inception_date:
            type: date
          verified:
            type: boolean
      description: Existing life insurance policies

    - name: total_existing_coverage
      type: decimal
      precision: 15
      scale: 2
      computed: true
      description: Total existing life coverage

    - name: total_coverage_with_proposed
      type: decimal
      precision: 15
      scale: 2
      computed: true
      description: Total including proposed coverage

    - name: existing_coverage_verified
      type: boolean
      default: false
      description: Whether existing coverage verified

    - name: verification_source
      type: enum
      values:
        - industry_database
        - applicant_declaration
        - policy_documents
        - insurer_confirmation
      description: Source of verification

  red_flags:
    - name: red_flags
      type: array
      items:
        type: object
        properties:
          flag_type:
            type: enum
            values:
              - income_mismatch
              - excessive_coverage
              - rapid_policy_accumulation
              - inconsistent_information
              - unverifiable_income
              - high_risk_industry
              - undisclosed_policies
              - lifestyle_income_mismatch
          description:
            type: string
          severity:
            type: enum
            values: [low, medium, high]
          resolution:
            type: string
          resolved:
            type: boolean
      description: Identified red flags

    - name: fraud_risk_score
      type: integer
      min: 0
      max: 100
      description: Financial fraud risk score

    - name: high_risk_for_fraud
      type: boolean
      computed: true
      description: Whether high fraud risk

  decision:
    - name: financial_decision
      type: enum
      values:
        - approved
        - approved_reduced_sum
        - declined
        - pending_additional_info
      description: Financial UW decision

    - name: approved_sum_insured
      type: decimal
      precision: 15
      scale: 2
      description: Approved sum insured

    - name: reduction_reason
      type: text
      description: Reason for sum reduction (if any)

    - name: decision_reason
      type: text
      description: Overall decision rationale

    - name: decision_date
      type: timestamp
      description: Decision timestamp

    - name: decided_by
      type: uuid
      foreign_key: users.id
      description: Decision maker

  assessor:
    - name: assessed_by
      type: uuid
      foreign_key: users.id
      description: Financial underwriter

    - name: assessed_at
      type: timestamp
      description: Assessment timestamp

    - name: reviewed_by
      type: uuid
      foreign_key: users.id
      description: Senior reviewer (if applicable)

    - name: reviewed_at
      type: timestamp
      description: Review timestamp

  audit:
    - name: created_at
      type: timestamp
      default: now()

    - name: updated_at
      type: timestamp

    - name: notes
      type: text
      description: General notes

relationships:
  - name: underwriting_case
    type: belongs_to
    entity: underwriting_case
    foreign_key: case_id
    description: Parent underwriting case

  - name: assessor
    type: belongs_to
    entity: user
    foreign_key: assessed_by
    description: Assessing underwriter

  - name: reviewer
    type: belongs_to
    entity: user
    foreign_key: reviewed_by
    description: Senior reviewer

income_multiple_guidelines:
  by_age:
    age_18_30:
      employment: 20x
      self_employment: 15x
    age_31_40:
      employment: 18x
      self_employment: 12x
    age_41_50:
      employment: 15x
      self_employment: 10x
    age_51_60:
      employment: 10x
      self_employment: 8x
    age_61_plus:
      employment: 5x
      self_employment: 5x

  by_purpose:
    income_replacement: Standard multiples apply
    mortgage_protection: Up to loan amount
    key_person: Based on business valuation
    estate_planning: Based on estate value

indexes:
  - columns: [case_id]
    unique: true
  - columns: [status]
  - columns: [financial_decision]
  - columns: [created_at]

business_rules:
  - rule: Financial UW required above product thresholds
  - rule: Income multiple exceeding guidelines requires justification
  - rule: Existing coverage must be declared and verified
  - rule: Red flags require resolution before approval
