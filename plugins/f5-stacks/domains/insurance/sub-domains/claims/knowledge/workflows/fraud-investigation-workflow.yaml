name: fraud_investigation_workflow
display_name: Fraud Investigation Workflow
description: |
  Workflow for investigating suspected fraudulent claims from initial
  detection through investigation, determination, and action.

domain: insurance
subdomain: claims
category: workflows
version: "1.0.0"
status: active

workflow:
  id: WF-FRD-001
  name: Fraud Investigation
  description: Investigate suspected fraud from detection to resolution
  trigger:
    type: event
    events:
      - fraud_indicator.flagged
      - fraud_indicator.siu_referral
      - claim.manual_fraud_flag

  sla:
    initial_review: 24_hours
    desktop_investigation: 7_days
    field_investigation: 30_days
    final_determination: 45_days

stages:
  - id: receive_referral
    name: Receive Fraud Referral
    description: Process incoming fraud referral
    type: automated

    steps:
      - id: create_case
        name: Create Investigation Case
        action: create_fraud_indicator
        if_not_exists: true
        generates:
          - indicator_id
          - indicator_number

      - id: compile_information
        name: Compile Initial Information
        action: gather_case_data
        include:
          - claim_details
          - policy_details
          - claimant_history
          - red_flags_identified
          - fraud_score
          - detection_source

      - id: classify_referral
        name: Classify Referral Type
        action: categorize_case
        categories:
          - timing_indicators
          - documentation_issues
          - claim_history
          - behavioral_concerns
          - staged_incident
          - provider_fraud
          - organized_ring

    transitions:
      - to: initial_review
        condition: always

  - id: initial_review
    name: Initial SIU Review
    description: Initial assessment by SIU
    type: manual
    sla: 24_hours

    steps:
      - id: assign_investigator
        name: Assign SIU Investigator
        action: assign_case
        based_on:
          - case_type
          - complexity
          - workload
          - expertise

      - id: review_referral
        name: Review Referral Details
        action: analyze_referral
        assess:
          - validity_of_red_flags
          - fraud_probability
          - investigation_merit
          - resource_requirements

      - id: research_backgrounds
        name: Research Backgrounds
        action: background_check
        targets:
          - claimant
          - policy_holder
          - related_parties
        databases:
          - internal_claims_history
          - industry_fraud_database
          - public_records

      - id: decision_to_investigate
        name: Decide Investigation Level
        action: determine_action
        options:
          - close_no_action
          - desktop_investigation
          - field_investigation
          - immediate_denial

      - id: update_status
        name: Update Investigation Status
        action: update_fraud_indicator
        updates:
          status: under_review
          siu_investigator: "{{investigator_id}}"
          investigation_type: "{{type}}"

    transitions:
      - to: desktop_investigation
        condition: investigation_type = desktop
      - to: field_investigation
        condition: investigation_type = field
      - to: close_cleared
        condition: decision = close_no_action
      - to: immediate_action
        condition: decision = immediate_denial

  - id: desktop_investigation
    name: Desktop Investigation
    description: Office-based investigation activities
    type: manual
    sla: 7_days

    steps:
      - id: document_analysis
        name: Analyze Documents
        action: forensic_document_review
        checks:
          - authenticity_verification
          - consistency_analysis
          - metadata_examination
          - cross_reference_validation

      - id: database_searches
        name: Conduct Database Searches
        action: search_databases
        databases:
          - claims_database
          - policy_database
          - industry_fraud_registry
          - public_records
          - social_media

      - id: timeline_analysis
        name: Timeline Analysis
        action: construct_timeline
        include:
          - policy_events
          - claim_events
          - incident_timeline
          - communication_timeline

      - id: statement_analysis
        name: Analyze Statements
        action: review_statements
        compare:
          - initial_statement
          - subsequent_statements
          - witness_statements
          - third_party_accounts

      - id: financial_analysis
        name: Financial Analysis
        action: analyze_financials
        if: applicable
        review:
          - claimed_values
          - market_values
          - financial_motivations

      - id: document_findings
        name: Document Findings
        action: record_findings
        capture:
          - evidence_found
          - inconsistencies
          - supporting_documents

    transitions:
      - to: escalate_to_field
        condition: field_investigation_needed
      - to: make_determination
        condition: sufficient_evidence
      - to: close_inconclusive
        condition: insufficient_evidence

  - id: field_investigation
    name: Field Investigation
    description: On-ground investigation activities
    type: manual
    sla: 30_days

    steps:
      - id: plan_investigation
        name: Plan Field Investigation
        action: create_investigation_plan
        include:
          - objectives
          - activities
          - resources
          - timeline
          - budget

      - id: scene_investigation
        name: Scene Investigation
        action: investigate_scene
        activities:
          - site_inspection
          - photo_documentation
          - measurements
          - evidence_collection

      - id: witness_interviews
        name: Conduct Interviews
        action: interview_witnesses
        subjects:
          - claimant
          - witnesses
          - neighbors
          - service_providers
        document:
          - recorded_statements
          - signed_statements

      - id: surveillance
        name: Conduct Surveillance
        action: perform_surveillance
        if: surveillance_approved
        activities:
          - physical_surveillance
          - social_media_monitoring
          - public_records_monitoring
        duration: as_needed
        legal_compliance: required

      - id: expert_consultation
        name: Consult Experts
        action: engage_experts
        types:
          - forensic_accountant
          - medical_expert
          - engineering_expert
          - fire_investigator

      - id: provider_investigation
        name: Investigate Providers
        action: verify_providers
        if: provider_fraud_suspected
        checks:
          - provider_legitimacy
          - billing_patterns
          - service_verification

      - id: compile_evidence
        name: Compile Evidence
        action: organize_evidence
        categories:
          - documentary_evidence
          - physical_evidence
          - testimonial_evidence
          - digital_evidence

    transitions:
      - to: make_determination
        condition: investigation_complete
      - to: extend_investigation
        condition: more_time_needed

  - id: extend_investigation
    name: Extend Investigation
    description: Request investigation extension
    type: manual

    steps:
      - id: justify_extension
        name: Justify Extension
        action: document_reason
        required:
          - reason_for_extension
          - activities_remaining
          - expected_completion

      - id: request_approval
        name: Request Extension Approval
        action: submit_extension_request
        to: siu_manager

      - id: update_deadline
        name: Update Deadline
        action: extend_deadline
        if: approved

    transitions:
      - to: field_investigation
        condition: extension_approved
      - to: make_determination
        condition: extension_denied

  - id: make_determination
    name: Make Fraud Determination
    description: Determine fraud status
    type: manual

    steps:
      - id: evaluate_evidence
        name: Evaluate All Evidence
        action: assess_evidence
        criteria:
          - evidence_quality
          - evidence_consistency
          - corroboration
          - burden_of_proof

      - id: determine_outcome
        name: Determine Outcome
        action: make_determination
        options:
          - fraud_confirmed
          - suspicious_unproven
          - cleared
          - inconclusive

      - id: document_determination
        name: Document Determination
        action: record_determination
        required:
          - final_determination
          - reasoning
          - evidence_summary
          - recommendation

      - id: review_by_management
        name: Management Review
        action: submit_for_review
        to: siu_manager
        required_for:
          - fraud_confirmed
          - large_claim_value

    transitions:
      - to: fraud_confirmed_actions
        condition: determination = fraud_confirmed
      - to: proceed_with_caution
        condition: determination = suspicious_unproven
      - to: close_cleared
        condition: determination = cleared
      - to: close_inconclusive
        condition: determination = inconclusive

  - id: fraud_confirmed_actions
    name: Fraud Confirmed Actions
    description: Actions when fraud is confirmed
    type: semi_automated

    steps:
      - id: determine_claim_action
        name: Determine Claim Action
        action: decide_claim_action
        options:
          - full_denial
          - partial_denial
          - void_from_inception

      - id: determine_policy_action
        name: Determine Policy Action
        action: decide_policy_action
        options:
          - no_action
          - non_renewal
          - cancellation
          - void_ab_initio

      - id: determine_recovery
        name: Determine Recovery Action
        action: assess_recovery
        if: payments_made
        options:
          - demand_repayment
          - civil_action
          - offset_future_claims

      - id: determine_legal_action
        name: Determine Legal Action
        action: assess_legal_options
        options:
          - no_legal_action
          - civil_proceedings
          - criminal_referral

      - id: report_to_authorities
        name: Report to Authorities
        action: file_report
        if: criminal_referral
        to:
          - police
          - regulatory_body

      - id: report_to_industry
        name: Report to Industry Database
        action: submit_fraud_report
        to: industry_fraud_database

    transitions:
      - to: execute_actions
        condition: actions_determined

  - id: execute_actions
    name: Execute Fraud Actions
    description: Execute determined actions
    type: semi_automated

    steps:
      - id: execute_claim_action
        name: Execute Claim Action
        action: process_claim_action
        actions:
          denial:
            - update_claim_status
            - generate_denial_letter
            - send_denial

          void:
            - void_claim
            - reverse_payments
            - generate_void_letter

      - id: execute_policy_action
        name: Execute Policy Action
        action: process_policy_action
        actions:
          cancel:
            - cancel_policy
            - notify_policyholder

          void:
            - void_policy
            - calculate_refund
            - offset_claims_paid

      - id: initiate_recovery
        name: Initiate Recovery
        action: start_recovery
        if: recovery_required
        trigger: recovery_workflow

      - id: initiate_legal
        name: Initiate Legal Action
        action: start_legal
        if: legal_action_required
        create:
          - litigation_record
          - legal_brief

      - id: notify_stakeholders
        name: Notify Stakeholders
        action: send_notifications
        to:
          - claims_team
          - underwriting
          - legal
          - management

    transitions:
      - to: close_fraud_case
        condition: actions_executed

  - id: proceed_with_caution
    name: Proceed with Caution
    description: Handle suspicious but unproven cases
    type: manual

    steps:
      - id: flag_claim
        name: Flag Claim
        action: add_caution_flag
        visible_to:
          - claims_handlers
          - underwriting

      - id: recommend_controls
        name: Recommend Additional Controls
        action: document_recommendations
        controls:
          - enhanced_documentation
          - additional_verification
          - future_monitoring

      - id: notify_claims
        name: Notify Claims Handler
        action: send_notification
        to: claims_handler
        include:
          - investigation_summary
          - recommended_controls

      - id: return_to_claims
        name: Return to Claims
        action: release_to_claims
        with: caution_flag

    transitions:
      - to: close_investigation
        condition: claim_returned

  - id: close_cleared
    name: Close - Cleared
    description: Close case with no fraud found
    type: automated

    steps:
      - id: update_determination
        name: Update Determination
        action: update_fraud_indicator
        updates:
          final_determination: cleared
          determination_date: "{{now}}"
          status: closed

      - id: remove_flags
        name: Remove Fraud Flags
        action: clear_flags
        from: claim

      - id: notify_claims
        name: Notify Claims
        action: send_notification
        to: claims_handler
        message: fraud_investigation_cleared

      - id: return_to_normal
        name: Return to Normal Processing
        action: resume_claim_processing

    transitions:
      - to: close_investigation
        condition: always

  - id: close_inconclusive
    name: Close - Inconclusive
    description: Close case with inconclusive findings
    type: semi_automated

    steps:
      - id: update_determination
        name: Update Determination
        action: update_fraud_indicator
        updates:
          final_determination: inconclusive
          determination_date: "{{now}}"
          status: closed

      - id: add_monitoring_flag
        name: Add Monitoring Flag
        action: flag_for_monitoring
        duration: 2_years

      - id: document_learnings
        name: Document Learnings
        action: record_learnings
        for: future_reference

    transitions:
      - to: close_investigation
        condition: always

  - id: close_fraud_case
    name: Close Fraud Case
    description: Close confirmed fraud case
    type: automated

    steps:
      - id: update_status
        name: Update Final Status
        action: update_fraud_indicator
        updates:
          status: closed
          closed_at: "{{now}}"

      - id: calculate_savings
        name: Calculate Savings
        action: compute_fraud_savings
        savings:
          - claim_denied
          - recovery_initiated
          - future_claims_prevented

      - id: update_metrics
        name: Update Fraud Metrics
        action: record_metrics
        metrics:
          - case_outcome
          - investigation_cost
          - savings_achieved

    transitions:
      - to: close_investigation
        condition: always

  - id: close_investigation
    name: Close Investigation
    description: Finalize and close investigation
    type: automated

    steps:
      - id: archive_case
        name: Archive Case File
        action: archive_investigation
        include:
          - all_documents
          - all_evidence
          - all_reports

      - id: record_completion
        name: Record Completion
        action: log_completion
        metrics:
          - total_time
          - outcome
          - cost

events_emitted:
  - fraud_indicator.created
  - fraud_indicator.assigned
  - fraud_indicator.under_investigation
  - fraud_indicator.determination_made
  - fraud_indicator.confirmed
  - fraud_indicator.cleared
  - fraud_indicator.closed

metrics:
  - name: fraud_detection_rate
    description: Claims flagged for fraud
    calculation: "(flagged / total_claims) * 100"

  - name: confirmation_rate
    description: Flagged claims confirmed as fraud
    calculation: "(confirmed / flagged) * 100"

  - name: investigation_cycle_time
    description: Average investigation duration
    calculation: "AVG(closed_at - created_at)"

  - name: fraud_savings
    description: Total fraud savings
    calculation: "SUM(savings_achieved)"

  - name: recovery_rate
    description: Fraud recovery success
    calculation: "(recovered / targeted) * 100"

  - name: false_positive_rate
    description: Flagged but cleared rate
    calculation: "(cleared / flagged) * 100"
