name: litigation
display_name: Claim Litigation
description: |
  Legal proceedings related to insurance claims including lawsuits,
  arbitration, and regulatory actions.

domain: insurance
subdomain: claims
category: entities
version: "1.0.0"
status: active

attributes:
  identification:
    - name: id
      type: uuid
      primary_key: true
      description: Unique litigation identifier

    - name: claim_id
      type: uuid
      foreign_key: claim.id
      required: true
      description: Associated claim

    - name: litigation_number
      type: string
      format: "LIT-{YYYYMMDD}-{NNNN}"
      unique: true
      description: Internal litigation reference

    - name: court_case_number
      type: string
      description: Court case number

  classification:
    - name: litigation_type
      type: enum
      values:
        - lawsuit_by_claimant
        - lawsuit_by_insurer
        - third_party_action
        - subrogation_action
        - arbitration
        - mediation
        - regulatory_action
        - criminal_prosecution
      required: true
      description: Type of litigation

    - name: litigation_category
      type: enum
      values:
        - coverage_dispute
        - bad_faith
        - fraud_recovery
        - subrogation
        - contribution
        - regulatory_fine
        - criminal
      description: Litigation category

    - name: subject_matter
      type: text
      required: true
      description: Subject of litigation

  status:
    - name: status
      type: enum
      values:
        - potential
        - pre_litigation
        - filed
        - served
        - discovery
        - mediation
        - arbitration
        - trial_scheduled
        - in_trial
        - judgment_pending
        - judgment_entered
        - appeal
        - settled
        - dismissed
        - closed
      default: potential
      description: Litigation status

    - name: risk_level
      type: enum
      values:
        - low
        - medium
        - high
        - critical
      description: Risk assessment

  parties:
    - name: plaintiff
      type: object
      properties:
        name: string
        type: string
        counsel_name: string
        counsel_firm: string
        counsel_contact: string
      required: true
      description: Plaintiff details

    - name: defendant
      type: object
      properties:
        name: string
        type: string
        counsel_name: string
        counsel_firm: string
        counsel_contact: string
      required: true
      description: Defendant details

    - name: insurer_role
      type: enum
      values:
        - plaintiff
        - defendant
        - third_party
        - intervenor
      required: true
      description: Our role in litigation

    - name: other_parties
      type: array
      items:
        type: object
        properties:
          name: string
          role: string
          counsel: string
      description: Other parties involved

  venue:
    - name: court_name
      type: string
      description: Court name

    - name: court_level
      type: enum
      values:
        - district_court
        - provincial_court
        - high_court
        - supreme_court
        - arbitration_tribunal
        - regulatory_body
      description: Court level

    - name: jurisdiction
      type: string
      description: Jurisdiction

    - name: judge_name
      type: string
      description: Assigned judge

    - name: arbitrator_name
      type: string
      description: Arbitrator if applicable

  counsel:
    - name: internal_counsel
      type: object
      properties:
        name: string
        email: string
        phone: string
      description: Internal legal counsel

    - name: external_counsel
      type: object
      properties:
        firm_name: string
        attorney_name: string
        email: string
        phone: string
        engagement_date: date
        fee_arrangement: string
      description: External legal counsel

    - name: counsel_approved
      type: boolean
      default: false
      description: Panel counsel approved

  financials:
    - name: currency
      type: string
      default: VND
      description: Currency

    - name: amount_in_dispute
      type: decimal
      precision: 2
      description: Disputed amount

    - name: reserve_amount
      type: decimal
      precision: 2
      description: Litigation reserve

    - name: legal_costs_estimate
      type: decimal
      precision: 2
      description: Estimated legal costs

    - name: legal_costs_incurred
      type: decimal
      precision: 2
      default: 0
      description: Costs incurred to date

    - name: settlement_authority
      type: decimal
      precision: 2
      description: Settlement authority limit

    - name: exposure_best
      type: decimal
      precision: 2
      description: Best case exposure

    - name: exposure_likely
      type: decimal
      precision: 2
      description: Most likely exposure

    - name: exposure_worst
      type: decimal
      precision: 2
      description: Worst case exposure

  timeline:
    - name: incident_date
      type: date
      description: Date of underlying incident

    - name: demand_received_date
      type: date
      description: When demand received

    - name: filed_date
      type: date
      description: When lawsuit filed

    - name: served_date
      type: date
      description: When served

    - name: response_due_date
      type: date
      description: Response deadline

    - name: discovery_deadline
      type: date
      description: Discovery deadline

    - name: mediation_date
      type: date
      description: Mediation date

    - name: trial_date
      type: date
      description: Trial date

    - name: statute_of_limitations
      type: date
      description: Statute deadline

  key_dates:
    - name: key_dates
      type: array
      items:
        type: object
        properties:
          date: date
          event_type: string
          description: string
          completed: boolean
          outcome: text
      description: Key litigation dates

  discovery:
    - name: discovery_status
      type: enum
      values:
        - not_started
        - in_progress
        - completed
      default: not_started
      description: Discovery status

    - name: documents_produced
      type: integer
      description: Documents produced

    - name: depositions_taken
      type: array
      items:
        type: object
        properties:
          deponent_name: string
          date: date
          summary: text
          transcript_url: string
      description: Depositions taken

    - name: expert_witnesses
      type: array
      items:
        type: object
        properties:
          name: string
          specialty: string
          retained_by: string
          report_date: date
          opinion_summary: text
      description: Expert witnesses

  settlement:
    - name: settlement_discussions
      type: array
      items:
        type: object
        properties:
          date: date
          our_offer: decimal
          their_demand: decimal
          notes: text
      description: Settlement negotiation history

    - name: settlement_reached
      type: boolean
      default: false
      description: Case settled

    - name: settlement_amount
      type: decimal
      precision: 2
      description: Settlement amount

    - name: settlement_date
      type: date
      description: Settlement date

    - name: settlement_terms
      type: text
      description: Settlement terms

    - name: settlement_document_url
      type: string
      format: url
      description: Settlement agreement

  judgment:
    - name: judgment_date
      type: date
      description: Judgment date

    - name: judgment_amount
      type: decimal
      precision: 2
      description: Judgment amount

    - name: judgment_in_favor
      type: enum
      values:
        - plaintiff
        - defendant
        - mixed
      description: Judgment outcome

    - name: judgment_summary
      type: text
      description: Judgment summary

    - name: judgment_document_url
      type: string
      format: url
      description: Judgment document

    - name: interest_rate
      type: decimal
      precision: 4
      description: Post-judgment interest rate

    - name: costs_awarded
      type: decimal
      precision: 2
      description: Costs awarded

  appeal:
    - name: appeal_filed
      type: boolean
      default: false
      description: Appeal filed

    - name: appeal_filed_by
      type: enum
      values:
        - us
        - opponent
        - both
      description: Who filed appeal

    - name: appeal_court
      type: string
      description: Appellate court

    - name: appeal_case_number
      type: string
      description: Appeal case number

    - name: appeal_deadline
      type: date
      description: Appeal deadline

    - name: appeal_status
      type: enum
      values:
        - pending
        - briefing
        - oral_argument_scheduled
        - decided
      description: Appeal status

    - name: appeal_outcome
      type: text
      description: Appeal outcome

  documents:
    - name: complaint_url
      type: string
      format: url
      description: Complaint document

    - name: answer_url
      type: string
      format: url
      description: Answer document

    - name: key_documents
      type: array
      items:
        type: object
        properties:
          document_type: string
          description: string
          filed_date: date
          url: string
      description: Key litigation documents

  reporting:
    - name: reported_to_reinsurer
      type: boolean
      default: false
      description: Reported to reinsurer

    - name: reinsurer_notified_date
      type: date
      description: Reinsurer notification date

    - name: reinsurer_reference
      type: string
      description: Reinsurer reference

    - name: board_reported
      type: boolean
      default: false
      description: Reported to board

  assignment:
    - name: assigned_to
      type: uuid
      foreign_key: user.id
      required: true
      description: Claims litigation handler

    - name: supervisor
      type: uuid
      foreign_key: user.id
      description: Supervisor

  timestamps:
    - name: created_at
      type: datetime
      auto: true
      description: Record creation

    - name: updated_at
      type: datetime
      auto: true
      on_update: true
      description: Record update

    - name: closed_at
      type: datetime
      description: When closed

relationships:
  - name: claim
    type: belongs_to
    entity: claim
    foreign_key: claim_id
    description: Associated claim

  - name: handler
    type: belongs_to
    entity: user
    foreign_key: assigned_to
    description: Assigned handler

state_machine:
  initial_state: potential

  states:
    - potential:
        description: Potential litigation identified
        allowed_transitions: [pre_litigation, closed]

    - pre_litigation:
        description: Pre-litigation phase
        allowed_transitions: [filed, settled, closed]

    - filed:
        description: Lawsuit filed
        allowed_transitions: [served]

    - served:
        description: Served on defendant
        allowed_transitions: [discovery]

    - discovery:
        description: Discovery phase
        allowed_transitions: [mediation, arbitration, trial_scheduled, settled]

    - mediation:
        description: In mediation
        allowed_transitions: [settled, trial_scheduled]

    - arbitration:
        description: In arbitration
        allowed_transitions: [judgment_pending, settled]

    - trial_scheduled:
        description: Trial scheduled
        allowed_transitions: [in_trial, settled]

    - in_trial:
        description: Trial in progress
        allowed_transitions: [judgment_pending]

    - judgment_pending:
        description: Awaiting judgment
        allowed_transitions: [judgment_entered]

    - judgment_entered:
        description: Judgment entered
        allowed_transitions: [appeal, closed]

    - appeal:
        description: On appeal
        allowed_transitions: [closed]

    - settled:
        description: Settled
        allowed_transitions: [closed]

    - dismissed:
        description: Dismissed
        allowed_transitions: [closed]

    - closed:
        description: Litigation closed
        final: true

business_rules:
  - rule: BR-LIT-001
    name: Reserve required
    condition: "reserve_amount IS NOT NULL"
    when: "status NOT IN ['potential', 'closed']"
    error_message: "Litigation reserve required"

  - rule: BR-LIT-002
    name: Counsel required
    condition: "external_counsel.firm_name IS NOT NULL"
    when: "status = 'filed'"
    error_message: "External counsel required for filed cases"

  - rule: BR-LIT-003
    name: Reinsurer notification
    condition: "amount_in_dispute > 1000000000 IMPLIES reported_to_reinsurer = true"
    error_message: "Large litigation must be reported to reinsurer"

events:
  - name: litigation.created
    description: Litigation matter created
    payload: [litigation_id, claim_id, litigation_type]

  - name: litigation.filed
    description: Lawsuit filed
    payload: [litigation_id, court_case_number, amount_in_dispute]

  - name: litigation.settled
    description: Litigation settled
    payload: [litigation_id, settlement_amount]

  - name: litigation.judgment
    description: Judgment entered
    payload: [litigation_id, judgment_amount, judgment_in_favor]

  - name: litigation.closed
    description: Litigation closed
    payload: [litigation_id, outcome]

api_endpoints:
  - method: POST
    path: /claims/{claim_id}/litigation
    description: Create litigation
    request_body: LitigationCreateRequest
    response: LitigationResponse

  - method: GET
    path: /claims/{claim_id}/litigation
    description: List litigation
    response: LitigationListResponse

  - method: GET
    path: /claims/{claim_id}/litigation/{id}
    description: Get litigation details
    response: LitigationResponse

  - method: PUT
    path: /claims/{claim_id}/litigation/{id}
    description: Update litigation
    request_body: LitigationUpdateRequest
    response: LitigationResponse

  - method: POST
    path: /claims/{claim_id}/litigation/{id}/add-key-date
    description: Add key date
    request_body: KeyDateRequest
    response: LitigationResponse

  - method: POST
    path: /claims/{claim_id}/litigation/{id}/record-settlement
    description: Record settlement
    request_body: SettlementRequest
    response: LitigationResponse

  - method: POST
    path: /claims/{claim_id}/litigation/{id}/record-judgment
    description: Record judgment
    request_body: JudgmentRequest
    response: LitigationResponse
