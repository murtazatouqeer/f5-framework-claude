name: LastMile
display_name: Last-Mile Delivery
description: |
  Last-mile delivery management sub-domain for the Livestock Agricultural Marketplace.
  Handles the final leg of delivery from distribution hub to recipient's doorstep.
  Includes delivery scheduling, agent management, proof of delivery, and reverse logistics.

domain: logistics
subdomain: last-mile
version: "1.0.0"
status: active

overview:
  purpose: |
    Manage the final delivery phase from local hub to customer location,
    ensuring timely, accurate, and customer-friendly delivery experience
    with full tracking and proof of delivery capabilities.

  scope:
    included:
      - Delivery scheduling and slot management
      - Delivery agent (rider/driver) management
      - Real-time delivery tracking
      - Proof of delivery capture
      - Failed delivery handling
      - Return pickup (reverse logistics)
      - Smart locker and pickup point integration
      - Cash on delivery (COD) management
      - Delivery notifications and communication
      - Performance metrics and SLA monitoring
    excluded:
      - Warehouse operations (see warehouse sub-domain)
      - Long-haul transportation (see fleet sub-domain)
      - Order management (see e-commerce domain)
      - Payment processing (handled by payment domain)

  target_users:
    - Recipients (end customers)
    - Delivery agents (riders, drivers)
    - Operations managers
    - Customer service representatives
    - Zone managers

core_capabilities:
  delivery_management:
    description: End-to-end delivery lifecycle management
    features:
      - Delivery creation and assignment
      - Real-time status tracking
      - Time slot and window management
      - Multi-attempt delivery handling
      - Proof of delivery capture
      - Exception handling

  agent_management:
    description: Delivery workforce management
    features:
      - Agent onboarding and verification
      - Shift and availability management
      - Performance tracking and scoring
      - Earnings and incentive calculation
      - Route optimization
      - Real-time location tracking

  recipient_experience:
    description: Customer-facing delivery experience
    features:
      - Live tracking with ETA
      - Delivery rescheduling
      - Address and slot changes
      - Safe place authorization
      - Agent communication
      - Rating and feedback

  alternative_delivery:
    description: Non-doorstep delivery options
    features:
      - Smart locker integration
      - Pickup point network
      - Neighbor delivery
      - Collection points

  reverse_logistics:
    description: Return and pickup management
    features:
      - Return pickup scheduling
      - Return item verification
      - Reverse delivery tracking
      - Return to warehouse

  cod_management:
    description: Cash on delivery handling
    features:
      - COD collection tracking
      - Payment verification
      - Daily reconciliation
      - Cash deposit management

entities:
  primary:
    - name: Delivery
      description: Core delivery record with full lifecycle
    - name: DeliveryAgent
      description: Delivery personnel (riders, drivers)
    - name: Parcel
      description: Individual package being delivered
    - name: DeliveryZone
      description: Geographic delivery coverage area
    - name: DeliverySlot
      description: Time window for scheduled delivery

  supporting:
    - name: DeliveryAttempt
      description: Record of each delivery attempt
    - name: ProofOfDelivery
      description: Delivery confirmation evidence
    - name: Recipient
      description: Delivery recipient profile
    - name: DeliveryException
      description: Issues and exceptions during delivery
    - name: ReturnPickup
      description: Reverse logistics pickup

  infrastructure:
    - name: Locker
      description: Smart locker location and compartments
    - name: PickupPoint
      description: PUDO location for collection
    - name: RatingFeedback
      description: Delivery ratings and reviews
    - name: DeliveryNotification
      description: Communication records

business_rules:
  categories:
    - name: Delivery Assignment
      file: delivery-assignment-rules.yaml
      description: Rules for assigning deliveries to agents
    - name: Time Slot Management
      file: time-slot-rules.yaml
      description: Slot availability, booking, and pricing rules
    - name: Attempt Management
      file: attempt-rules.yaml
      description: Retry logic and failure handling
    - name: Proof of Delivery
      file: pod-rules.yaml
      description: POD requirements and validation
    - name: SLA Management
      file: sla-rules.yaml
      description: Service level definitions and breach handling

workflows:
  primary:
    - name: Delivery Workflow
      file: delivery-workflow.yaml
      description: Standard delivery execution
    - name: Failed Delivery Workflow
      file: failed-delivery-workflow.yaml
      description: Handling unsuccessful deliveries
    - name: Return Pickup Workflow
      file: return-pickup-workflow.yaml
      description: Reverse logistics process

  specialized:
    - name: Locker Delivery Workflow
      file: locker-delivery-workflow.yaml
      description: Smart locker deposit and pickup
    - name: COD Workflow
      file: cod-workflow.yaml
      description: Cash on delivery collection

use_cases:
  by_actor:
    - actor: Recipient
      file: recipient-use-cases.yaml
      count: 13
    - actor: Delivery Agent
      file: delivery-agent-use-cases.yaml
      count: 14
    - actor: Operations
      file: operations-use-cases.yaml
      count: 10

integrations:
  internal:
    - domain: logistics
      subdomain: warehouse
      purpose: Pickup from hub, return processing
    - domain: logistics
      subdomain: fleet
      purpose: Vehicle and driver data for agents
    - domain: e-commerce
      subdomain: order
      purpose: Order and shipment information
    - domain: common
      subdomain: notification
      purpose: SMS, push, email notifications
    - domain: common
      subdomain: payment
      purpose: COD reconciliation

  external:
    - name: Google Maps
      purpose: Navigation and ETA calculation
    - name: SMS Gateway
      purpose: OTP and notification delivery
    - name: Smart Locker API
      purpose: Locker access and status

metrics:
  operational:
    - name: delivery_success_rate
      description: Percentage of successful first-attempt deliveries
      target: ">90%"
    - name: on_time_delivery_rate
      description: Percentage delivered within promised window
      target: ">95%"
    - name: average_delivery_time
      description: Time from dispatch to completion
      unit: minutes
    - name: failed_delivery_rate
      description: Percentage of failed deliveries
      target: "<5%"

  agent_performance:
    - name: deliveries_per_hour
      description: Agent productivity metric
    - name: agent_rating
      description: Average customer rating per agent
      target: ">4.5"
    - name: agent_utilization
      description: Active time vs shift time

  customer_experience:
    - name: customer_satisfaction
      description: CSAT score for deliveries
      target: ">4.3"
    - name: nps_score
      description: Net Promoter Score
    - name: complaint_rate
      description: Complaints per 1000 deliveries

sla_definitions:
  instant:
    description: Immediate delivery
    timeframe: 2 hours
    availability: Limited zones
  same_day:
    description: Delivery by end of day
    timeframe: Same day by 9 PM
    cutoff: Order before 11 AM
  express:
    description: Next-day priority
    timeframe: Next day by 12 PM
  standard:
    description: Regular delivery
    timeframe: 2-3 business days

delivery_types:
  - type: doorstep
    description: Delivery to recipient's address
    default: true
  - type: locker
    description: Smart locker deposit
    recipient_pickup: true
  - type: pickup_point
    description: Collection from partner location
    recipient_pickup: true
  - type: safe_place
    description: Pre-authorized location (porch, mailbox)
    contactless: true

technology_stack:
  mobile_app:
    agent_app: React Native
    features:
      - GPS tracking
      - Barcode scanning
      - Signature capture
      - Photo capture
      - Navigation integration
      - Offline mode

  tracking:
    real_time: WebSocket
    update_frequency: 30 seconds
    battery_optimization: true

  notifications:
    channels:
      - push
      - sms
      - email
      - whatsapp
    templates: Multi-language

compliance:
  data_privacy:
    - Recipient address protection
    - Location data retention limits
    - Right to be forgotten support

  operational:
    - Contactless delivery options
    - Age verification capability
    - ID verification for restricted items

glossary_reference: glossary.yaml
