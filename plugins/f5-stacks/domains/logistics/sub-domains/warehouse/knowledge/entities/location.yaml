name: Location
display_name: Storage Location
description: |
  Physical storage location within a warehouse.
  Uses hierarchical addressing: Aisle-Rack-Level-Position.

domain: logistics
subdomain: warehouse
category: core

attributes:
  - name: id
    type: uuid
    required: true

  - name: location_code
    type: string
    required: true
    description: Hierarchical location code
    validation:
      pattern: "^[A-Z]-[0-9]{2}-[0-9]{2}-[0-9]{2}$"
    example: "A-01-02-03"

  - name: warehouse_id
    type: uuid
    required: true

  - name: zone_id
    type: uuid
    required: true

  - name: status
    type: enum
    required: true
    validation:
      values: [active, inactive, blocked, reserved]
    default: active

  - name: location_type
    type: enum
    required: true
    validation:
      values: [storage, staging, receiving, shipping, qa_hold, damaged, returns, pack_station]

  # Physical Position
  - name: aisle
    type: string
    required: true
    example: "A"

  - name: rack
    type: string
    required: true
    example: "01"

  - name: level
    type: string
    required: true
    example: "02"

  - name: position
    type: string
    required: true
    example: "03"

  # Dimensions
  - name: width_cm
    type: decimal
    required: false

  - name: depth_cm
    type: decimal
    required: false

  - name: height_cm
    type: decimal
    required: false

  - name: max_weight_kg
    type: decimal
    required: false
    description: Maximum weight capacity

  - name: storage_type
    type: enum
    required: true
    validation:
      values: [floor, shelf, pallet_rack, drive_in, cantilever, mezzanine, flow_rack]

  # Characteristics
  - name: is_pickable
    type: boolean
    required: true
    default: true
    description: Can pick from this location

  - name: is_storable
    type: boolean
    required: true
    default: true
    description: Can store in this location

  - name: is_replenishment_source
    type: boolean
    required: true
    default: false

  - name: pick_sequence
    type: integer
    required: false
    description: Order in pick path for wave picking

  - name: putaway_sequence
    type: integer
    required: false

  # Current State
  - name: current_item_id
    type: uuid
    required: false

  - name: current_quantity
    type: integer
    required: true
    default: 0

  - name: current_lpn
    type: string
    required: false
    description: Current License Plate Number

  - name: is_empty
    type: boolean
    required: true
    default: true

  - name: is_full
    type: boolean
    required: true
    default: false

  - name: last_activity_at
    type: timestamp
    required: false

  # Constraints
  - name: velocity_class
    type: enum
    required: false
    validation:
      values: [A, B, C, D]
    description: A=fast moving, D=slow moving

  - name: allowed_item_types
    type: array
    required: false

  - name: temperature_zone
    type: enum
    required: false
    validation:
      values: [ambient, chilled, frozen]
    default: ambient

  - name: max_items
    type: integer
    required: false

  - name: max_lpns
    type: integer
    required: false

  # Timestamps
  - name: created_at
    type: timestamp
    required: true

  - name: updated_at
    type: timestamp
    required: true

relationships:
  - name: warehouse
    type: belongs_to
    entity: Warehouse
    required: true

  - name: zone
    type: belongs_to
    entity: Zone
    required: true

  - name: inventory
    type: has_many
    entity: Inventory

  - name: current_item
    type: belongs_to
    entity: Item
    required: false

indexes:
  - [warehouse_id, location_code]
  - [zone_id]
  - [status]
  - [is_empty]
  - [velocity_class]
  - [pick_sequence]

computed_fields:
  - name: available_capacity
    formula: max_weight_kg - current_weight
  - name: utilization_percent
    formula: (current_quantity / max_items) * 100

business_rules:
  - BR-LOC-001: Location code must be unique within warehouse
  - BR-LOC-002: Pick locations must be at accessible heights
  - BR-LOC-003: Heavy items should be at floor or lower levels
  - BR-LOC-004: Temperature zone must match zone temperature
