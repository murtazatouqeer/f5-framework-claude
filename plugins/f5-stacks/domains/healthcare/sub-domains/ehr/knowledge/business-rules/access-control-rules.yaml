# =============================================================================
# ACCESS CONTROL RULES - EHR Sub-domain
# Quy tắc Kiểm soát Truy cập
# =============================================================================
# Compliance: HIPAA Security Rule, NIST Cybersecurity Framework
# =============================================================================

name: AccessControlRules
display_name: Access Control Rules / Quy tắc Kiểm soát Truy cập
version: "1.0"
domain: healthcare
sub_domain: ehr
category: security

# =============================================================================
# ROLE-BASED ACCESS CONTROL (RBAC)
# =============================================================================
role_based_access:
  - id: ACR-RBAC-001
    name: Role Definition and Assignment
    description: |
      Define roles based on job function and minimum necessary principle.
      Assign users to roles, not directly to permissions.
    regulation: HIPAA 164.312(a)(1)
    enforcement: mandatory
    principles:
      - least_privilege: only_access_needed_for_job
      - separation_of_duties: prevent_fraud_errors
      - need_to_know: clinical_or_operational_necessity
    role_hierarchy:
      clinical:
        - attending_physician
        - consulting_physician
        - resident_physician
        - nurse_practitioner
        - physician_assistant
        - registered_nurse
        - licensed_practical_nurse
        - medical_assistant
        - pharmacist
        - pharmacy_technician
        - therapist
        - social_worker
        - case_manager
      administrative:
        - registration_clerk
        - scheduling_clerk
        - billing_specialist
        - coding_specialist
        - health_information_specialist
        - unit_secretary
      technical:
        - system_administrator
        - security_administrator
        - interface_analyst
        - report_developer
      executive:
        - department_manager
        - medical_director
        - chief_medical_officer
        - compliance_officer
        - privacy_officer

  - id: ACR-RBAC-002
    name: Role Permission Matrix
    description: |
      Define specific permissions for each role.
      Document and regularly review access levels.
    enforcement: mandatory
    permission_types:
      - read: view_information
      - write: create_or_modify
      - delete: remove_information
      - print: generate_hard_copy
      - export: extract_data
      - transmit: send_outside_system
      - order: place_clinical_orders
      - sign: authenticate_documents
      - prescribe: write_prescriptions
      - administer: give_medications
    sample_matrix:
      attending_physician:
        own_patients: [read, write, order, sign, prescribe, print]
        department_patients: [read]
        hospital_patients: [emergency_only_with_break_glass]
      registered_nurse:
        own_patients: [read, write, administer]
        unit_patients: [read]
        medication_administration: [administer_with_verification]
      registration_clerk:
        demographics: [read, write]
        clinical_data: [none]
        scheduling: [read, write]

  - id: ACR-RBAC-003
    name: Role Assignment Process
    description: |
      Formal process for assigning roles to users.
      Requires manager approval and HR verification.
    enforcement: mandatory
    process:
      step_1: Manager submits access request
      step_2: HR verifies employment and job function
      step_3: Security reviews for separation of duties
      step_4: Access granted with audit trail
      step_5: User notified and signs acceptable use policy
    provisioning:
      new_hire: within_24_hours_of_start
      role_change: within_24_hours_of_effective_date
      termination: immediate_upon_notification

# =============================================================================
# CARE TEAM ACCESS
# =============================================================================
care_team_access:
  - id: ACR-TEAM-001
    name: Care Team Definition
    description: |
      Automatically determine care team based on clinical relationships.
      Includes providers with active orders or encounters.
    enforcement: mandatory
    care_team_members:
      - attending_physician
      - consulting_physicians_with_active_orders
      - primary_care_provider
      - residents_on_service
      - nurses_assigned_to_patient
      - pharmacists_with_active_orders
      - therapists_with_active_orders
      - case_managers_assigned
    determination_criteria:
      - active_encounter_relationship
      - active_orders_in_last_30_days
      - scheduled_appointment
      - explicit_assignment

  - id: ACR-TEAM-002
    name: Care Team Access Privileges
    description: |
      Care team members have enhanced access without break-the-glass.
      Access is automatically revoked when relationship ends.
    enforcement: mandatory
    privileges:
      - full_chart_access: care_team_members
      - sensitive_data_access: per_consent_and_role
      - order_entry: per_credential
      - documentation: per_credential
    access_duration:
      inpatient: duration_of_admission
      outpatient: encounter_date_plus_30_days
      primary_care: ongoing_until_changed

  - id: ACR-TEAM-003
    name: Cross-Department Access
    description: |
      Access for providers outside primary department.
      Consults and shared care arrangements.
    enforcement: mandatory
    access_granted_for:
      - active_consultation_request
      - surgery_scheduled
      - procedure_scheduled
      - shared_care_agreement
    access_revoked_when:
      - consultation_completed
      - post_procedure_period_ends
      - explicit_removal

# =============================================================================
# SENSITIVE DATA HANDLING
# =============================================================================
sensitive_data_access:
  - id: ACR-SENS-001
    name: Sensitive Data Categories
    description: |
      Identify categories requiring enhanced protection.
      Restrict access based on consent and need.
    regulation: State laws, 42 CFR Part 2
    enforcement: mandatory
    categories:
      - id: mental_health
        protection_level: high
        consent_required: state_dependent
        access: treating_mental_health_providers
      - id: substance_abuse
        protection_level: highest
        consent_required: always_42cfr_part2
        access: substance_abuse_program_only
      - id: hiv_aids
        protection_level: high
        consent_required: state_dependent
        access: treating_providers_with_consent
      - id: sexual_health
        protection_level: high
        consent_required: state_dependent
        access: ob_gyn_and_treating_providers
      - id: genetic_information
        protection_level: high
        consent_required: for_disclosure
        access: genetics_counselors_and_treating_providers
      - id: domestic_violence
        protection_level: high
        consent_required: not_required_but_protected
        access: social_work_and_treating_providers

  - id: ACR-SENS-002
    name: Sensitive Data Segmentation
    description: |
      Technically segment sensitive data for access control.
      Implement consent-based disclosure.
    enforcement: mandatory
    implementation:
      - data_tagging: sensitivity_level_marked
      - consent_checking: before_disclosure
      - access_logging: enhanced_for_sensitive
      - display_suppression: unless_authorized
    disclosure_rules:
      substance_abuse:
        requires: explicit_written_consent
        exceptions: [medical_emergency, court_order]
      mental_health:
        requires: per_state_law
        exceptions: [danger_to_self_or_others]

  - id: ACR-SENS-003
    name: VIP and Restricted Access
    description: |
      Enhanced protection for VIP patients.
      Restrict access to explicitly authorized staff.
    enforcement: mandatory
    vip_protections:
      access_restriction: approved_list_only
      name_suppression: alias_displayed
      logging_enhanced: real_time_alerts
      location_masking: optional
    restricted_categories:
      - employees_and_family
      - celebrities
      - politicians
      - witness_protection
      - patient_requested_restriction

# =============================================================================
# EXTERNAL AND PORTAL ACCESS
# =============================================================================
external_access:
  - id: ACR-EXT-001
    name: Patient Portal Access
    description: |
      Secure access for patients to view their records.
      Authentication and identity verification required.
    regulation: 21st Century Cures Act
    enforcement: mandatory
    authentication:
      - identity_verification: required_at_enrollment
      - login_credentials: username_and_password
      - multi_factor_authentication: recommended
      - session_timeout: 15_minutes_inactivity
    available_information:
      - demographics
      - medications
      - allergies
      - immunizations
      - lab_results_after_release
      - visit_summaries
      - clinical_notes_after_release
    restricted_information:
      - psychotherapy_notes
      - information_compiled_for_legal_proceedings
      - information_subject_to_privacy_act

  - id: ACR-EXT-002
    name: Proxy Access
    description: |
      Allow designated representatives to access patient portal.
      Parent/guardian access for minors with age restrictions.
    enforcement: mandatory
    proxy_types:
      - parent_guardian: for_minors
      - healthcare_proxy: for_incapacitated
      - power_of_attorney: with_valid_document
      - caregiver: with_patient_authorization
    minor_restrictions:
      - age_12_to_18: reproductive_mental_health_restricted
      - emancipated_minor: patient_controls_access
    verification:
      - legal_document_required
      - periodic_revalidation

  - id: ACR-EXT-003
    name: Health Information Exchange Access
    description: |
      Access controls for external HIE participants.
      Query-based and document exchange access.
    enforcement: mandatory
    participant_types:
      - treating_providers: query_permitted
      - care_coordination: per_patient_consent
      - public_health: per_reporting_requirements
    access_controls:
      - patient_consent_status: checked_before_disclosure
      - purpose_of_use: specified_and_logged
      - provider_verification: npi_and_credentials

  - id: ACR-EXT-004
    name: Third-Party Application Access
    description: |
      API access for patient-authorized applications.
      SMART on FHIR authorization framework.
    regulation: 21st Century Cures Act, ONC Final Rule
    enforcement: mandatory
    requirements:
      - patient_authorization: explicit_consent
      - scope_limitation: only_authorized_data
      - token_based_access: oauth_2_0
      - access_logging: all_api_calls
    prohibited:
      - information_blocking
      - unreasonable_fees
      - excessive_restrictions

# =============================================================================
# EMERGENCY ACCESS
# =============================================================================
emergency_access:
  - id: ACR-EMER-001
    name: Emergency Access Procedures
    description: |
      Access procedures during system downtime.
      Maintain patient care continuity.
    enforcement: mandatory
    downtime_procedures:
      - paper_documentation_available
      - critical_information_printouts
      - medication_administration_records
      - admission_discharge_tracking
    recovery_procedures:
      - paper_documentation_entry
      - reconciliation_of_records
      - audit_of_downtime_access

  - id: ACR-EMER-002
    name: Mass Casualty Access
    description: |
      Expanded access during declared emergencies.
      Disaster patient tracking access.
    enforcement: mandatory
    activation:
      - emergency_declared_by_authorized_official
      - documented_activation_time
    expanded_access:
      - all_clinical_staff: basic_patient_information
      - emergency_operations: tracking_and_coordination
    logging:
      - enhanced_logging_during_emergency
      - post_event_review_required

# =============================================================================
# AUTHENTICATION REQUIREMENTS
# =============================================================================
authentication_rules:
  - id: ACR-AUTH-001
    name: User Authentication Standards
    description: |
      Unique user identification and authentication.
      Password or multi-factor authentication required.
    regulation: HIPAA 164.312(d)
    enforcement: mandatory
    requirements:
      - unique_user_id: no_shared_accounts
      - password_complexity: minimum_standards
      - password_expiration: 90_days
      - account_lockout: after_5_failed_attempts
      - session_timeout: 15_minutes_inactivity
    password_standards:
      minimum_length: 12
      require_uppercase: true
      require_lowercase: true
      require_number: true
      require_special_character: true
      prohibit_previous_passwords: 12

  - id: ACR-AUTH-002
    name: Multi-Factor Authentication
    description: |
      MFA required for remote access and sensitive functions.
      Something you know + something you have.
    enforcement: mandatory
    required_for:
      - remote_access: always
      - administrative_functions: always
      - prescribing_controlled_substances: epcs_requirement
      - access_to_sensitive_data: recommended
    accepted_factors:
      - password: something_you_know
      - token: something_you_have
      - biometric: something_you_are
      - push_notification: something_you_have

  - id: ACR-AUTH-003
    name: Single Sign-On
    description: |
      Facilitate secure access with SSO while maintaining audit trail.
      Ensure all access is logged to individual user.
    enforcement: recommended
    requirements:
      - individual_accountability: maintained
      - session_management: secure
      - context_awareness: clinical_context_passed
    restrictions:
      - no_shared_sessions
      - no_saved_passwords_for_phi_systems

# =============================================================================
# ACCESS REVIEW AND AUDIT
# =============================================================================
access_review:
  - id: ACR-REV-001
    name: Periodic Access Review
    description: |
      Regular review of user access rights.
      Verify access is appropriate for current job function.
    regulation: HIPAA 164.308(a)(4)
    enforcement: mandatory
    frequency:
      all_users: annually
      privileged_users: quarterly
      terminated_users: immediately
    process:
      step_1: Generate access report per user
      step_2: Manager reviews and attests
      step_3: Remove unnecessary access
      step_4: Document review completion

  - id: ACR-REV-002
    name: Access Audit Logging
    description: |
      Comprehensive logging of all PHI access.
      Tamper-evident, retained per policy.
    regulation: HIPAA 164.312(b)
    enforcement: mandatory
    logged_events:
      - login_logout
      - patient_record_access
      - data_modification
      - data_export_or_print
      - failed_access_attempts
      - privilege_escalation
    log_contents:
      - user_id
      - patient_id
      - action_performed
      - timestamp
      - workstation_id
      - ip_address
    retention: 6_years

  - id: ACR-REV-003
    name: Anomaly Detection
    description: |
      Automated detection of unusual access patterns.
      Alert security team for investigation.
    enforcement: mandatory
    anomaly_triggers:
      - after_hours_access: flag_for_review
      - high_volume_access: immediate_alert
      - access_outside_job_function: flag_for_review
      - access_to_vip_patients: real_time_alert
      - access_from_unusual_location: require_verification
    response:
      - automated_alert: to_security_team
      - investigation: within_24_hours
      - escalation: if_violation_confirmed

# =============================================================================
# ACCOUNT MANAGEMENT
# =============================================================================
account_management:
  - id: ACR-ACCT-001
    name: Account Provisioning
    description: |
      Process for creating and configuring user accounts.
      HR integration for employment verification.
    enforcement: mandatory
    process:
      step_1: HR creates employee record
      step_2: Manager submits access request
      step_3: Security provisions account
      step_4: User completes training
      step_5: Access activated
    timing:
      new_hire: before_first_day
      contractor: upon_contract_start
      student: upon_rotation_start

  - id: ACR-ACCT-002
    name: Account Modification
    description: |
      Process for modifying access when role changes.
      Ensure access matches new responsibilities.
    enforcement: mandatory
    triggers:
      - job_transfer
      - promotion_demotion
      - department_change
      - temporary_assignment
    process:
      - remove_old_role_access
      - add_new_role_access
      - document_change_reason

  - id: ACR-ACCT-003
    name: Account Termination
    description: |
      Immediate access removal upon termination.
      Revoke all system access and credentials.
    enforcement: mandatory
    timing:
      voluntary_termination: end_of_last_day
      involuntary_termination: immediately
      death: upon_notification
    actions:
      - disable_account
      - revoke_remote_access
      - collect_physical_tokens
      - revoke_proxy_access
      - notify_security_team
