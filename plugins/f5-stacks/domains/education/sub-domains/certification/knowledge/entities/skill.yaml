# Skill Entity
# F5 Framework v2.0 - Education/Certification
# Skills taxonomy for credentials

entity:
  id: skill
  name: Skill
  name_ja: スキル
  domain: education
  subdomain: certification
  version: "1.0.0"
  
  description: |
    Represents a skill or competency that can be associated with
    certifications, badges, courses, and credential holders. Part of
    a structured skills taxonomy.

  attributes:
    # Identity
    - name: id
      type: uuid
      primary_key: true
      
    - name: skill_id
      type: string
      format: "SKL-{XXXXXXXX}"
      unique: true
      indexed: true
      
    - name: skill_code
      type: string
      max_length: 50
      unique: true
      indexed: true
      example: "AWS-CLOUD-001"

    # Basic Info
    - name: name
      type: string
      max_length: 200
      required: true
      indexed: true
      
    - name: name_ja
      type: string
      max_length: 200
      
    - name: description
      type: text
      
    - name: short_description
      type: string
      max_length: 500

    # Status
    - name: status
      type: enum
      values: [draft, active, deprecated, retired]
      default: active
      indexed: true

    # Taxonomy
    - name: category
      type: string
      max_length: 100
      indexed: true
      description: Primary skill category
      
    - name: subcategory
      type: string
      max_length: 100
      
    - name: parent_skill_id
      type: uuid
      foreign_key: skill.id
      indexed: true
      description: Parent skill for hierarchy
      
    - name: skill_level
      type: integer
      default: 0
      description: Depth in skill hierarchy

    # Classification
    - name: skill_type
      type: enum
      values: [technical, soft, domain, tool, methodology, language, framework]
      indexed: true
      
    - name: industry
      type: array
      items: string
      description: Relevant industries
      
    - name: job_roles
      type: array
      items: string
      description: Related job roles

    # Proficiency Levels
    - name: has_levels
      type: boolean
      default: true
      
    - name: proficiency_levels
      type: jsonb
      description: Defined proficiency levels
      schema:
        - level: integer
          name: string
          description: string
          criteria: array

    # Alignment
    - name: framework_alignments
      type: jsonb
      description: Alignment to external frameworks
      schema:
        - framework: string
          framework_url: string
          code: string
          name: string
          description: string
      example:
        - framework: "SFIA"
          code: "PROG"
          name: "Programming/Software Development"
        - framework: "ESCO"
          code: "S1.1"

    # Relationships
    - name: related_skills
      type: array
      items: uuid
      description: Related skill IDs
      
    - name: prerequisite_skills
      type: array
      items: uuid
      description: Required prior skills

    # Content
    - name: icon_url
      type: string
      max_length: 500
      
    - name: badge_image_url
      type: string
      max_length: 500
      description: Badge for this skill
      
    - name: keywords
      type: array
      items: string
      description: Search keywords
      
    - name: aliases
      type: array
      items: string
      description: Alternative names

    # Assessment
    - name: assessable
      type: boolean
      default: true
      description: Can be directly assessed
      
    - name: assessment_method
      type: enum
      values: [exam, project, portfolio, observation, self_assessment]
      
    - name: assessment_criteria
      type: text

    # Usage Stats
    - name: certificates_count
      type: integer
      default: 0
      description: Certificates with this skill
      
    - name: badges_count
      type: integer
      default: 0
      description: Badges with this skill
      
    - name: holders_count
      type: integer
      default: 0
      description: Holders with this skill

    # External IDs
    - name: external_ids
      type: jsonb
      description: IDs in external systems
      schema:
        linkedin_skill_id: string
        onet_code: string
        esco_uri: string

    # Metadata
    - name: version
      type: integer
      default: 1
      
    - name: created_by
      type: uuid
      foreign_key: user.id
      
    - name: created_at
      type: timestamp
      auto: true
      
    - name: updated_at
      type: timestamp
      auto: true

  computed_fields:
    - name: full_path
      formula: "Get full taxonomy path from root to this skill"
      
    - name: child_count
      formula: "COUNT(skills WHERE parent_skill_id = id)"

  relationships:
    - name: parent_skill
      type: belongs_to
      entity: skill
      foreign_key: parent_skill_id
      
    - name: child_skills
      type: has_many
      entity: skill
      foreign_key: parent_skill_id
      
    - name: certificates
      type: has_many
      entity: certificate
      through: skills_certified
      
    - name: badges
      type: has_many
      entity: badge
      through: skills
      
    - name: programs
      type: has_many
      entity: certification_program
      through: skills
      
    - name: endorsements
      type: has_many
      entity: endorsement
      foreign_key: skill_id

  indexes:
    - fields: [name]
      name: idx_skill_name
      
    - fields: [category, status]
      name: idx_category_status
      
    - fields: [skill_code]
      unique: true
      name: idx_skill_code

  validations:
    - field: name
      rule: unique
      scope: [category]
      message: Skill name must be unique within category

  skill_frameworks:
    - name: SFIA
      description: Skills Framework for the Information Age
      url: https://sfia-online.org/
      
    - name: ESCO
      description: European Skills/Competences classification
      url: https://ec.europa.eu/esco/
      
    - name: O*NET
      description: Occupational Information Network
      url: https://www.onetonline.org/
