# Learning Workflow
# F5 Framework v2.0 - Education/LMS
# End-to-end workflow for the learning experience

workflow:
  id: learning-workflow
  name: Learning Workflow
  name_ja: 学習ワークフロー
  description: Complete workflow for learner's course experience
  domain: education
  subdomain: lms
  version: "1.0.0"

  actors:
    primary:
      - learner
    supporting:
      - instructor
      - teaching_assistant
      - peer_learners
    system:
      - progress_tracker
      - recommendation_engine
      - notification_service

  triggers:
    - event: course_accessed
      source: learner_dashboard
    - event: continue_learning_clicked
      source: home_page
    - event: notification_clicked
      source: email_or_push

  states:
    not_started:
      description: Enrolled but not begun
      name_ja: 未開始
      
    in_progress:
      description: Actively learning
      name_ja: 学習中
      
    paused:
      description: Temporarily paused
      name_ja: 一時停止
      
    stuck:
      description: Needs help to progress
      name_ja: 停滞中
      
    near_completion:
      description: Almost finished
      name_ja: 完了間近
      
    completed:
      description: Course completed
      name_ja: 完了

  stages:
    # Stage 1: Onboarding
    - id: onboarding
      name: Course Onboarding
      name_ja: コースオンボーディング
      state: not_started
      
      steps:
        - id: welcome_experience
          name: Welcome Experience
          actor: system
          action: show_welcome
          displays:
            - course_overview_video
            - instructor_introduction
            - learning_path_preview
            - expected_outcomes
            
        - id: set_goals
          name: Set Learning Goals
          actor: learner
          action: set_goals
          inputs:
            - completion_target_date
            - weekly_time_commitment
            - learning_objectives
          outputs:
            - personalized_schedule
            
        - id: take_assessment
          name: Take Pre-Assessment
          actor: learner
          action: take_assessment
          conditional: course.has_pre_assessment
          purpose:
            - baseline_measurement
            - personalization
            - prerequisite_validation
            
        - id: orientation
          name: Platform Orientation
          actor: system
          action: show_orientation
          conditional: learner.is_new_to_platform
          covers:
            - navigation_tutorial
            - feature_highlights
            - help_resources
            
      completion_criteria:
        required:
          - welcome_viewed
        optional:
          - goals_set
          - assessment_completed

    # Stage 2: Content Consumption
    - id: content_consumption
      name: Content Consumption
      name_ja: コンテンツ消費
      state: in_progress
      
      steps:
        - id: access_lesson
          name: Access Lesson
          actor: learner
          action: open_lesson
          checks:
            - lesson_unlocked
            - content_available
          displays:
            - lesson_content
            - progress_indicator
            - navigation_controls
            
        - id: consume_video
          name: Watch Video Content
          actor: learner
          action: watch_video
          conditional: lesson.type == 'video'
          features:
            - playback_controls
            - speed_adjustment
            - captions
            - quality_selection
            - bookmarking
            - note_taking
          tracking:
            - watch_time
            - position
            - completion_percentage
            
        - id: read_article
          name: Read Article Content
          actor: learner
          action: read_article
          conditional: lesson.type == 'article'
          features:
            - text_highlighting
            - annotations
            - text_to_speech
            - print_option
          tracking:
            - scroll_depth
            - time_on_page
            - highlights_made
            
        - id: interact_content
          name: Interact with Content
          actor: learner
          action: interact
          conditional: lesson.has_interactive_elements
          types:
            - simulations
            - drag_and_drop
            - code_exercises
            - flashcards
          tracking:
            - interactions
            - correct_responses
            - time_spent
            
        - id: take_notes
          name: Take Notes
          actor: learner
          action: create_note
          optional: true
          features:
            - rich_text_editor
            - timestamp_linking
            - organization_folders
            
        - id: download_resources
          name: Download Resources
          actor: learner
          action: download
          optional: true
          available: lesson.resources
          
      completion_criteria:
        per_lesson:
          video: watched >= 90%
          article: scrolled_to_end OR time >= estimated_time
          interactive: all_interactions_completed

    # Stage 3: Practice & Assessment
    - id: practice_assessment
      name: Practice & Assessment
      name_ja: 練習と評価
      state: in_progress
      
      steps:
        - id: practice_quiz
          name: Take Practice Quiz
          actor: learner
          action: take_practice_quiz
          conditional: lesson.has_practice_quiz
          features:
            - immediate_feedback
            - explanations
            - unlimited_attempts
            - hint_system
            
        - id: graded_quiz
          name: Take Graded Quiz
          actor: learner
          action: take_quiz
          conditional: module.has_quiz
          features:
            - time_limit
            - question_navigation
            - review_before_submit
          constraints:
            - max_attempts: quiz.max_attempts
            - time_between_attempts: quiz.retry_delay
            
        - id: submit_assignment
          name: Submit Assignment
          actor: learner
          action: submit_assignment
          conditional: lesson.type == 'assignment'
          inputs:
            - submission_file
            - submission_text
          features:
            - draft_save
            - plagiarism_check
            - file_upload
          tracking:
            - submission_time
            - revision_count
            
        - id: code_exercise
          name: Complete Code Exercise
          actor: learner
          action: code_exercise
          conditional: lesson.has_code_exercise
          features:
            - code_editor
            - test_runner
            - hints
            - solution_reveal
          tracking:
            - attempts
            - tests_passed
            - time_to_solve
            
        - id: peer_review
          name: Complete Peer Review
          actor: learner
          action: peer_review
          conditional: assignment.has_peer_review
          inputs:
            - review_feedback
            - rubric_scores
          min_reviews: 3
          
      completion_criteria:
        quiz:
          - score >= passing_score
        assignment:
          - submitted AND (graded OR auto_approved)

    # Stage 4: Social Learning
    - id: social_learning
      name: Social Learning
      name_ja: ソーシャルラーニング
      state: in_progress
      
      steps:
        - id: join_discussion
          name: Join Discussion
          actor: learner
          action: participate_discussion
          activities:
            - post_question
            - answer_question
            - comment
            - react
          features:
            - rich_text
            - code_blocks
            - file_attachments
            - mentions
            
        - id: attend_live_session
          name: Attend Live Session
          actor: learner
          action: join_live
          conditional: course.has_live_sessions
          features:
            - video_conference
            - chat
            - polls
            - q_and_a
            - screen_share
          tracking:
            - attendance
            - participation
            
        - id: study_group
          name: Join Study Group
          actor: learner
          action: join_study_group
          optional: true
          features:
            - group_chat
            - shared_notes
            - study_sessions
            
        - id: office_hours
          name: Attend Office Hours
          actor: learner
          action: book_office_hours
          conditional: course.has_office_hours
          features:
            - scheduling
            - 1on1_or_group
            - question_submission
            
      completion_criteria:
        required: false
        encouraged:
          - discussion_participation
          - live_session_attendance

    # Stage 5: Progress Tracking
    - id: progress_tracking
      name: Progress Tracking
      name_ja: 進捗追跡
      state: in_progress
      
      steps:
        - id: track_progress
          name: Track Progress
          actor: system
          action: update_progress
          continuous: true
          calculates:
            - lesson_progress
            - module_progress
            - course_progress
            - time_spent
            
        - id: milestone_check
          name: Check Milestones
          actor: system
          action: check_milestones
          milestones:
            - 25%: send_encouragement
            - 50%: award_badge
            - 75%: preview_certificate
            - 100%: trigger_completion
            
        - id: streak_tracking
          name: Track Learning Streak
          actor: system
          action: update_streak
          daily: true
          rewards:
            - streak_badges
            - bonus_xp
            - streak_freeze
            
        - id: analytics_dashboard
          name: View Progress Analytics
          actor: learner
          action: view_analytics
          displays:
            - completion_percentage
            - time_invested
            - quiz_performance
            - peer_comparison
            - learning_velocity
            
      completion_criteria:
        always_active: true

    # Stage 6: Support & Intervention
    - id: support_intervention
      name: Support & Intervention
      name_ja: サポートと介入
      state: stuck
      
      steps:
        - id: detect_struggle
          name: Detect Struggling Learner
          actor: system
          action: analyze_behavior
          signals:
            - repeated_failures
            - long_inactivity
            - help_requests
            - negative_feedback
            
        - id: provide_hints
          name: Provide Hints
          actor: system
          action: offer_hints
          levels:
            - nudge: subtle_reminder
            - hint: specific_guidance
            - solution: detailed_explanation
            
        - id: recommend_review
          name: Recommend Review
          actor: system
          action: suggest_review
          based_on:
            - failed_assessments
            - weak_areas_detected
            
        - id: connect_support
          name: Connect with Support
          actor: learner
          action: request_support
          options:
            - ai_assistant
            - community_help
            - ta_support
            - instructor_contact
            
        - id: adaptive_path
          name: Adapt Learning Path
          actor: system
          action: adjust_path
          adjustments:
            - add_remedial_content
            - simplify_next_steps
            - extend_deadlines
            
      completion_criteria:
        exit_stuck:
          - progress_resumed
          - support_resolved

    # Stage 7: Module Completion
    - id: module_completion
      name: Module Completion
      name_ja: モジュール完了
      state: in_progress
      
      steps:
        - id: complete_lessons
          name: Complete All Lessons
          actor: learner
          action: complete_lessons
          requirement: all_required_lessons
          
        - id: pass_module_assessment
          name: Pass Module Assessment
          actor: learner
          action: pass_assessment
          conditional: module.has_assessment
          requirement: score >= passing_score
          
        - id: module_unlocks
          name: Unlock Next Module
          actor: system
          action: unlock_next
          conditional: sequential_unlock
          
        - id: module_celebration
          name: Celebrate Completion
          actor: system
          action: show_celebration
          displays:
            - completion_animation
            - achievement_badge
            - next_module_preview
            
      completion_criteria:
        per_module:
          - all_lessons_complete
          - assessment_passed (if required)

  transitions:
    - from: not_started
      to: in_progress
      trigger: first_lesson_accessed
      
    - from: in_progress
      to: paused
      trigger: long_inactivity
      threshold: 7 days
      
    - from: paused
      to: in_progress
      trigger: learning_resumed
      
    - from: in_progress
      to: stuck
      trigger: struggle_detected
      
    - from: stuck
      to: in_progress
      trigger: help_provided
      
    - from: in_progress
      to: near_completion
      trigger: progress >= 90%
      
    - from: near_completion
      to: completed
      trigger: all_requirements_met

  notifications:
    welcome:
      trigger: enrollment_activated
      template: course_welcome
      
    daily_reminder:
      trigger: scheduled
      condition: has_goal AND no_activity_today
      template: daily_learning_reminder
      
    streak_at_risk:
      trigger: approaching_streak_break
      template: streak_warning
      
    milestone_reached:
      trigger: milestone_crossed
      template: milestone_celebration
      
    weekly_progress:
      trigger: weekly_schedule
      template: weekly_progress_summary
      
    course_expiring:
      trigger: enrollment_expiring_soon
      intervals: [30_days, 7_days, 1_day]
      template: expiration_warning
      
    inactivity:
      trigger: no_activity_7_days
      template: we_miss_you
      
    near_completion:
      trigger: progress >= 90%
      template: almost_there

  gamification:
    xp_rewards:
      lesson_complete: 10
      quiz_passed: 25
      assignment_submitted: 30
      perfect_quiz: 50
      daily_streak: 5
      help_peer: 15
      
    badges:
      - first_lesson
      - week_streak
      - module_master
      - quiz_ace
      - helpful_peer
      - fast_learner
      
    leaderboard:
      enabled: true
      metrics: [xp, lessons_completed, streak_days]

  adaptive_learning:
    enabled: true
    signals:
      - quiz_performance
      - time_per_content
      - retry_patterns
      - help_requests
    adaptations:
      - content_difficulty
      - additional_practice
      - learning_path_adjustments
      - personalized_recommendations

  offline_support:
    enabled: true
    sync_on_reconnect: true
    offline_features:
      - video_playback
      - article_reading
      - note_taking
      - progress_tracking

  metrics:
    track:
      - time_to_first_lesson
      - average_session_duration
      - lessons_per_session
      - completion_rate_by_module
      - drop_off_points
      - engagement_score
