name: Slaughterhouse
display_name: Slaughterhouse / Lò mổ
description: |
  Cơ sở giết mổ gia súc/gia cầm.
  Có thể đăng ký làm đối tác trên sàn.

domain: agriculture
category: core

attributes:
  - name: id
    type: uuid
    required: true

  - name: owner_id
    type: uuid
    required: true
    description: Chủ lò mổ (User)

  - name: name
    type: string
    required: true
    validation:
      max_length: 200

  - name: slaughterhouse_code
    type: string
    required: true
    validation:
      pattern: "^SH-[A-Z]{2}-[0-9]{4}$"
    example: "SH-DN-0001"

  - name: license_number
    type: string
    required: true
    description: Số giấy phép hoạt động

  - name: license_expiry
    type: date
    required: true

  - name: address
    type: object
    required: true

  - name: capacity_per_day
    type: object
    required: false
    description: Công suất giết mổ/ngày
    example:
      pig: 200
      chicken: 5000
      duck: 2000

  - name: services
    type: array
    required: true
    description: Dịch vụ cung cấp
    validation:
      values: [slaughter, cutting, packaging, delivery]

  - name: certifications
    type: array
    required: false
    description: Chứng nhận (HACCP, ISO, VietGAP)

  - name: status
    type: enum
    required: true
    validation:
      values: [pending, active, suspended, inactive]
    default: pending

  - name: rating
    type: decimal
    required: false
    validation:
      min: 1
      max: 5

  - name: total_orders
    type: integer
    required: true
    default: 0

  - name: water_injection_reports
    type: integer
    required: true
    default: 0
    description: Số lần bị report bơm nước

  - name: created_at
    type: timestamp
    required: true

  - name: updated_at
    type: timestamp
    required: true

relationships:
  - name: owner
    type: belongs_to
    entity: User
    required: true

  - name: orders
    type: has_many
    entity: Order

  - name: quality_checks
    type: has_many
    entity: QualityCheck

indexes:
  - [slaughterhouse_code]
  - [owner_id]
  - [status]
  - [address.province]

business_rules:
  - BR-SH-001: Phải có giấy phép còn hạn
  - BR-SH-002: Bị suspend nếu water_injection_reports >= 3
  - BR-SH-003: Tỷ lệ móc hàm/hơi > 85% = Alert bơm nước
  - BR-SH-004: Phải upload ảnh quy trình giết mổ
