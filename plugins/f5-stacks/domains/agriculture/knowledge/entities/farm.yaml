name: Farm
display_name: Farm / Trang trại
description: |
  Trang trại chăn nuôi đăng ký trên hệ thống.
  Chủ trang trại (Farmer) có thể đăng bán gia súc/gia cầm.

domain: agriculture
category: core

attributes:
  - name: id
    type: uuid
    required: true
    description: Unique identifier

  - name: owner_id
    type: uuid
    required: true
    description: Reference to User (Farmer)

  - name: name
    type: string
    required: true
    description: Tên trang trại
    validation:
      max_length: 200

  - name: farm_code
    type: string
    required: true
    description: Mã trang trại (auto-generated)
    validation:
      pattern: "^FARM-[A-Z]{2}-[0-9]{6}$"
    example: "FARM-DN-000123"

  - name: farm_type
    type: enum
    required: true
    description: Loại trang trại
    validation:
      values: [pig, poultry, cattle, mixed]

  - name: scale
    type: enum
    required: true
    description: Quy mô
    validation:
      values: [household, small, medium, large, industrial]

  - name: address
    type: object
    required: true
    description: Địa chỉ trang trại
    example:
      province: "Đồng Nai"
      district: "Trảng Bom"
      ward: "Bắc Sơn"
      address_line: "Ấp 5, xã Bắc Sơn"
      coordinates:
        lat: 10.9876
        lng: 106.9876

  - name: certifications
    type: array
    required: false
    description: Các chứng nhận (VietGAP, GlobalGAP, Organic)
    example: ["VietGAP", "Hữu cơ"]

  - name: certification_docs
    type: array
    required: false
    description: File chứng nhận đã upload

  - name: capacity
    type: object
    required: false
    description: Công suất nuôi
    example:
      pig: 500
      chicken: 10000
      duck: 5000

  - name: status
    type: enum
    required: true
    description: Trạng thái trang trại
    validation:
      values: [pending_verification, active, suspended, inactive]
    default: pending_verification

  - name: verification_status
    type: enum
    required: true
    description: Trạng thái xác minh
    validation:
      values: [unverified, pending, verified, rejected]
    default: unverified

  - name: verified_at
    type: timestamp
    required: false
    description: Ngày xác minh

  - name: verified_by
    type: uuid
    required: false
    description: Admin xác minh

  - name: rating
    type: decimal
    required: false
    description: Điểm đánh giá trung bình (1-5)
    validation:
      min: 1
      max: 5

  - name: total_orders
    type: integer
    required: true
    default: 0
    description: Tổng số đơn đã hoàn thành

  - name: accuracy_rate
    type: decimal
    required: false
    description: Tỷ lệ mô tả chính xác (%)
    validation:
      min: 0
      max: 100

  - name: created_at
    type: timestamp
    required: true

  - name: updated_at
    type: timestamp
    required: true

relationships:
  - name: owner
    type: belongs_to
    entity: User
    required: true
    description: Chủ trang trại

  - name: listings
    type: has_many
    entity: Listing
    description: Các listing đang bán

  - name: livestock
    type: has_many
    entity: Livestock
    description: Đàn gia súc/gia cầm

indexes:
  - [farm_code]
  - [owner_id]
  - [status]
  - [farm_type]
  - [address.province]

business_rules:
  - BR-FARM-001: Mỗi User chỉ được đăng ký tối đa 5 trang trại
  - BR-FARM-002: Trang trại phải được verify trước khi đăng bán
  - BR-FARM-003: Chứng nhận VietGAP phải còn hạn (kiểm tra hàng năm)
  - BR-FARM-004: Trang trại bị suspend nếu accuracy_rate < 70%
