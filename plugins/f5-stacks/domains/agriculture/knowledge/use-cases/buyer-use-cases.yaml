name: Buyer Use Cases
display_name: Buyer Use Cases / Ca sử dụng người mua
description: |
  Use cases for buyers (traders, slaughterhouses, retailers) including
  browsing, bidding, purchasing, and receiving livestock on the marketplace.

domain: agriculture
actor: Buyer
version: "1.0"

use_cases:
  # Account Management
  - id: UC-BUY-001
    name: Register Buyer Account
    name_vi: Đăng ký tài khoản người mua
    description: Buyer creates account with business verification
    actor: Guest Buyer
    preconditions:
      - User is not registered
      - Valid business license
    main_flow:
      1: Buyer navigates to registration
      2: Buyer selects buyer type (trader/slaughterhouse/retailer)
      3: Buyer enters phone number and verifies OTP
      4: Buyer enters business information
      5: Buyer uploads business license and documents
      6: System validates documents
      7: Admin reviews and approves
      8: Buyer receives approval notification
      9: Buyer can set deposit and payment methods
    alternative_flows:
      - id: 2a
        condition: Individual buyer (small volume)
        steps:
          1: Buyer selects individual
          2: Simplified verification with ID
          3: Lower purchase limits apply
      - id: 7a
        condition: Slaughterhouse registration
        steps:
          1: Additional facility certifications required
          2: Health and safety inspection documents
          3: Higher trust score assigned
    postconditions:
      - Buyer account created
      - Business verified
      - Deposit account ready
    business_rules: [BR-BUY-001, BR-BUY-002]
    related_entities: [Buyer, Slaughterhouse]

  - id: UC-BUY-002
    name: Manage Payment Methods
    name_vi: Quản lý phương thức thanh toán
    description: Buyer sets up payment methods
    actor: Buyer
    preconditions:
      - Buyer is logged in and verified
    main_flow:
      1: Buyer navigates to payment settings
      2: Buyer adds bank account
      3: System verifies bank account
      4: Buyer sets up e-wallet (VNPay, MoMo)
      5: Buyer deposits funds for bidding
    postconditions:
      - Payment methods configured
      - Deposit available for bidding
    related_entities: [Buyer, Payment]

  # Browsing & Search
  - id: UC-BUY-010
    name: Browse Livestock Listings
    name_vi: Duyệt danh sách gia súc
    description: Buyer browses available livestock
    actor: Buyer/Guest
    preconditions:
      - None
    main_flow:
      1: Buyer navigates to marketplace
      2: System displays livestock listings
      3: Buyer filters by category (cattle/pigs/poultry)
      4: Buyer filters by location/region
      5: Buyer filters by quality grade
      6: Buyer filters by price range
      7: Buyer sorts results
      8: Buyer views listing details
    alternative_flows:
      - id: 3a
        condition: Search by farm
        steps:
          1: Buyer searches for specific farm
          2: Views all listings from that farm
          3: Sees farm ratings and reviews
    postconditions:
      - Relevant listings displayed
    related_entities: [Listing, Livestock, Farm]

  - id: UC-BUY-011
    name: View Listing Details
    name_vi: Xem chi tiết tin đăng
    description: Buyer views detailed livestock information
    actor: Buyer/Guest
    preconditions:
      - Listing is active
    main_flow:
      1: Buyer clicks on listing
      2: System displays full details
      3: Buyer views photos/videos
      4: Buyer sees animal specifications (breed, weight, age)
      5: Buyer reviews health records
      6: Buyer checks quality grade and certificates
      7: Buyer views farm information
      8: Buyer sees price/current bid
      9: Buyer views delivery options
    alternative_flows:
      - id: 7a
        condition: Request more information
        steps:
          1: Buyer clicks request info
          2: System sends inquiry to farmer
          3: Farmer responds via message
    postconditions:
      - Listing details displayed
      - View recorded for analytics
    related_entities: [Listing, Livestock, Farm, QualityCheck]

  - id: UC-BUY-012
    name: Save Favorite Listings
    name_vi: Lưu tin đăng yêu thích
    description: Buyer saves listings for later
    actor: Buyer
    preconditions:
      - Buyer is logged in
    main_flow:
      1: Buyer views listing
      2: Buyer clicks favorite/save
      3: System adds to saved list
      4: Buyer can access saved listings later
    alternative_flows:
      - id: 2a
        condition: Set price alert
        steps:
          1: Buyer sets target price
          2: System notifies when price drops
    postconditions:
      - Listing saved to favorites
    related_entities: [Listing, Buyer]

  # Bidding & Purchasing
  - id: UC-BUY-020
    name: Place Bid in Auction
    name_vi: Đặt giá trong đấu giá
    description: Buyer places bid on auction listing
    actor: Buyer
    preconditions:
      - Buyer is verified
      - Sufficient deposit/credit
      - Auction is active
    main_flow:
      1: Buyer opens auction listing
      2: Buyer views current bid and history
      3: Buyer enters bid amount
      4: System validates bid (above minimum increment)
      5: System checks deposit/credit
      6: System holds bid amount
      7: Bid placed and displayed
      8: Other bidders notified
    alternative_flows:
      - id: 3a
        condition: Auto-bid (proxy bidding)
        steps:
          1: Buyer sets maximum bid
          2: System bids incrementally up to max
          3: Buyer notified if outbid above max
      - id: 5a
        condition: Insufficient deposit
        steps:
          1: Prompt to add funds
          2: Bid not placed until funded
    postconditions:
      - Bid recorded
      - Deposit held
      - Outbid notifications sent
    business_rules: [BR-AUC-010, BR-AUC-011, BR-AUC-012]
    related_entities: [Auction, Bid, Buyer]
    related_workflows: [auction-workflow]

  - id: UC-BUY-021
    name: Win Auction
    name_vi: Thắng đấu giá
    description: Buyer wins auction and completes purchase
    actor: Buyer
    preconditions:
      - Buyer has highest bid at auction end
      - Bid meets reserve (if set)
    main_flow:
      1: Auction ends
      2: System determines winner
      3: Winner notified via app and SMS
      4: Buyer confirms purchase within time limit
      5: Payment processed from deposit
      6: Order created
      7: Seller notified to prepare livestock
    alternative_flows:
      - id: 4a
        condition: Buyer fails to confirm
        steps:
          1: Deposit forfeited (penalty)
          2: Second highest bidder offered
          3: Buyer reputation affected
      - id: 5a
        condition: Additional payment needed
        steps:
          1: Prompt for remaining payment
          2: Must complete within 24 hours
    postconditions:
      - Order created from auction win
      - Payment secured
      - Fulfillment process started
    business_rules: [BR-AUC-020, BR-AUC-021]
    related_entities: [Auction, Order, Payment]

  - id: UC-BUY-022
    name: Make Direct Purchase
    name_vi: Mua trực tiếp
    description: Buyer purchases fixed-price listing
    actor: Buyer
    preconditions:
      - Listing is fixed-price type
      - Buyer is verified
    main_flow:
      1: Buyer views fixed-price listing
      2: Buyer clicks buy now
      3: Buyer selects quantity (if batch)
      4: Buyer reviews total price
      5: Buyer selects payment method
      6: Buyer confirms purchase
      7: System processes payment
      8: Order created
    postconditions:
      - Order created
      - Payment captured
      - Seller notified
    related_entities: [Listing, Order, Payment]

  - id: UC-BUY-023
    name: Submit Offer/Negotiation
    name_vi: Gửi đề nghị thương lượng
    description: Buyer submits offer for negotiable listing
    actor: Buyer
    preconditions:
      - Listing allows negotiation
      - Buyer is verified
    main_flow:
      1: Buyer views negotiable listing
      2: Buyer clicks make offer
      3: Buyer enters offer price
      4: Buyer adds message/conditions
      5: Buyer submits offer
      6: System notifies farmer
      7: Farmer responds (accept/reject/counter)
      8: Negotiation continues until agreement
    alternative_flows:
      - id: 7a
        condition: Counter offer received
        steps:
          1: Buyer reviews counter
          2: Buyer accepts or counters again
          3: Max 5 rounds before expiry
    postconditions:
      - Offer recorded
      - Negotiation initiated
    business_rules: [BR-NEG-001, BR-NEG-002, BR-NEG-003]
    related_entities: [Offer, Listing, Buyer, Farmer]
    related_workflows: [negotiation-workflow]

  # Order Management
  - id: UC-BUY-030
    name: View Orders
    name_vi: Xem đơn hàng
    description: Buyer views purchase orders
    actor: Buyer
    preconditions:
      - Buyer is logged in
    main_flow:
      1: Buyer navigates to orders
      2: System displays order list
      3: Buyer filters by status
      4: Buyer selects order
      5: System displays order details
    postconditions:
      - Order information displayed
    related_entities: [Order]

  - id: UC-BUY-031
    name: Schedule Delivery/Pickup
    name_vi: Lên lịch giao/lấy hàng
    description: Buyer arranges livestock delivery
    actor: Buyer
    preconditions:
      - Order is confirmed
      - Payment complete
    main_flow:
      1: Buyer opens order
      2: Buyer selects delivery option
      3: Buyer chooses delivery date/time
      4: Buyer selects destination (hub/slaughterhouse/direct)
      5: System calculates delivery cost
      6: Buyer confirms arrangement
      7: System schedules with logistics
    alternative_flows:
      - id: 2a
        condition: Self pickup
        steps:
          1: Buyer selects self pickup
          2: Coordinates directly with farmer
          3: Buyer responsible for transport
    postconditions:
      - Delivery scheduled
      - Logistics notified
    business_rules: [BR-DEL-001, BR-DEL-002]
    related_entities: [Order, Shipment, Hub]

  - id: UC-BUY-032
    name: Track Shipment
    name_vi: Theo dõi vận chuyển
    description: Buyer tracks livestock in transit
    actor: Buyer
    preconditions:
      - Order is in transit
    main_flow:
      1: Buyer opens order
      2: Buyer clicks track shipment
      3: System displays real-time location
      4: Buyer views temperature (if cold chain)
      5: Buyer sees estimated arrival
      6: Buyer receives status updates
    postconditions:
      - Shipment tracking displayed
    related_entities: [Order, Shipment]

  - id: UC-BUY-033
    name: Receive and Inspect Livestock
    name_vi: Nhận và kiểm tra gia súc
    description: Buyer receives and inspects delivered livestock
    actor: Buyer
    preconditions:
      - Delivery arrived
    main_flow:
      1: Delivery arrives at destination
      2: Buyer inspects livestock
      3: Buyer verifies count and health
      4: Buyer weighs animals (if weight-based pricing)
      5: Buyer confirms receipt
      6: System releases payment to seller
    alternative_flows:
      - id: 3a
        condition: Issue found
        steps:
          1: Buyer reports issue with photos
          2: System holds payment
          3: Dispute resolution initiated
          4: Mediation if needed
    postconditions:
      - Delivery confirmed
      - Payment released (if no issues)
    business_rules: [BR-ORD-010, BR-ORD-011]
    related_entities: [Order, QualityCheck, Payment]

  # Disputes & Returns
  - id: UC-BUY-040
    name: Raise Dispute
    name_vi: Khiếu nại
    description: Buyer raises dispute about order
    actor: Buyer
    preconditions:
      - Order exists
      - Within dispute window
    main_flow:
      1: Buyer navigates to order
      2: Buyer clicks raise dispute
      3: Buyer selects dispute type
      4: Buyer describes issue
      5: Buyer uploads evidence (photos/videos)
      6: System creates dispute ticket
      7: Seller notified and responds
      8: Platform mediates if needed
    alternative_flows:
      - id: 7a
        condition: Seller agrees to resolution
        steps:
          1: Partial refund or replacement offered
          2: Buyer accepts or escalates
    postconditions:
      - Dispute created
      - Payment held pending resolution
    business_rules: [BR-DIS-001, BR-DIS-002]
    related_entities: [Order, Dispute]

  # Ratings & Reviews
  - id: UC-BUY-050
    name: Rate Farm/Seller
    name_vi: Đánh giá trang trại
    description: Buyer rates seller after transaction
    actor: Buyer
    preconditions:
      - Order completed
      - Within rating window
    main_flow:
      1: System prompts for rating after delivery
      2: Buyer rates overall experience (1-5 stars)
      3: Buyer rates specific aspects (quality, accuracy, communication)
      4: Buyer writes review (optional)
      5: Buyer submits rating
      6: System updates seller reputation
    postconditions:
      - Rating recorded
      - Seller reputation updated
    related_entities: [Farm, Order, Review]

non_functional_requirements:
  - Real-time bid updates < 500ms
  - Auction notifications within 2 seconds
  - Mobile-first design for field operations
  - Offline order viewing capability
  - Vietnamese and English language support
