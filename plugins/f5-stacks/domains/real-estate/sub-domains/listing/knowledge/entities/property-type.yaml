# Property Type Entity
# F5 Framework v2.0 - Real Estate/Listing
# Property classification taxonomy

entity:
  id: property_type
  name: Property Type
  name_ja: 物件タイプ
  name_vi: Loại bất động sản
  domain: real-estate
  subdomain: listing
  version: "1.0.0"
  
  description: |
    Taxonomy of property types defining the characteristics, typical
    attributes, and search configurations for each property category.

  attributes:
    # Identity
    - name: id
      type: uuid
      primary_key: true
      
    - name: type_code
      type: string
      max_length: 50
      unique: true
      indexed: true
      example: "RES-APT"
      
    - name: slug
      type: string
      max_length: 100
      unique: true
      indexed: true

    # Basic Info
    - name: name
      type: string
      max_length: 100
      required: true
      
    - name: name_vi
      type: string
      max_length: 100
      
    - name: name_ja
      type: string
      max_length: 100
      
    - name: description
      type: text
      
    - name: icon
      type: string
      max_length: 100
      description: Icon identifier

    # Classification
    - name: category
      type: enum
      values: [residential, commercial, industrial, land]
      required: true
      indexed: true
      
    - name: parent_type_id
      type: uuid
      foreign_key: property_type.id
      description: For type hierarchy
      
    - name: level
      type: integer
      default: 0
      description: Depth in hierarchy

    # Status
    - name: status
      type: enum
      values: [active, inactive, deprecated]
      default: active
      indexed: true
      
    - name: display_order
      type: integer
      default: 0

    # Specification Configuration
    - name: typical_attributes
      type: array
      items: string
      description: Which property fields are typically relevant
      example: ["bedrooms", "bathrooms", "floor_number", "direction"]
      
    - name: required_attributes
      type: array
      items: string
      description: Which fields are required for this type
      example: ["total_area_sqm", "bedrooms"]
      
    - name: optional_attributes
      type: array
      items: string
      
    - name: hidden_attributes
      type: array
      items: string
      description: Fields not applicable to this type

    # Amenities
    - name: typical_amenities
      type: array
      items: string
      description: Common amenities for this type
      
    - name: premium_amenities
      type: array
      items: string
      description: Premium amenities for this type

    # Search Configuration
    - name: search_filters
      type: jsonb
      description: Available filters for search
      schema:
        - field: string
          type: string  # range, select, multiselect, boolean
          options: array
          default: any
          
    - name: sort_options
      type: jsonb
      description: Available sorting options
      schema:
        - field: string
          label: string
          direction: string
          default: boolean

    # Display Configuration
    - name: card_display_fields
      type: array
      items: string
      description: Fields to show on listing cards
      
    - name: detail_sections
      type: jsonb
      description: How to organize detail page
      schema:
        - section: string
          fields: array
          order: integer

    # Pricing
    - name: typical_price_range
      type: jsonb
      schema:
        min: number
        max: number
        currency: string
        per_sqm: boolean
        
    - name: price_display_format
      type: enum
      values: [total, per_sqm, per_month, per_year]
      default: total

    # Statistics
    - name: properties_count
      type: integer
      default: 0
      
    - name: active_listings_count
      type: integer
      default: 0

    # Metadata
    - name: created_at
      type: timestamp
      auto: true
      
    - name: updated_at
      type: timestamp
      auto: true

  relationships:
    - name: parent_type
      type: belongs_to
      entity: property_type
      foreign_key: parent_type_id
      
    - name: child_types
      type: has_many
      entity: property_type
      foreign_key: parent_type_id
      
    - name: properties
      type: has_many
      entity: property
      foreign_key: property_type_id

  indexes:
    - fields: [category, status]
      name: idx_category_status
      
    - fields: [parent_type_id]
      name: idx_parent

  seed_data:
    residential:
      - type_code: "RES-APT"
        name: "Apartment"
        name_vi: "Căn hộ chung cư"
        typical_attributes: [floor_number, bedrooms, bathrooms, direction, building_name]
        required_attributes: [total_area_sqm, bedrooms]
        
      - type_code: "RES-VILLA"
        name: "Villa"
        name_vi: "Biệt thự"
        typical_attributes: [land_area_sqm, floors, bedrooms, bathrooms, parking_spaces]
        required_attributes: [total_area_sqm, land_area_sqm, bedrooms]
        
      - type_code: "RES-TOWN"
        name: "Townhouse"
        name_vi: "Nhà phố"
        typical_attributes: [land_area_sqm, floors, frontage_meters, bedrooms]
        required_attributes: [total_area_sqm, frontage_meters]
        
      - type_code: "RES-SHOP"
        name: "Shophouse"
        name_vi: "Nhà mặt tiền"
        typical_attributes: [land_area_sqm, floors, frontage_meters]
        required_attributes: [total_area_sqm, frontage_meters]
        
    commercial:
      - type_code: "COM-OFF"
        name: "Office"
        name_vi: "Văn phòng"
        typical_attributes: [floor_number, usable_area_sqm]
        required_attributes: [usable_area_sqm]
        
      - type_code: "COM-RET"
        name: "Retail"
        name_vi: "Mặt bằng kinh doanh"
        typical_attributes: [frontage_meters, floors]
        required_attributes: [total_area_sqm]
        
    industrial:
      - type_code: "IND-WAR"
        name: "Warehouse"
        name_vi: "Kho bãi"
        typical_attributes: [land_area_sqm, loading_docks]
        required_attributes: [total_area_sqm, land_area_sqm]
        
      - type_code: "IND-FAC"
        name: "Factory"
        name_vi: "Nhà xưởng"
        typical_attributes: [land_area_sqm, power_capacity]
        required_attributes: [total_area_sqm, land_area_sqm]
        
    land:
      - type_code: "LND-RES"
        name: "Residential Land"
        name_vi: "Đất thổ cư"
        typical_attributes: [land_area_sqm, frontage_meters, zoning]
        required_attributes: [land_area_sqm]
        
      - type_code: "LND-COM"
        name: "Commercial Land"
        name_vi: "Đất thương mại"
        typical_attributes: [land_area_sqm, frontage_meters, zoning]
        required_attributes: [land_area_sqm]
