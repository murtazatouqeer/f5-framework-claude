# Contract Clause Entity
# F5 Framework v2.0 - Real Estate/Transaction
# Reusable contract clauses and templates

entity:
  name: ContractClause
  name_vi: Điều khoản hợp đồng
  name_ja: 契約条項
  domain: real-estate
  subdomain: transaction
  version: "1.0.0"

  description: |
    Reusable contract clauses and provisions that can be assembled into
    contracts. Supports variable substitution for customization.

  # Database Configuration
  database:
    table_name: contract_clauses
    primary_key: id
    indexes:
      - columns: [clause_code]
        unique: true
      - columns: [clause_type]
      - columns: [category]
      - columns: [status]

  # Attributes
  attributes:
    # Identification
    - name: id
      type: uuid
      primary_key: true

    - name: clause_code
      type: string
      unique: true
      description: Unique clause code
      example: "CL-PAYMENT-001"

    - name: name
      type: string
      required: true
      description: Clause name

    - name: name_vi
      type: string
      required: true
      description: Vietnamese name

    - name: description
      type: text
      description: Clause description

    # Classification
    - name: clause_type
      type: enum
      values:
        - standard
        - contingency
        - special
        - penalty
        - disclosure
        - warranty
        - indemnification
      required: true
      description: Type of clause

    - name: category
      type: enum
      values:
        - parties
        - property
        - payment
        - possession
        - inspection
        - financing
        - title
        - closing
        - default
        - dispute
        - termination
        - miscellaneous
      required: true
      description: Clause category

    - name: status
      type: enum
      values:
        - active
        - deprecated
        - draft
      default: active

    # Content
    - name: clause_text
      type: text
      required: true
      description: Clause text with variable placeholders

    - name: clause_text_vi
      type: text
      required: true
      description: Vietnamese clause text

    - name: clause_text_en
      type: text
      nullable: true
      description: English translation

    # Variables
    - name: variables
      type: jsonb
      description: Variables for substitution
      schema:
        type: array
        items:
          type: object
          properties:
            name: { type: string }
            placeholder: { type: string }
            type: { type: string, enum: [string, number, date, currency, boolean] }
            required: { type: boolean }
            default_value: { type: string }
            description: { type: string }

    # Usage
    - name: property_types
      type: array
      items: string
      description: Applicable property types
      example: ["apartment", "house", "land"]

    - name: transaction_types
      type: array
      items: string
      description: Applicable transaction types
      example: ["sale", "lease"]

    - name: mandatory
      type: boolean
      default: false
      description: Whether clause is mandatory

    - name: mandatory_for
      type: array
      items: string
      nullable: true
      description: When clause is mandatory

    # Ordering
    - name: default_order
      type: integer
      default: 100
      description: Default position in contract

    - name: section
      type: string
      nullable: true
      description: Contract section

    # Legal
    - name: legal_reference
      type: string
      nullable: true
      description: Legal code reference

    - name: last_legal_review
      type: date
      nullable: true

    - name: reviewed_by
      type: string
      nullable: true

    # Versioning
    - name: version
      type: string
      default: "1.0"

    - name: previous_version_id
      type: uuid
      nullable: true

    - name: effective_date
      type: date
      nullable: true

    - name: expiry_date
      type: date
      nullable: true

    # Usage Statistics
    - name: usage_count
      type: integer
      default: 0
      description: Times used in contracts

    # Audit
    - name: created_at
      type: timestamp
      default: CURRENT_TIMESTAMP

    - name: updated_at
      type: timestamp
      default: CURRENT_TIMESTAMP
      on_update: CURRENT_TIMESTAMP

    - name: created_by
      type: uuid
      foreign_key: users.id

  # Relationships
  relationships:
    - name: contracts
      type: many_to_many
      entity: Contract
      through: contract_clauses_mapping

    - name: previous_version
      type: belongs_to
      entity: ContractClause
      foreign_key: previous_version_id

  # Seed Data
  seed_data:
    - clause_code: "CL-PARTIES-001"
      name: "Parties Identification"
      name_vi: "Xác định các bên"
      clause_type: standard
      category: parties
      mandatory: true
      clause_text: |
        This Agreement is entered into between:
        SELLER: {{seller_name}}, ID: {{seller_id_number}}, Address: {{seller_address}}
        BUYER: {{buyer_name}}, ID: {{buyer_id_number}}, Address: {{buyer_address}}
      clause_text_vi: |
        Hợp đồng này được ký kết giữa:
        BÊN BÁN: {{seller_name}}, CMND/CCCD: {{seller_id_number}}, Địa chỉ: {{seller_address}}
        BÊN MUA: {{buyer_name}}, CMND/CCCD: {{buyer_id_number}}, Địa chỉ: {{buyer_address}}
      variables:
        - name: seller_name
          placeholder: "{{seller_name}}"
          type: string
          required: true
        - name: seller_id_number
          placeholder: "{{seller_id_number}}"
          type: string
          required: true
        - name: seller_address
          placeholder: "{{seller_address}}"
          type: string
          required: true
        - name: buyer_name
          placeholder: "{{buyer_name}}"
          type: string
          required: true
        - name: buyer_id_number
          placeholder: "{{buyer_id_number}}"
          type: string
          required: true
        - name: buyer_address
          placeholder: "{{buyer_address}}"
          type: string
          required: true

    - clause_code: "CL-PROPERTY-001"
      name: "Property Description"
      name_vi: "Mô tả bất động sản"
      clause_type: standard
      category: property
      mandatory: true
      clause_text: |
        The property subject to this agreement is located at {{property_address}},
        with Land Use Rights Certificate No. {{certificate_number}}, issued on
        {{certificate_date}} by {{issuing_authority}}.
      clause_text_vi: |
        Bất động sản là đối tượng của hợp đồng này tọa lạc tại {{property_address}},
        theo Giấy chứng nhận quyền sử dụng đất số {{certificate_number}}, cấp ngày
        {{certificate_date}} bởi {{issuing_authority}}.

    - clause_code: "CL-PAYMENT-001"
      name: "Payment Terms"
      name_vi: "Điều khoản thanh toán"
      clause_type: standard
      category: payment
      mandatory: true
      clause_text: |
        The total purchase price is {{purchase_price}} ({{price_in_words}}).
        Payment shall be made according to the following schedule:
        {{payment_schedule}}
      clause_text_vi: |
        Tổng giá mua bán là {{purchase_price}} ({{price_in_words}}).
        Thanh toán được thực hiện theo lịch sau:
        {{payment_schedule}}

    - clause_code: "CL-DEPOSIT-001"
      name: "Earnest Money Deposit"
      name_vi: "Tiền đặt cọc"
      clause_type: standard
      category: payment
      clause_text: |
        Buyer shall deposit {{deposit_amount}} as earnest money within {{deposit_days}}
        days of contract signing. This deposit shall be held by {{escrow_holder}}.
      clause_text_vi: |
        Bên Mua đặt cọc {{deposit_amount}} trong vòng {{deposit_days}} ngày kể từ
        ngày ký hợp đồng. Tiền đặt cọc được giữ bởi {{escrow_holder}}.

    - clause_code: "CL-CLOSING-001"
      name: "Closing Date"
      name_vi: "Ngày hoàn tất"
      clause_type: standard
      category: closing
      mandatory: true
      clause_text: |
        The closing shall take place on or before {{closing_date}} at {{closing_location}}.
      clause_text_vi: |
        Việc hoàn tất giao dịch sẽ diễn ra vào hoặc trước ngày {{closing_date}}
        tại {{closing_location}}.

    - clause_code: "CL-POSSESSION-001"
      name: "Possession Transfer"
      name_vi: "Bàn giao tài sản"
      clause_type: standard
      category: possession
      clause_text: |
        Seller shall deliver possession of the property to Buyer on {{possession_date}},
        in broom-clean condition, free of all occupants and personal property
        except as otherwise agreed.
      clause_text_vi: |
        Bên Bán bàn giao tài sản cho Bên Mua vào ngày {{possession_date}},
        trong tình trạng sạch sẽ, không có người ở và tài sản cá nhân
        trừ khi có thỏa thuận khác.

    - clause_code: "CL-CONTINGENCY-FINANCING"
      name: "Financing Contingency"
      name_vi: "Điều kiện tài chính"
      clause_type: contingency
      category: financing
      clause_text: |
        This agreement is contingent upon Buyer obtaining financing approval
        for a mortgage in the amount of {{mortgage_amount}} at an interest rate
        not exceeding {{max_interest_rate}}% within {{financing_days}} days.
      clause_text_vi: |
        Hợp đồng này phụ thuộc vào việc Bên Mua được phê duyệt khoản vay
        thế chấp với số tiền {{mortgage_amount}} với lãi suất không vượt quá
        {{max_interest_rate}}% trong vòng {{financing_days}} ngày.

    - clause_code: "CL-CONTINGENCY-INSPECTION"
      name: "Inspection Contingency"
      name_vi: "Điều kiện kiểm tra"
      clause_type: contingency
      category: inspection
      clause_text: |
        Buyer shall have {{inspection_days}} days from contract signing to conduct
        inspections. If Buyer is not satisfied, Buyer may terminate this agreement
        and receive a full refund of the deposit.
      clause_text_vi: |
        Bên Mua có {{inspection_days}} ngày kể từ ngày ký hợp đồng để kiểm tra.
        Nếu Bên Mua không hài lòng, Bên Mua có thể chấm dứt hợp đồng này và
        nhận lại toàn bộ tiền đặt cọc.

    - clause_code: "CL-DEFAULT-BUYER"
      name: "Buyer Default"
      name_vi: "Vi phạm của Bên Mua"
      clause_type: penalty
      category: default
      clause_text: |
        If Buyer fails to complete the purchase without valid reason, Seller
        may retain the deposit as liquidated damages.
      clause_text_vi: |
        Nếu Bên Mua không hoàn tất việc mua bán mà không có lý do chính đáng,
        Bên Bán được quyền giữ lại tiền đặt cọc như khoản bồi thường thiệt hại.

    - clause_code: "CL-DEFAULT-SELLER"
      name: "Seller Default"
      name_vi: "Vi phạm của Bên Bán"
      clause_type: penalty
      category: default
      clause_text: |
        If Seller fails to complete the sale without valid reason, Seller
        shall return the deposit to Buyer and pay an additional amount equal
        to the deposit as damages.
      clause_text_vi: |
        Nếu Bên Bán không hoàn tất việc bán mà không có lý do chính đáng,
        Bên Bán phải trả lại tiền đặt cọc cho Bên Mua và trả thêm một khoản
        bằng tiền đặt cọc như bồi thường thiệt hại.

    - clause_code: "CL-DISPUTE-001"
      name: "Dispute Resolution"
      name_vi: "Giải quyết tranh chấp"
      clause_type: standard
      category: dispute
      mandatory: true
      clause_text: |
        Any disputes arising from this agreement shall first be resolved through
        negotiation. If negotiation fails, disputes shall be submitted to
        {{dispute_authority}} in {{jurisdiction}}.
      clause_text_vi: |
        Mọi tranh chấp phát sinh từ hợp đồng này trước hết sẽ được giải quyết
        thông qua thương lượng. Nếu thương lượng không thành, tranh chấp sẽ
        được đưa ra {{dispute_authority}} tại {{jurisdiction}}.

    - clause_code: "CL-TITLE-WARRANTY"
      name: "Title Warranty"
      name_vi: "Bảo đảm quyền sở hữu"
      clause_type: warranty
      category: title
      clause_text: |
        Seller warrants that they have good and marketable title to the property,
        free of all liens and encumbrances except as disclosed herein.
      clause_text_vi: |
        Bên Bán bảo đảm rằng họ có quyền sở hữu hợp pháp và có thể chuyển nhượng
        đối với bất động sản, không có bất kỳ quyền thế chấp hay ràng buộc nào
        ngoại trừ những gì đã công bố trong hợp đồng này.

  # Business Rules
  business_rules:
    - rule: BR-CLC-001
      name: Mandatory clause inclusion
      description: Mandatory clauses must be included in all applicable contracts

    - rule: BR-CLC-002
      name: Variable completion
      description: All required variables must be filled before use

    - rule: BR-CLC-003
      name: Legal review expiry
      description: Clauses should be reviewed annually

  # API Endpoints
  api:
    endpoints:
      - method: GET
        path: /api/contract-clauses
        description: List available clauses
        filters: [clause_type, category, property_type, transaction_type]

      - method: GET
        path: /api/contract-clauses/{id}
        description: Get clause details

      - method: POST
        path: /api/contract-clauses
        description: Create new clause

      - method: PUT
        path: /api/contract-clauses/{id}
        description: Update clause

      - method: GET
        path: /api/contract-clauses/mandatory
        description: Get mandatory clauses for transaction type
