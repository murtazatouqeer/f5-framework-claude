name: ComplianceRules
display_name: Compliance Business Rules / Quy tắc tuân thủ
description: |
  Business rules governing regulatory compliance including KYC/AML,
  sanctions screening, reporting requirements, and data protection.

domain: fintech
sub_domain: crypto
rule_category: compliance
version: "1.0"
status: active

# =============================================================================
# KYC REQUIREMENTS
# =============================================================================
kyc_requirements:
  - id: CR-001
    name: KYC Levels
    name_vi: Cấp độ KYC
    description: Define KYC verification levels
    severity: info
    enforcement: application_logic
    levels:
      none:
        verification: None
        daily_withdrawal_limit: 0
        daily_trading_limit: 0
        features: [view_only]

      basic:
        verification:
          - email_verified
          - phone_verified
          - basic_info (name, dob, country)
        daily_withdrawal_limit: 2  # BTC equivalent
        daily_trading_limit: 10
        features: [spot_trading, deposit, withdrawal]

      advanced:
        verification:
          - identity_document
          - selfie_verification
          - address_proof
          - liveness_check
        daily_withdrawal_limit: 100
        daily_trading_limit: unlimited
        features: [margin_trading, futures, p2p]

      vip:
        verification:
          - enhanced_due_diligence
          - source_of_funds
          - business_verification (if applicable)
        daily_withdrawal_limit: unlimited
        daily_trading_limit: unlimited
        features: [all, priority_support]

  - id: CR-002
    name: KYC Document Requirements
    name_vi: Yêu cầu tài liệu KYC
    description: Required documents for verification
    severity: error
    enforcement: validation
    identity_documents:
      - passport
      - national_id
      - drivers_license
    address_documents:
      - utility_bill (< 3 months)
      - bank_statement (< 3 months)
      - government_letter (< 3 months)
    requirements:
      - document_not_expired
      - photo_clearly_visible
      - all_corners_visible
      - no_alterations

  - id: CR-003
    name: KYC Refresh
    name_vi: Làm mới KYC
    description: Periodic KYC reverification
    severity: warning
    enforcement: scheduled
    frequency:
      standard: 2 years
      high_risk: 1 year
      pep: 6 months
    triggers:
      - document_expiry
      - risk_profile_change
      - suspicious_activity

  - id: CR-004
    name: KYC Rejection Handling
    name_vi: Xử lý từ chối KYC
    description: Handle rejected KYC applications
    severity: info
    enforcement: application_logic
    max_attempts: 3
    cooldown_between_attempts: 24 hours
    permanent_rejection:
      - fraudulent_documents
      - sanctions_match
      - previously_banned
    appeal_process: Support ticket with documentation

# =============================================================================
# AML REQUIREMENTS
# =============================================================================
aml_requirements:
  - id: CR-010
    name: Transaction Monitoring
    name_vi: Giám sát giao dịch
    description: Monitor transactions for suspicious activity
    severity: critical
    enforcement: application_logic
    monitoring:
      - all_deposits
      - all_withdrawals
      - large_trades
      - unusual_patterns
    integration: chainalysis OR elliptic OR comply_advantage
    real_time: true

  - id: CR-011
    name: Suspicious Activity Indicators
    name_vi: Chỉ số hoạt động đáng ngờ
    description: Red flags for suspicious activity
    severity: warning
    enforcement: application_logic
    indicators:
      structuring:
        - Multiple transactions just below threshold
        - Rapid succession of deposits and withdrawals
      unusual_patterns:
        - Sudden activity after dormancy
        - Trading with no economic purpose
        - Immediate withdrawal after deposit
      high_risk_connections:
        - Transactions with high-risk jurisdictions
        - Interaction with flagged addresses
        - Darknet market associations
      identity_concerns:
        - Multiple accounts same identity
        - Inconsistent information
        - Reluctance to provide documentation

  - id: CR-012
    name: Risk Scoring
    name_vi: Chấm điểm rủi ro
    description: Customer risk assessment
    severity: info
    enforcement: application_logic
    factors:
      customer_type:
        individual: base
        corporate: +20
        pep: +50
        trust: +30
      geography:
        low_risk: 0
        medium_risk: +20
        high_risk: +50
        sanctioned: blocked
      transaction_behavior:
        normal: 0
        slightly_unusual: +10
        unusual: +30
        highly_suspicious: +50
    scoring:
      low: 0-30
      medium: 31-60
      high: 61-100
    review_frequency:
      low: Quarterly
      medium: Monthly
      high: Weekly

  - id: CR-013
    name: Enhanced Due Diligence
    name_vi: Thẩm định tăng cường
    description: Additional checks for high-risk customers
    severity: error
    enforcement: application_logic
    triggers:
      - risk_score > 60
      - pep_match
      - high_risk_jurisdiction
      - large_transaction_volume
    requirements:
      - source_of_funds_verification
      - source_of_wealth_verification
      - enhanced_ongoing_monitoring
      - senior_management_approval

# =============================================================================
# SANCTIONS SCREENING
# =============================================================================
sanctions:
  - id: CR-020
    name: Sanctions List Screening
    name_vi: Sàng lọc danh sách trừng phạt
    description: Screen against sanctions lists
    severity: critical
    enforcement: application_logic
    lists:
      - OFAC SDN List
      - UN Consolidated List
      - EU Sanctions List
      - UK Sanctions List
      - Local jurisdiction lists
    screening_points:
      - Account creation
      - KYC verification
      - Transaction initiation
      - Periodic rescreening
    frequency: Daily list updates

  - id: CR-021
    name: Sanctions Match Handling
    name_vi: Xử lý trùng khớp trừng phạt
    description: Process for handling sanctions matches
    severity: critical
    enforcement: application_logic
    on_match:
      potential_match:
        - Flag for manual review
        - Continue limited service pending review
        - Review within 24 hours
      confirmed_match:
        - Immediate account freeze
        - Block all transactions
        - Report to authorities
        - Retain records
      false_positive:
        - Document determination
        - Whitelist with approval
        - Continue normal service

  - id: CR-022
    name: Jurisdiction Restrictions
    name_vi: Hạn chế theo quốc gia
    description: Service restrictions by jurisdiction
    severity: critical
    enforcement: application_logic
    blocked_jurisdictions:
      - North Korea
      - Iran
      - Syria
      - Cuba
      - Crimea region
    restricted_jurisdictions:
      - action: Enhanced due diligence required
        countries: [per_regulatory_guidance]
    vpn_detection: Enabled
    message: Service not available in your region

# =============================================================================
# REPORTING REQUIREMENTS
# =============================================================================
reporting:
  - id: CR-030
    name: Suspicious Activity Report (SAR)
    name_vi: Báo cáo hoạt động đáng ngờ
    description: File SARs for suspicious activity
    severity: critical
    enforcement: application_logic
    filing_deadline: 30 days from detection
    content:
      - Subject information
      - Suspicious activity description
      - Transaction details
      - Supporting documentation
    confidentiality: Do not notify subject
    retention: 5 years

  - id: CR-031
    name: Currency Transaction Report (CTR)
    name_vi: Báo cáo giao dịch tiền tệ
    description: Report large cash transactions
    severity: error
    enforcement: application_logic
    threshold: 10000 USD equivalent
    aggregation: 24-hour rolling window
    filing_deadline: 15 days
    applies_to:
      - Fiat deposits
      - Fiat withdrawals

  - id: CR-032
    name: Regulatory Reporting
    name_vi: Báo cáo cơ quan quản lý
    description: Regular reports to regulators
    severity: error
    enforcement: scheduled
    reports:
      - Transaction volume reports
      - Customer statistics
      - Complaint reports
      - Incident reports
    frequency: As required by jurisdiction

# =============================================================================
# DATA PROTECTION
# =============================================================================
data_protection:
  - id: CR-040
    name: GDPR Compliance
    name_vi: Tuân thủ GDPR
    description: EU data protection requirements
    severity: critical
    enforcement: application_logic
    applies_to: EU residents
    requirements:
      - Lawful basis for processing
      - Data minimization
      - Storage limitation
      - Right to access
      - Right to erasure (with exceptions)
      - Right to portability
      - Breach notification (72 hours)
    data_protection_officer: Required

  - id: CR-041
    name: Data Retention
    name_vi: Lưu giữ dữ liệu
    description: Data retention requirements
    severity: error
    enforcement: application_logic
    retention_periods:
      transaction_records: 7 years
      kyc_documents: 5 years after relationship ends
      trading_history: 7 years
      communication_logs: 5 years
      audit_logs: 7 years
    deletion: Automated after retention period

  - id: CR-042
    name: Data Subject Requests
    name_vi: Yêu cầu chủ thể dữ liệu
    description: Handle user data requests
    severity: error
    enforcement: application_logic
    request_types:
      - access: Provide copy of data
      - rectification: Correct inaccurate data
      - erasure: Delete data (if permitted)
      - portability: Export in machine-readable format
      - restriction: Limit processing
    response_time: 30 days
    exceptions:
      - Regulatory retention requirements
      - Legal hold
      - Legitimate business purposes

# =============================================================================
# TRAVEL RULE
# =============================================================================
travel_rule:
  - id: CR-050
    name: FATF Travel Rule
    name_vi: Quy tắc du lịch FATF
    description: Exchange beneficiary information for large transfers
    severity: critical
    enforcement: application_logic
    threshold: 1000 USD/EUR equivalent
    required_originator_info:
      - name
      - account_number
      - address OR national_id OR date_of_birth
    required_beneficiary_info:
      - name
      - account_number
    protocol: TRUST OR Sygna OR OpenVASP
    counterparty_vasp:
      verified: Proceed with transfer
      unverified: Enhanced due diligence required
      non_compliant: May block transfer

  - id: CR-051
    name: Unhosted Wallet Transfers
    name_vi: Chuyển tiền ví không lưu ký
    description: Rules for transfers to/from non-custodial wallets
    severity: warning
    enforcement: application_logic
    threshold: 1000 USD/EUR equivalent
    requirements:
      - Self-declaration of ownership
      - Enhanced monitoring
      - Risk assessment
    documentation: Proof of ownership may be required

# =============================================================================
# RECORD KEEPING
# =============================================================================
record_keeping:
  - id: CR-060
    name: Transaction Records
    name_vi: Hồ sơ giao dịch
    description: Maintain complete transaction records
    severity: critical
    enforcement: application_logic
    records:
      - Transaction amount and currency
      - Date and time
      - Parties involved
      - Nature of transaction
      - Payment method
    retention: 7 years minimum
    format: Immutable audit trail

  - id: CR-061
    name: KYC Records
    name_vi: Hồ sơ KYC
    description: Maintain KYC documentation
    severity: critical
    enforcement: application_logic
    records:
      - Identity documents
      - Verification results
      - Risk assessments
      - Due diligence reports
    retention: 5 years after relationship ends
    storage: Encrypted, access-controlled

  - id: CR-062
    name: Communication Records
    name_vi: Hồ sơ liên lạc
    description: Maintain customer communication records
    severity: warning
    enforcement: application_logic
    channels:
      - Email
      - Chat support
      - Phone (where recorded)
    retention: 5 years
    searchable: Yes

# =============================================================================
# LICENSING & REGISTRATION
# =============================================================================
licensing:
  - id: CR-070
    name: Operating License Compliance
    name_vi: Tuân thủ giấy phép hoạt động
    description: Maintain required licenses
    severity: critical
    enforcement: legal_compliance
    requirements:
      - Valid license in each jurisdiction
      - Compliance with license conditions
      - Regular reporting to regulators
      - License renewal tracking
    notification: 90 days before expiry

  - id: CR-071
    name: Jurisdictional Compliance
    name_vi: Tuân thủ theo khu vực pháp lý
    description: Comply with local regulations
    severity: critical
    enforcement: legal_compliance
    review: Quarterly legal review
    areas:
      - Registration requirements
      - Consumer protection
      - Tax reporting
      - Advertising restrictions

# =============================================================================
# AUDIT & EXAMINATION
# =============================================================================
audit:
  - id: CR-080
    name: Internal Audit
    name_vi: Kiểm toán nội bộ
    description: Regular internal compliance audits
    severity: warning
    enforcement: scheduled
    frequency: Quarterly
    scope:
      - KYC/AML controls
      - Transaction monitoring effectiveness
      - Policy adherence
      - Training completion
    reporting: Board-level

  - id: CR-081
    name: External Audit
    name_vi: Kiểm toán bên ngoài
    description: Independent compliance audits
    severity: warning
    enforcement: scheduled
    frequency: Annually
    scope:
      - Regulatory compliance
      - Control effectiveness
      - Risk management
    auditor: Licensed external firm

  - id: CR-082
    name: Regulatory Examination
    name_vi: Kiểm tra cơ quan quản lý
    description: Cooperate with regulatory examinations
    severity: critical
    enforcement: legal_requirement
    obligations:
      - Provide requested documents
      - Make staff available for interview
      - Grant system access as required
      - Respond within deadlines

# =============================================================================
# TRAINING
# =============================================================================
training:
  - id: CR-090
    name: AML Training
    name_vi: Đào tạo AML
    description: Mandatory AML training for staff
    severity: error
    enforcement: hr_compliance
    frequency:
      new_hire: Within 30 days
      annual: Required
      role_change: Within 30 days
    topics:
      - AML regulations
      - Suspicious activity indicators
      - Reporting procedures
      - Customer due diligence
    certification: Completion certificate required

  - id: CR-091
    name: Sanctions Training
    name_vi: Đào tạo trừng phạt
    description: Sanctions compliance training
    severity: error
    enforcement: hr_compliance
    frequency: Annual
    topics:
      - Sanctions programs
      - Screening procedures
      - Match escalation
    audience: Compliance, operations, customer support

# =============================================================================
# VALIDATION SUMMARY
# =============================================================================
validation_summary:
  customer_onboarding:
    - CR-001  # KYC levels
    - CR-002  # Documents
    - CR-020  # Sanctions screening

  ongoing_monitoring:
    - CR-010  # Transaction monitoring
    - CR-012  # Risk scoring
    - CR-003  # KYC refresh

  reporting:
    - CR-030  # SAR
    - CR-031  # CTR
    - CR-050  # Travel rule

  record_keeping:
    - CR-060  # Transactions
    - CR-061  # KYC
    - CR-041  # Retention
