name: Investor Use Cases
display_name: Investor Use Cases / Các trường hợp sử dụng của nhà đầu tư
description: |
  Use cases for investor interactions with the P2P lending platform
  from registration through portfolio management and returns collection.

domain: fintech
sub_domain: p2p-lending
version: "1.0"
status: active

# =============================================================================
# ACTOR DEFINITION
# =============================================================================
primary_actor:
  name: Investor
  name_vi: Nhà đầu tư
  description: |
    Individual or institutional investor providing funds for loans
    through the P2P lending platform.
  types:
    - individual_investor
    - institutional_investor
    - accredited_investor
    - retail_investor

# =============================================================================
# USE CASES
# =============================================================================
use_cases:
  # ---------------------------------------------------------------------------
  # UC-I001: Register as Investor
  # ---------------------------------------------------------------------------
  - id: UC-I001
    name: Register as Investor
    name_vi: Đăng ký làm nhà đầu tư
    category: onboarding
    priority: high

    description: |
      New user creates an investor account on the platform.

    preconditions:
      - user_has_valid_phone_number
      - user_not_already_registered
      - user_meets_age_requirement

    trigger: User clicks "Register" or "Invest Now"

    main_flow:
      1:
        action: Enter phone number
        system: Send OTP verification code
      2:
        action: Enter OTP code
        system: Verify OTP and create account
      3:
        action: Set password
        system: Validate password strength
      4:
        action: Select investor type
        system: Display individual or institutional options
      5:
        action: Accept terms and conditions
        system: Record acceptance with timestamp
      6:
        action: Complete basic profile
        system: Save profile and redirect to onboarding

    alternative_flows:
      A1_institutional_registration:
        at_step: 4
        condition: User selects institutional
        flow:
          - Request company registration documents
          - Collect authorized signatory information
          - Require board resolution

    postconditions:
      - investor_account_created
      - welcome_notification_sent
      - onboarding_pending

    business_rules:
      - BR-REG-001: Age minimum 18 years
      - BR-REG-002: Valid Vietnamese phone required
      - BR-REG-003: Investor type determines limits

  # ---------------------------------------------------------------------------
  # UC-I002: Complete Investor Onboarding
  # ---------------------------------------------------------------------------
  - id: UC-I002
    name: Complete Investor Onboarding
    name_vi: Hoàn thành giới thiệu nhà đầu tư
    category: onboarding
    priority: high

    description: |
      Investor completes KYC, suitability assessment, and risk acknowledgment.

    preconditions:
      - investor_account_exists
      - onboarding_not_completed

    trigger: User accesses onboarding section

    main_flow:
      1:
        action: Complete KYC verification
        system: Perform eKYC process (same as borrower)
      2:
        action: Complete suitability questionnaire
        system: Assess investment experience and objectives
      3:
        action: View risk profile assessment
        system: Display calculated risk tolerance
      4:
        action: Review investment risks
        system: Present all risk disclosures
      5:
        action: Acknowledge each risk factor
        system: Record acknowledgments
      6:
        action: Link bank account
        system: Verify account ownership
      7:
        action: Complete onboarding
        system: Activate investment capability

    alternative_flows:
      A1_accredited_investor:
        at_step: 2
        condition: User claims accredited status
        flow:
          - Request income/net worth documentation
          - Verify accredited qualification
          - Grant higher limits if qualified

    postconditions:
      - kyc_verified
      - suitability_completed
      - risks_acknowledged
      - bank_account_linked
      - investor_active

    business_rules:
      - BR-ONB-001: All risk acknowledgments required
      - BR-ONB-002: Suitability valid for 24 months
      - BR-ONB-003: Bank verification mandatory

  # ---------------------------------------------------------------------------
  # UC-I003: Deposit Funds
  # ---------------------------------------------------------------------------
  - id: UC-I003
    name: Deposit Funds
    name_vi: Nạp tiền
    category: wallet_management
    priority: high

    description: |
      Investor adds funds to their platform wallet for investment.

    preconditions:
      - investor_onboarding_complete
      - investor_account_active

    trigger: User clicks "Deposit" or "Add Funds"

    main_flow:
      1:
        action: Enter deposit amount
        system: Validate amount and display fees
      2:
        action: Select deposit method
        system: Display bank transfer or card options
      3:
        action: View deposit instructions
        system: Show bank account details and reference code
      4:
        action: Complete transfer
        system: Await bank confirmation
      5:
        action: Receive deposit confirmation
        system: Credit wallet and send notification

    alternative_flows:
      A1_card_payment:
        at_step: 2
        condition: User selects card payment
        flow:
          - Redirect to payment gateway
          - Process card transaction
          - Apply card processing fee

      A2_large_deposit:
        at_step: 1
        condition: Amount exceeds threshold
        flow:
          - Trigger source of funds check
          - Request documentation
          - Manual review before crediting

    postconditions:
      - funds_credited_to_wallet
      - transaction_recorded
      - confirmation_sent

    business_rules:
      - BR-DEP-001: Minimum deposit 100,000 VND
      - BR-DEP-002: Source of funds check above 200M
      - BR-DEP-003: Bank transfer same-day processing

  # ---------------------------------------------------------------------------
  # UC-I004: Browse Loan Listings
  # ---------------------------------------------------------------------------
  - id: UC-I004
    name: Browse Loan Listings
    name_vi: Xem danh sách khoản vay
    category: investment
    priority: high

    description: |
      Investor browses available loans in the marketplace.

    preconditions:
      - investor_onboarding_complete
      - marketplace_has_listings

    trigger: User accesses marketplace section

    main_flow:
      1:
        action: View marketplace overview
        system: Display available loans summary
      2:
        action: Apply filters
        system: Filter by grade, term, rate, purpose
      3:
        action: Sort listings
        system: Sort by rate, funding progress, time remaining
      4:
        action: View listing details
        system: Display loan information and borrower profile
      5:
        action: Calculate expected returns
        system: Show projected returns based on amount

    alternative_flows:
      A1_no_matching_listings:
        at_step: 2
        condition: Filters return no results
        flow:
          - Suggest relaxing filter criteria
          - Show similar available loans

    postconditions:
      - listings_viewed
      - analytics_recorded

    business_rules:
      - BR-MKT-001: Only open listings displayed
      - BR-MKT-002: Borrower identity hidden
      - BR-MKT-003: Funding progress real-time

  # ---------------------------------------------------------------------------
  # UC-I005: Make Manual Investment
  # ---------------------------------------------------------------------------
  - id: UC-I005
    name: Make Manual Investment
    name_vi: Thực hiện đầu tư thủ công
    category: investment
    priority: high

    description: |
      Investor manually invests in a specific loan listing.

    preconditions:
      - investor_has_available_balance
      - listing_is_open
      - investor_not_at_limit_for_loan

    trigger: User clicks "Invest" on listing

    main_flow:
      1:
        action: Enter investment amount
        system: Validate against limits and balance
      2:
        action: View expected returns
        system: Calculate and display returns projection
      3:
        action: Review investment summary
        system: Show amount, term, rate, expected return
      4:
        action: Accept investment terms
        system: Display and require acceptance
      5:
        action: Confirm investment
        system: Reserve funds and create investment record
      6:
        action: Receive confirmation
        system: Display confirmation and update portfolio

    alternative_flows:
      A1_insufficient_balance:
        at_step: 1
        condition: Wallet balance insufficient
        flow:
          - Show available balance
          - Offer to deposit more funds
          - Allow investment of available amount

      A2_limit_exceeded:
        at_step: 1
        condition: Amount exceeds per-loan limit
        flow:
          - Display maximum allowed amount
          - Adjust to maximum if desired

      A3_listing_fully_funded:
        at_step: 1
        condition: Listing fills during process
        flow:
          - Notify that listing is now closed
          - Suggest similar listings

    postconditions:
      - investment_created
      - funds_reserved
      - portfolio_updated

    business_rules:
      - BR-INV-001: Minimum investment 100,000 VND
      - BR-INV-002: Maximum 10% of loan or 50M
      - BR-INV-003: Investments in 100,000 increments

  # ---------------------------------------------------------------------------
  # UC-I006: Configure Auto-Invest
  # ---------------------------------------------------------------------------
  - id: UC-I006
    name: Configure Auto-Invest
    name_vi: Cấu hình đầu tư tự động
    category: investment
    priority: high

    description: |
      Investor sets up automatic investment based on preferences.

    preconditions:
      - investor_onboarding_complete
      - investor_has_available_balance

    trigger: User accesses auto-invest settings

    main_flow:
      1:
        action: Enable auto-invest
        system: Activate auto-invest feature
      2:
        action: Set investment amount per loan
        system: Validate and save amount preference
      3:
        action: Select eligible grades
        system: Save grade preferences (A-F)
      4:
        action: Select eligible terms
        system: Save term preferences
      5:
        action: Set minimum interest rate
        system: Save rate threshold
      6:
        action: Select loan purposes
        system: Save purpose filters
      7:
        action: Set reserve amount
        system: Keep specified amount uninvested
      8:
        action: Review and activate
        system: Start auto-invest matching

    alternative_flows:
      A1_select_strategy:
        at_step: 2
        condition: User prefers preset strategy
        flow:
          - Display conservative/balanced/aggressive options
          - Auto-fill settings based on selected strategy

    postconditions:
      - auto_invest_configured
      - matching_active

    business_rules:
      - BR-AUTO-001: At least one grade selected
      - BR-AUTO-002: At least one term selected
      - BR-AUTO-003: Amount within per-loan limits

  # ---------------------------------------------------------------------------
  # UC-I007: View Portfolio
  # ---------------------------------------------------------------------------
  - id: UC-I007
    name: View Portfolio
    name_vi: Xem danh mục đầu tư
    category: portfolio_management
    priority: high

    description: |
      Investor views their current investment portfolio.

    preconditions:
      - investor_account_exists

    trigger: User accesses portfolio section

    main_flow:
      1:
        action: View portfolio summary
        system: Display total invested, returns, diversification
      2:
        action: View portfolio breakdown
        system: Show by grade, term, purpose
      3:
        action: View active investments
        system: List all current investments with status
      4:
        action: View individual investment
        system: Display detailed investment information
      5:
        action: View payment history
        system: Show received payments by investment

    postconditions:
      - portfolio_viewed

    business_rules:
      - BR-PORT-001: Real-time balance updates
      - BR-PORT-002: Diversification warnings displayed

  # ---------------------------------------------------------------------------
  # UC-I008: Receive Repayment
  # ---------------------------------------------------------------------------
  - id: UC-I008
    name: Receive Repayment Distribution
    name_vi: Nhận phân phối thanh toán
    category: returns
    priority: high

    description: |
      Investor receives their share of borrower repayments.

    preconditions:
      - investor_has_active_investments
      - borrower_payment_received

    trigger: Borrower makes loan repayment (automatic)

    main_flow:
      1:
        action: System processes borrower payment
        system: Calculate investor share
      2:
        action: Deduct platform fees
        system: Apply service fee and provision contribution
      3:
        action: Credit investor wallet
        system: Add principal and net interest
      4:
        action: Update investment record
        system: Reduce outstanding principal
      5:
        action: Send notification
        system: Notify investor of received payment

    postconditions:
      - funds_credited
      - investment_updated
      - notification_sent

    business_rules:
      - BR-DIST-001: 1% service fee on interest
      - BR-DIST-002: 0.5% provision contribution
      - BR-DIST-003: Same-day distribution

  # ---------------------------------------------------------------------------
  # UC-I009: Sell Investment on Secondary Market
  # ---------------------------------------------------------------------------
  - id: UC-I009
    name: Sell Investment on Secondary Market
    name_vi: Bán đầu tư trên thị trường thứ cấp
    category: secondary_market
    priority: medium

    description: |
      Investor sells existing investment to another investor.

    preconditions:
      - investment_age_at_least_30_days
      - loan_not_delinquent
      - no_payment_due_within_7_days

    trigger: User selects "Sell" on investment

    main_flow:
      1:
        action: Select investment to sell
        system: Validate eligibility for secondary sale
      2:
        action: Set sale price
        system: Validate discount/premium within limits
      3:
        action: Review sale terms
        system: Display fees and net proceeds
      4:
        action: List for sale
        system: Create secondary market listing
      5:
        action: Wait for buyer
        system: Match with interested buyers
      6:
        action: Complete sale
        system: Transfer ownership and funds

    alternative_flows:
      A1_no_buyer_found:
        at_step: 5
        condition: No buyer matches within 30 days
        flow:
          - Notify seller of expired listing
          - Offer to relist at different price

      A2_partial_sale:
        at_step: 2
        condition: Selling portion of investment
        flow:
          - Validate minimum sale amount
          - Split investment record

    postconditions:
      - investment_transferred
      - seller_credited
      - buyer_investment_created

    business_rules:
      - BR-SEC-001: Max 20% discount allowed
      - BR-SEC-002: Max 10% premium allowed
      - BR-SEC-003: 1% seller fee

  # ---------------------------------------------------------------------------
  # UC-I010: Withdraw Funds
  # ---------------------------------------------------------------------------
  - id: UC-I010
    name: Withdraw Funds
    name_vi: Rút tiền
    category: wallet_management
    priority: high

    description: |
      Investor withdraws funds from platform wallet to bank.

    preconditions:
      - investor_has_available_balance
      - bank_account_verified

    trigger: User clicks "Withdraw"

    main_flow:
      1:
        action: Enter withdrawal amount
        system: Validate against available balance
      2:
        action: Select destination bank account
        system: Display linked accounts
      3:
        action: View fees if applicable
        system: Show withdrawal fee after free limit
      4:
        action: Verify with OTP
        system: Send and verify OTP
      5:
        action: Confirm withdrawal
        system: Process withdrawal request
      6:
        action: Receive confirmation
        system: Display expected arrival time

    alternative_flows:
      A1_large_withdrawal:
        at_step: 1
        condition: Amount exceeds threshold
        flow:
          - Require additional verification
          - May require 2-day processing

      A2_exceeded_free_withdrawals:
        at_step: 3
        condition: Used 2 free monthly withdrawals
        flow:
          - Display withdrawal fee
          - Require confirmation of fee

    postconditions:
      - withdrawal_processed
      - funds_deducted
      - bank_transfer_initiated

    business_rules:
      - BR-WD-001: 2 free withdrawals per month
      - BR-WD-002: Fee after free limit
      - BR-WD-003: Daily limit 500M individual

  # ---------------------------------------------------------------------------
  # UC-I011: File Provision Fund Claim
  # ---------------------------------------------------------------------------
  - id: UC-I011
    name: File Provision Fund Claim
    name_vi: Yêu cầu bồi thường từ quỹ dự phòng
    category: investor_protection
    priority: medium

    description: |
      Investor claims protection from provision fund for defaulted loan.

    preconditions:
      - investment_in_defaulted_loan
      - loan_dpd_at_least_90
      - claim_not_already_filed

    trigger: Loan reaches default status (automatic) or investor request

    main_flow:
      1:
        action: System identifies eligible claims
        system: Check default status and collection efforts
      2:
        action: Calculate claim amount
        system: Determine 80% of outstanding principal
      3:
        action: Submit claim automatically
        system: Create claim record
      4:
        action: Process claim
        system: Verify eligibility and fund availability
      5:
        action: Credit investor
        system: Transfer claim amount to wallet
      6:
        action: Send notification
        system: Notify investor of claim payment

    alternative_flows:
      A1_insufficient_fund:
        at_step: 4
        condition: Provision fund balance insufficient
        flow:
          - Queue claim for later processing
          - Pay partial amount if available
          - Notify of pending balance

    postconditions:
      - claim_processed
      - investor_compensated
      - investment_marked_claimed

    business_rules:
      - BR-PROV-001: 80% coverage of principal
      - BR-PROV-002: 30-day processing time
      - BR-PROV-003: Automatic for defaults

  # ---------------------------------------------------------------------------
  # UC-I012: View Investment Reports
  # ---------------------------------------------------------------------------
  - id: UC-I012
    name: View Investment Reports
    name_vi: Xem báo cáo đầu tư
    category: reporting
    priority: low

    description: |
      Investor accesses various investment and tax reports.

    preconditions:
      - investor_account_exists

    trigger: User accesses reports section

    main_flow:
      1:
        action: Select report type
        system: Display available report options
      2:
        action: Select date range
        system: Validate date range
      3:
        action: Generate report
        system: Process and compile report data
      4:
        action: View report
        system: Display report in browser
      5:
        action: Download report
        system: Generate PDF/Excel download

    available_reports:
      - monthly_statement
      - annual_tax_report
      - portfolio_performance
      - transaction_history
      - returns_summary

    postconditions:
      - report_generated
      - download_available

# =============================================================================
# USE CASE RELATIONSHIPS
# =============================================================================
relationships:
  extends:
    - UC-I005_extends_UC-I004: "Investment from browsing"
    - UC-I009_extends_UC-I007: "Sale from portfolio view"

  includes:
    - UC-I008_includes_fee_processing: "Distribution includes fees"
    - UC-I011_includes_default_check: "Claim requires default"

  precedes:
    - UC-I001_precedes_UC-I002: "Registration before onboarding"
    - UC-I002_precedes_UC-I003: "Onboarding before deposit"
    - UC-I003_precedes_UC-I005: "Deposit before investment"
