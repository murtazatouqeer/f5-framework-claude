name: Loan Pricing Rules
display_name: Loan Pricing Rules / Quy tắc định giá khoản vay
description: |
  Business rules for loan interest rate calculation including
  base rates, risk premiums, term adjustments, and fee structures.

domain: fintech
sub_domain: p2p-lending
version: "1.0"
status: active

# =============================================================================
# BASE RATE CONFIGURATION
# =============================================================================
base_rate:
  rule_id: LPR-001
  name: Base Interest Rate
  name_vi: Lãi suất cơ bản

  reference_rate:
    source: SBV_base_rate
    current_value: 4.5
    unit: percent_per_annum
    update_frequency: as_announced
    effective_date: "2025-01-01"

  platform_margin:
    value: 3.5
    unit: percent_per_annum
    description: "Platform operational margin above reference rate"

  base_lending_rate:
    formula: "reference_rate + platform_margin"
    current_value: 8.0
    unit: percent_per_annum
    description: "Minimum rate for Grade A loans"

# =============================================================================
# RISK-BASED PRICING
# =============================================================================
risk_premium:
  rule_id: LPR-002
  name: Risk Premium by Grade
  name_vi: Phí rủi ro theo hạng

  grade_premiums:
    - grade: A
      premium: 0.0
      rate_range: [8.0, 10.0]
      expected_default_rate: 0.5
      sub_grade_adjustment:
        A1: 0.0
        A2: 0.4
        A3: 0.8
        A4: 1.2
        A5: 1.6

    - grade: B
      premium: 2.0
      rate_range: [10.0, 14.0]
      expected_default_rate: 1.5
      sub_grade_adjustment:
        B1: 0.0
        B2: 0.8
        B3: 1.6
        B4: 2.4
        B5: 3.2

    - grade: C
      premium: 5.0
      rate_range: [13.0, 18.0]
      expected_default_rate: 3.5
      sub_grade_adjustment:
        C1: 0.0
        C2: 1.0
        C3: 2.0
        C4: 3.0
        C5: 4.0

    - grade: D
      premium: 8.0
      rate_range: [16.0, 22.0]
      expected_default_rate: 6.0
      sub_grade_adjustment:
        D1: 0.0
        D2: 1.2
        D3: 2.4
        D4: 3.6
        D5: 4.8

    - grade: E
      premium: 12.0
      rate_range: [20.0, 28.0]
      expected_default_rate: 10.0
      sub_grade_adjustment:
        E1: 0.0
        E2: 1.6
        E3: 3.2
        E4: 4.8
        E5: 6.4

    - grade: F
      premium: 18.0
      rate_range: [26.0, 36.0]
      expected_default_rate: 18.0
      sub_grade_adjustment:
        F1: 0.0
        F2: 2.0
        F3: 4.0
        F4: 6.0
        F5: 8.0

  rate_calculation:
    formula: "base_rate + grade_premium + sub_grade_adjustment"
    example:
      grade: C3
      calculation: "8.0 + 5.0 + 2.0 = 15.0%"

# =============================================================================
# TERM ADJUSTMENTS
# =============================================================================
term_adjustments:
  rule_id: LPR-003
  name: Term-Based Rate Adjustments
  name_vi: Điều chỉnh theo kỳ hạn

  adjustments:
    - term_range: [1, 6]
      adjustment: -0.5
      description: "Short-term discount"

    - term_range: [7, 12]
      adjustment: 0.0
      description: "Standard term"

    - term_range: [13, 24]
      adjustment: +0.5
      description: "Medium-term premium"

    - term_range: [25, 36]
      adjustment: +1.0
      description: "Long-term premium"

    - term_range: [37, 48]
      adjustment: +1.5
      description: "Extended term premium"

    - term_range: [49, 60]
      adjustment: +2.0
      description: "Maximum term premium"

  rationale: |
    Longer terms carry higher risk due to:
    - Increased probability of default over time
    - Economic uncertainty
    - Borrower circumstance changes

# =============================================================================
# AMOUNT-BASED ADJUSTMENTS
# =============================================================================
amount_adjustments:
  rule_id: LPR-004
  name: Amount-Based Rate Adjustments
  name_vi: Điều chỉnh theo số tiền

  adjustments:
    - amount_range: [1000000, 10000000]
      adjustment: +0.5
      description: "Small loan premium (higher servicing cost)"

    - amount_range: [10000001, 50000000]
      adjustment: 0.0
      description: "Standard amount"

    - amount_range: [50000001, 200000000]
      adjustment: -0.25
      description: "Large loan discount"

    - amount_range: [200000001, 500000000]
      adjustment: -0.5
      description: "Premium loan discount"

    - amount_range: [500000001, 2000000000]
      adjustment: -0.75
      description: "Enterprise loan discount"

# =============================================================================
# LOYALTY ADJUSTMENTS
# =============================================================================
loyalty_adjustments:
  rule_id: LPR-005
  name: Borrower Loyalty Discounts
  name_vi: Giảm giá khách hàng trung thành

  repeat_borrower:
    - completed_loans: 1
      discount: 0.25
      description: "Second-time borrower"

    - completed_loans: 2
      discount: 0.5
      description: "Third-time borrower"

    - completed_loans: 3
      discount: 0.75
      description: "Fourth-time borrower"

    - completed_loans: ">= 4"
      discount: 1.0
      description: "Loyal borrower"

  conditions:
    - all_previous_loans_paid_on_time: true
    - no_late_payments: true
    - account_in_good_standing: true

  payment_history_bonus:
    - condition: "100% on-time for all previous loans"
      additional_discount: 0.5

# =============================================================================
# PROMOTIONAL PRICING
# =============================================================================
promotional_pricing:
  rule_id: LPR-006
  name: Promotional Rate Adjustments
  name_vi: Điều chỉnh lãi suất khuyến mãi

  first_time_borrower:
    discount: 0.5
    max_amount: 20000000
    max_term: 12
    conditions:
      - kyc_verified: true
      - credit_score: ">= 600"

  seasonal_promotions:
    tet_promotion:
      period: "January 15 - February 15"
      discount: 0.5
      eligible_grades: [A, B, C]

    mid_year_promotion:
      period: "June 1 - June 30"
      discount: 0.25
      eligible_grades: [A, B]

  referral_discount:
    referee_discount: 0.25
    referrer_bonus: 100000
    conditions:
      - referee_completes_first_loan: true

  partner_discounts:
    - partner: corporate_employer
      discount: 0.5
      conditions:
        - salary_account_verified: true

# =============================================================================
# RATE CAPS
# =============================================================================
rate_caps:
  rule_id: LPR-007
  name: Interest Rate Caps
  name_vi: Giới hạn lãi suất

  regulatory_caps:
    maximum_rate: 36.0
    unit: percent_per_annum
    regulation: "Civil Code maximum for non-bank lending"

  platform_caps:
    minimum_rate: 8.0
    maximum_rate: 36.0
    description: "Platform-enforced rate boundaries"

  grade_specific_caps:
    A: { min: 8.0, max: 12.0 }
    B: { min: 10.0, max: 16.0 }
    C: { min: 13.0, max: 20.0 }
    D: { min: 16.0, max: 26.0 }
    E: { min: 20.0, max: 32.0 }
    F: { min: 26.0, max: 36.0 }

  usury_protection:
    enabled: true
    threshold: 36.0
    action: cap_at_maximum

# =============================================================================
# FEE STRUCTURE
# =============================================================================
fee_structure:
  rule_id: LPR-008
  name: Loan Fee Structure
  name_vi: Cơ cấu phí khoản vay

  origination_fee:
    calculation: percentage
    rates_by_grade:
      A: 2.0
      B: 2.5
      C: 3.0
      D: 3.5
      E: 4.0
      F: 4.5
    minimum: 100000
    maximum: null
    timing: deducted_at_disbursement
    description: "One-time fee for loan processing"

  late_payment_fee:
    calculation: percentage_per_day
    rate: 0.5
    base: overdue_amount
    grace_period: 3
    cap: 15.0
    description: "Daily fee after grace period"

  early_payoff_fee:
    calculation: percentage
    rate: 1.0
    base: remaining_principal
    waived_after_months: 6
    description: "Fee for early loan payoff"

  payment_processing_fee:
    internal_transfer: 0
    bank_transfer: 5500
    card_payment: 22000
    description: "Fee for payment methods"

# =============================================================================
# APR CALCULATION
# =============================================================================
apr_calculation:
  rule_id: LPR-009
  name: APR Calculation Rules
  name_vi: Quy tắc tính APR

  included_in_apr:
    - interest_charges: true
    - origination_fee: true
    - service_fees: true
    - mandatory_insurance: false

  formula: |
    APR = ((Total_Interest + Total_Fees) / Principal) / (Term_Months / 12) * 100

  disclosure:
    required: true
    format: "X.XX% per annum"
    display_location: loan_offer_page
    comparison_with_nominal: true

  example:
    principal: 10000000
    term_months: 12
    nominal_rate: 15.0
    origination_fee: 300000
    total_interest: 1500000
    apr_calculation: "((1500000 + 300000) / 10000000) / 1 * 100 = 18.0%"

# =============================================================================
# RATE LOCK RULES
# =============================================================================
rate_lock:
  rule_id: LPR-010
  name: Rate Lock Rules
  name_vi: Quy tắc khóa lãi suất

  lock_period:
    duration: 7
    unit: days
    description: "Quoted rate valid for 7 days"

  lock_conditions:
    - application_status: approved
    - offer_accepted: true
    - documents_complete: true

  extension:
    allowed: true
    max_extensions: 1
    extension_period: 7
    fee: 0
    conditions:
      - valid_reason_provided: true

  rate_changes:
    if_rate_decreases: borrower_gets_lower_rate
    if_rate_increases: locked_rate_honored

# =============================================================================
# PRICING TRANSPARENCY
# =============================================================================
transparency:
  rule_id: LPR-011
  name: Pricing Transparency Requirements
  name_vi: Yêu cầu minh bạch giá

  required_disclosures:
    - nominal_interest_rate: true
    - apr: true
    - monthly_payment: true
    - total_repayment: true
    - total_interest: true
    - all_fees: true
    - repayment_schedule: true

  display_format:
    rate_format: "X.XX% per annum"
    amount_format: "X,XXX,XXX VND"
    schedule_format: detailed_amortization

  comparison_tools:
    rate_comparison: true
    total_cost_comparison: true
    monthly_payment_calculator: true

# =============================================================================
# AUDIT & COMPLIANCE
# =============================================================================
audit:
  enabled: true
  log_all_pricing_decisions: true
  log_rate_calculations: true
  retention_years: 7

  required_documentation:
    - base_rate_used
    - all_adjustments_applied
    - final_rate_offered
    - borrower_acceptance
    - timestamp
    - pricing_model_version

compliance:
  fair_lending:
    enabled: true
    prohibited_factors:
      - race
      - religion
      - gender
      - ethnicity
      - national_origin
    allowed_factors:
      - credit_score
      - income
      - debt_ratio
      - employment
      - loan_amount
      - loan_term
