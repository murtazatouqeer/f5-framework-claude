name: nextjs
display_name: Next.js
version: 2.0.0
type: tech-stack

description: |
  React framework for production with App Router.
  Server Components, Server Actions, and file-based routing.

  ## Key Features
  - **App Router**: File-based routing with layouts
  - **Server Components**: React components on server by default
  - **Server Actions**: Server mutations from client
  - **Streaming**: Progressive UI rendering with Suspense
  - **Built-in Caching**: Request memoization and data caching

extends:
  - frontend-react

category: frontend
language: typescript
runtime: node

version_support:
  minimum: "14.0"
  recommended: "14.2"
  react: ">=18.2"
  typescript: ">=5.0"

core_concepts:
  app_router: "File-based routing with layouts"
  server_components: "React components on server"
  client_components: "Interactive browser components"
  server_actions: "Server mutations from client"
  route_handlers: "API endpoints"
  middleware: "Request/response interception"
  streaming: "Progressive UI rendering"
  caching: "Built-in request memoization"
  metadata: "SEO and social sharing"
  loading_ui: "Loading and streaming states"

architecture_patterns:
  feature_based:
    description: "Organize by feature with co-location"
    use_when: "Medium to large apps"
  route_groups:
    description: "Logical grouping without URL impact"
    use_when: "Multiple layouts, auth sections"
  parallel_routes:
    description: "Simultaneous route rendering"
    use_when: "Dashboards, modals"
  intercepting_routes:
    description: "Route interception for modals"
    use_when: "Modal navigation patterns"

rendering_strategies:
  static:
    description: "Generated at build time"
    use_when: "Content doesn't change"
  dynamic:
    description: "Rendered per request"
    use_when: "Personalized content"
  streaming:
    description: "Progressive loading"
    use_when: "Large pages with slow data"
  isr:
    description: "Incremental Static Regeneration"
    use_when: "Content updates periodically"

data_fetching:
  server_fetch:
    description: "fetch() in Server Components"
    best_for: "Initial data loading"
  server_actions:
    description: "Form mutations"
    best_for: "Create, update, delete"
  tanstack_query:
    description: "Client-side data management"
    best_for: "Real-time updates, infinite scroll"
  swr:
    description: "Stale-while-revalidate"
    best_for: "Simple client fetching"

testing_stack:
  unit: jest
  component: testing_library
  e2e: playwright
  integration: msw

capabilities:
  language:
    - typescript
    - javascript
  framework:
    - nextjs
    - react
  features:
    - app-router
    - server-components
    - client-components
    - server-actions
    - route-handlers
    - middleware
    - streaming
    - isr
    - static-generation
    - dynamic-rendering
    - parallel-routes
    - intercepting-routes
    - metadata-api
    - image-optimization
    - font-optimization
  styling:
    - tailwindcss
    - css-modules
    - sass
  testing:
    - jest
    - playwright
    - testing-library
    - msw

common_packages:
  core:
    - next
    - react
    - react-dom
    - typescript
    - "@types/node"
    - "@types/react"
    - "@types/react-dom"
  auth:
    - next-auth
    - "@auth/prisma-adapter"
    - "@auth/drizzle-adapter"
  database:
    - prisma
    - "@prisma/client"
    - drizzle-orm
    - "@vercel/postgres"
  state:
    - zustand
    - "@tanstack/react-query"
    - jotai
    - swr
  ui:
    - tailwindcss
    - postcss
    - autoprefixer
    - "@radix-ui/react-*"
    - lucide-react
    - clsx
    - tailwind-merge
    - class-variance-authority
  forms:
    - react-hook-form
    - zod
    - "@hookform/resolvers"
  testing:
    - jest
    - "@testing-library/react"
    - "@testing-library/jest-dom"
    - "@playwright/test"
    - msw
  utilities:
    - date-fns
    - lodash-es
    - sharp
    - server-only
    - client-only

project_structure:
  recommended: |
    app/
    ├── (auth)/                    # Auth route group
    │   ├── login/
    │   │   └── page.tsx
    │   ├── register/
    │   │   └── page.tsx
    │   └── layout.tsx
    ├── (dashboard)/               # Dashboard route group
    │   ├── layout.tsx
    │   ├── page.tsx
    │   └── settings/
    │       └── page.tsx
    ├── api/                       # Route handlers
    │   └── [...route]/
    │       └── route.ts
    ├── layout.tsx                 # Root layout
    ├── page.tsx                   # Home page
    ├── loading.tsx                # Root loading
    ├── error.tsx                  # Root error
    ├── not-found.tsx              # 404 page
    └── globals.css                # Global styles
    components/
    ├── ui/                        # Base UI components
    │   ├── button.tsx
    │   ├── input.tsx
    │   └── card.tsx
    ├── forms/                     # Form components
    └── layouts/                   # Layout components
    lib/
    ├── actions/                   # Server actions
    │   ├── auth.ts
    │   └── users.ts
    ├── db.ts                      # Database client
    ├── auth.ts                    # Auth config
    ├── utils.ts                   # Utilities
    └── validations.ts             # Zod schemas
    types/
    └── index.ts                   # Global types

# Agents for code generation
agents:
  - id: nextjs-page-generator
    file: .claude/agents/stacks/frontend/nextjs/page-generator.md
    triggers:
      - "create page"
      - "generate page"
      - "nextjs page"
      - "next page"

  - id: nextjs-api-route-generator
    file: .claude/agents/stacks/frontend/nextjs/api-route-generator.md
    triggers:
      - "create api"
      - "api route"
      - "route handler"
      - "nextjs api"

  - id: nextjs-component-generator
    file: .claude/agents/stacks/frontend/nextjs/component-generator.md
    triggers:
      - "create component"
      - "nextjs component"
      - "server component"
      - "client component"

  - id: nextjs-server-action-generator
    file: .claude/agents/stacks/frontend/nextjs/server-action-generator.md
    triggers:
      - "server action"
      - "create action"
      - "form action"

  - id: nextjs-test-generator
    file: .claude/agents/stacks/frontend/nextjs/test-generator.md
    triggers:
      - "create test"
      - "nextjs test"
      - "test page"
      - "test component"

# Skills for knowledge and patterns
skills:
  # Architecture
  - name: app-router
    path: .claude/skills/stacks/frontend/nextjs/architecture/app-router.md
    description: Next.js App Router fundamentals
  - name: project-structure
    path: .claude/skills/stacks/frontend/nextjs/architecture/project-structure.md
    description: Next.js project organization
  - name: route-groups
    path: .claude/skills/stacks/frontend/nextjs/architecture/route-groups.md
    description: Route groups and layouts

  # Rendering
  - name: server-components
    path: .claude/skills/stacks/frontend/nextjs/rendering/server-components.md
    description: React Server Components
  - name: client-components
    path: .claude/skills/stacks/frontend/nextjs/rendering/client-components.md
    description: React Client Components
  - name: streaming
    path: .claude/skills/stacks/frontend/nextjs/rendering/streaming.md
    description: Streaming and Suspense
  - name: static-dynamic
    path: .claude/skills/stacks/frontend/nextjs/rendering/static-dynamic.md
    description: Static vs Dynamic rendering

  # Data Fetching
  - name: server-fetching
    path: .claude/skills/stacks/frontend/nextjs/data-fetching/server-fetching.md
    description: Server-side data fetching
  - name: server-actions
    path: .claude/skills/stacks/frontend/nextjs/data-fetching/server-actions.md
    description: Server Actions for mutations
  - name: cache-revalidation
    path: .claude/skills/stacks/frontend/nextjs/data-fetching/cache-revalidation.md
    description: Caching and revalidation
  - name: parallel-sequential
    path: .claude/skills/stacks/frontend/nextjs/data-fetching/parallel-sequential.md
    description: Parallel and sequential fetching

  # Routing
  - name: dynamic-routes
    path: .claude/skills/stacks/frontend/nextjs/routing/dynamic-routes.md
    description: Dynamic route segments
  - name: route-handlers
    path: .claude/skills/stacks/frontend/nextjs/routing/route-handlers.md
    description: API Route Handlers
  - name: middleware
    path: .claude/skills/stacks/frontend/nextjs/routing/middleware.md
    description: Next.js Middleware
  - name: intercepting-routes
    path: .claude/skills/stacks/frontend/nextjs/routing/intercepting-routes.md
    description: Intercepting and parallel routes

  # Auth
  - name: next-auth
    path: .claude/skills/stacks/frontend/nextjs/auth/next-auth.md
    description: NextAuth.js v5 setup
  - name: middleware-auth
    path: .claude/skills/stacks/frontend/nextjs/auth/middleware-auth.md
    description: Authentication middleware
  - name: server-session
    path: .claude/skills/stacks/frontend/nextjs/auth/server-session.md
    description: Server-side session handling

  # Styling
  - name: tailwind-css
    path: .claude/skills/stacks/frontend/nextjs/styling/tailwind-css.md
    description: Tailwind CSS in Next.js
  - name: css-modules
    path: .claude/skills/stacks/frontend/nextjs/styling/css-modules.md
    description: CSS Modules patterns
  - name: fonts-images
    path: .claude/skills/stacks/frontend/nextjs/styling/fonts-images.md
    description: Font and image optimization

  # Testing
  - name: jest-testing
    path: .claude/skills/stacks/frontend/nextjs/testing/jest-testing.md
    description: Jest unit testing
  - name: playwright
    path: .claude/skills/stacks/frontend/nextjs/testing/playwright.md
    description: Playwright E2E testing
  - name: component-testing
    path: .claude/skills/stacks/frontend/nextjs/testing/component-testing.md
    description: Component testing patterns

  # Deployment
  - name: vercel
    path: .claude/skills/stacks/frontend/nextjs/deployment/vercel.md
    description: Vercel deployment
  - name: docker
    path: .claude/skills/stacks/frontend/nextjs/deployment/docker.md
    description: Docker deployment
  - name: edge-runtime
    path: .claude/skills/stacks/frontend/nextjs/deployment/edge-runtime.md
    description: Edge runtime functions

# Templates
templates:
  page: templates/nextjs-page.md
  layout: templates/nextjs-layout.md
  loading: templates/nextjs-loading.md
  error: templates/nextjs-error.md
  route-handler: templates/nextjs-route-handler.md
  server-action: templates/nextjs-server-action.md
  middleware: templates/nextjs-middleware.md
  test: templates/nextjs-test.md

# Examples
examples:
  - name: crud-app
    path: examples/crud-app/example.md
    description: Complete CRUD application with Server Actions
  - name: auth-app
    path: examples/auth-app/example.md
    description: Authentication with NextAuth.js v5

# Quality standards
quality:
  linting:
    - eslint
    - "@typescript-eslint/eslint-plugin"
    - eslint-plugin-react-hooks
    - eslint-config-next
  formatting:
    - prettier
    - prettier-plugin-tailwindcss
  coverage:
    minimum: 80
    tool: jest
