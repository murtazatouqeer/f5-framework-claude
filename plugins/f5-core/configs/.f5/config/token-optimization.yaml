# F5 Token Optimization Configuration
# Version: 1.0.0

# ═══════════════════════════════════════════════════════════════
# VERBOSITY LEVELS
# ═══════════════════════════════════════════════════════════════

verbosity:
  # Default level (1-5)
  default: 3

  levels:
    1:
      name: "ultra-concise"
      name_ja: "超簡潔"
      description: "Minimal output, code only, no explanations"
      rules:
        - "No preamble or postamble"
        - "No explanations unless critical"
        - "Code comments minimal"
        - "Output only what's requested"
        - "Skip confirmations"
      max_tokens: 500

    2:
      name: "concise"
      name_ja: "簡潔"
      description: "Brief explanations, focused output"
      rules:
        - "Brief 1-2 sentence explanations"
        - "Essential code comments only"
        - "No verbose descriptions"
        - "Skip obvious details"
      max_tokens: 1000

    3:
      name: "balanced"
      name_ja: "バランス"
      description: "Standard output with context"
      rules:
        - "Moderate explanations"
        - "Helpful code comments"
        - "Include relevant context"
        - "Clear structure"
      max_tokens: 2000

    4:
      name: "detailed"
      name_ja: "詳細"
      description: "Comprehensive explanations"
      rules:
        - "Full explanations"
        - "Detailed code comments"
        - "Include alternatives"
        - "Step-by-step guidance"
      max_tokens: 4000

    5:
      name: "comprehensive"
      name_ja: "包括的"
      description: "Maximum detail, educational"
      rules:
        - "In-depth explanations"
        - "Background context"
        - "Multiple approaches"
        - "Best practices discussion"
        - "Related concepts"
      max_tokens: 8000

# ═══════════════════════════════════════════════════════════════
# CONTEXT-AWARE OPTIMIZATION
# ═══════════════════════════════════════════════════════════════

context_rules:
  # Auto-adjust verbosity based on context
  auto_adjust: true

  adjustments:
    # Code generation
    code_generation:
      default_level: 2
      increase_when:
        - "user asks for explanation"
        - "complex algorithm"
        - "security-sensitive code"
      decrease_when:
        - "simple CRUD"
        - "boilerplate code"
        - "user says 'just code'"

    # Bug fixing
    debugging:
      default_level: 3
      increase_when:
        - "complex bug"
        - "user confused"
        - "security issue"
      decrease_when:
        - "obvious fix"
        - "typo correction"

    # Architecture/design
    architecture:
      default_level: 4
      increase_when:
        - "new system design"
        - "critical decisions"
      decrease_when:
        - "simple changes"

    # Quick questions
    quick_answer:
      default_level: 1
      triggers:
        - "what is"
        - "how to"
        - "quick question"
        - "just tell me"

    # Teaching/mentoring
    teaching:
      default_level: 5
      triggers:
        - "explain"
        - "teach me"
        - "why does"
        - "help me understand"

# ═══════════════════════════════════════════════════════════════
# OUTPUT OPTIMIZATION RULES
# ═══════════════════════════════════════════════════════════════

output_rules:
  # Eliminate redundancy
  no_redundancy:
    - "Don't repeat the question"
    - "Don't state obvious facts"
    - "Don't explain what user already knows"
    - "Don't add unnecessary acknowledgments"

  # Structural optimization
  structure:
    - "Use headers only when needed"
    - "Use lists only for 3+ items"
    - "Use tables for comparisons"
    - "Use code blocks appropriately"

  # Remove fluff
  eliminate:
    - "I'd be happy to..."
    - "Sure, I can..."
    - "Let me explain..."
    - "Here's what I think..."
    - "Based on my understanding..."
    - "In conclusion..."
    - "To summarize..."
    - "Great question!"
    - "That's a good point..."

  # Code output
  code_output:
    - "Include only changed code unless full file requested"
    - "Use diff format for modifications"
    - "Skip imports if obvious"
    - "Minimize comments in level 1-2"

# ═══════════════════════════════════════════════════════════════
# SMART TRUNCATION
# ═══════════════════════════════════════════════════════════════

truncation:
  enabled: true

  strategies:
    # For long lists
    lists:
      max_items: 10
      show_more_text: "... and {n} more"

    # For code
    code:
      max_lines: 100
      truncate_middle: true
      show_indicator: "// ... ({n} lines omitted)"

    # For explanations
    explanations:
      max_paragraphs: 3
      at_level: [1, 2]

# ═══════════════════════════════════════════════════════════════
# RESPONSE TEMPLATES
# ═══════════════════════════════════════════════════════════════

templates:
  # Ultra-concise code response
  code_only:
    format: |
      ```{language}
      {code}
      ```
    when: "verbosity <= 2 AND code_request"

  # With brief explanation
  code_brief:
    format: |
      {one_line_summary}

      ```{language}
      {code}
      ```
    when: "verbosity == 3 AND code_request"

  # Full response
  code_detailed:
    format: |
      ## {title}

      {explanation}

      ```{language}
      {code}
      ```

      ### Notes
      {notes}
    when: "verbosity >= 4 AND code_request"

  # Error response
  error_concise:
    format: |
      **Error:** {error_type}
      **Fix:** {fix}
    when: "verbosity <= 2 AND error_response"

  # Error detailed
  error_detailed:
    format: |
      ## Error Analysis

      **Type:** {error_type}
      **Cause:** {cause}

      ### Solution
      {solution}

      ### Prevention
      {prevention}
    when: "verbosity >= 3 AND error_response"

# ═══════════════════════════════════════════════════════════════
# USER PREFERENCES OVERRIDE
# ═══════════════════════════════════════════════════════════════

user_overrides:
  # Keywords to increase verbosity
  increase_triggers:
    - "explain in detail"
    - "comprehensive"
    - "full explanation"
    - "teach me"
    - "verbose"
    - "step by step"

  # Keywords to decrease verbosity
  decrease_triggers:
    - "just code"
    - "code only"
    - "brief"
    - "quick"
    - "tl;dr"
    - "concise"
    - "no explanation"
    - "short"

  # Explicit level setting
  explicit_patterns:
    - pattern: "verbosity {n}"
      action: "set_level({n})"
    - pattern: "--brief"
      action: "set_level(1)"
    - pattern: "--verbose"
      action: "set_level(5)"
    - pattern: "--v{n}"
      action: "set_level({n})"

# ═══════════════════════════════════════════════════════════════
# GATE-SPECIFIC OPTIMIZATION
# ═══════════════════════════════════════════════════════════════

gate_optimization:
  D1:
    default_level: 4
    focus: "research, analysis"
  D2:
    default_level: 4
    focus: "requirements, specifications"
  D3:
    default_level: 4
    focus: "architecture, design decisions"
  D4:
    default_level: 3
    focus: "detailed design, API specs"
  G2:
    default_level: 2
    focus: "implementation, code"
  G3:
    default_level: 3
    focus: "testing, coverage"
  G4:
    default_level: 3
    focus: "deployment, operations"

# ═══════════════════════════════════════════════════════════════
# JAPANESE LANGUAGE OPTIMIZATION
# ═══════════════════════════════════════════════════════════════

japanese_optimization:
  enabled: true

  # Japanese tends to be more concise
  level_adjustment: -1

  # Keep technical terms in English
  preserve_technical_terms: true

  # Use polite form (desu/masu)
  politeness_level: "polite"
