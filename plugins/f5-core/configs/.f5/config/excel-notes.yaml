# ═══════════════════════════════════════════════════════════════
# Excel Note Pattern Configuration
# ═══════════════════════════════════════════════════════════════
# Supports multiple note styles used by different designers
# This file can be customized per project
# ═══════════════════════════════════════════════════════════════

version: "1.0.0"

# ─────────────────────────────────────────────────────────────────
# NOTE REFERENCE PATTERNS
# ─────────────────────────────────────────────────────────────────
# These patterns indicate a note reference in cell content
# Priority determines which pattern is checked first

reference_patterns:
  # Japanese style: ※1, ※2, etc.
  - pattern: "※(\\d+)"
    name: "japanese_kome"
    priority: 1

  # Asterisk style: *1, *2, etc.
  - pattern: "\\*(\\d+)"
    name: "asterisk"
    priority: 2

  # Japanese note: (注1), (注2), etc.
  - pattern: "\\(注(\\d+)\\)"
    name: "japanese_chu"
    priority: 3

  # Bracketed: [1], [2], etc.
  - pattern: "\\[(\\d+)\\]"
    name: "bracketed"
    priority: 4

  # Superscript style: ¹, ², ³ (if copied from Word)
  - pattern: "([¹²³⁴⁵⁶⁷⁸⁹⁰]+)"
    name: "superscript"
    priority: 5

  # Arrow style: →1, →2
  - pattern: "→(\\d+)"
    name: "arrow"
    priority: 6

  # Double asterisk: **1, **2
  - pattern: "\\*\\*(\\d+)"
    name: "double_asterisk"
    priority: 7

# ─────────────────────────────────────────────────────────────────
# NOTE DEFINITION PATTERNS
# ─────────────────────────────────────────────────────────────────
# Where notes are defined (usually at bottom of sheet or in specific columns)

definition_patterns:
  # Japanese: ※1: description or ※1：description
  - pattern: "^※(\\d+)[：:]\\s*(.+)$"
    name: "japanese_kome_def"

  # Asterisk: *1: description
  - pattern: "^\\*(\\d+)[：:]\\s*(.+)$"
    name: "asterisk_def"

  # Japanese: (注1) description or (注1): description
  - pattern: "^\\(注(\\d+)\\)[：:]?\\s*(.+)$"
    name: "japanese_chu_def"

  # Bracketed: [1] description or [1]: description
  - pattern: "^\\[(\\d+)\\][：:]?\\s*(.+)$"
    name: "bracketed_def"

  # Arrow: →1: description
  - pattern: "^→(\\d+)[：:]\\s*(.+)$"
    name: "arrow_def"

  # Note without colon: ※1 description
  - pattern: "^※(\\d+)\\s+(.+)$"
    name: "japanese_kome_space"

# ─────────────────────────────────────────────────────────────────
# OUTPUT FORMAT
# ─────────────────────────────────────────────────────────────────

output:
  # Markdown footnote format
  # Options: footnote | inline | section
  format: "footnote"

  # Section title for notes (by language)
  section_title:
    ja: "注釈 (Notes)"
    en: "Notes"
    vi: "Ghi chú"

  # Include original marker in output
  # If true: "Value ※1 [^1]"
  # If false: "Value [^1]"
  preserve_original_marker: false

  # Footnote prefix (used in [^1] format)
  footnote_prefix: "^"

# ─────────────────────────────────────────────────────────────────
# AUTO-DETECTION SETTINGS
# ─────────────────────────────────────────────────────────────────

auto_detect:
  enabled: true

  # Scan these areas for note definitions
  scan_areas:
    - "bottom_rows"      # Last N rows of sheet
    - "right_columns"    # Columns after main content
    - "all_cells"        # Scan all cells
    - "separate_sheet"   # Sheet named "Notes" or "注釈"

  # Maximum rows from bottom to scan for notes
  bottom_rows_count: 30

  # Columns to check for note definitions
  note_columns: ["A", "B", "C"]

  # Sheet names that might contain note definitions
  note_sheet_names:
    - "Notes"
    - "注釈"
    - "備考"
    - "Footnotes"

# ─────────────────────────────────────────────────────────────────
# SPECIAL HANDLING
# ─────────────────────────────────────────────────────────────────

special:
  # Handle notes in merged cells
  handle_merged_cells: true

  # Handle notes in cell comments
  include_cell_comments: true

  # Strip note markers from SQL/code blocks
  strip_from_code: false

  # Maximum note ID to prevent false positives
  max_note_id: 99
