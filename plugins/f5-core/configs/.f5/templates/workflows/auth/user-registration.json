{
  "id": "f5-auth-user-registration",
  "name": "User Registration Workflow",
  "description": "Complete user registration flow with email validation, password strength check, and account activation",
  "version": "1.0.0",
  "f5Metadata": {
    "domain": "auth",
    "category": "registration",
    "complexity": "medium",
    "estimatedDuration": "15-20 minutes",
    "requiredSkills": ["f5-backend", "f5-db", "f5-test"],
    "mcpServers": ["github", "sequential-thinking", "serena"],
    "qualityGates": ["D3", "G2", "G3"],
    "argumentHint": "Implement user registration for {{projectName}} with email verification"
  },
  "nodes": [
    {
      "id": "start-1",
      "type": "start",
      "position": { "x": 250, "y": 50 },
      "data": {
        "label": "Start Registration"
      }
    },
    {
      "id": "prompt-validate-input",
      "type": "prompt",
      "position": { "x": 250, "y": 150 },
      "data": {
        "label": "Validate Registration Input",
        "description": "Validate user registration input data",
        "prompt": "Validate the following registration data:\n- Email format and uniqueness\n- Password strength (min 8 chars, uppercase, lowercase, number, special)\n- Username availability\n- Required fields completeness\n\nReturn validation result with specific error messages for each failed check.",
        "outputPorts": ["validated", "invalid"]
      }
    },
    {
      "id": "ifelse-valid",
      "type": "ifElse",
      "position": { "x": 250, "y": 280 },
      "data": {
        "label": "Input Valid?",
        "description": "Check if registration input passed validation",
        "condition": "Check if all validation rules passed without errors"
      }
    },
    {
      "id": "subagent-create-user",
      "type": "subAgent",
      "position": { "x": 100, "y": 410 },
      "data": {
        "label": "Create User Account",
        "description": "Create new user account in database with hashed password",
        "prompt": "Create a new user account:\n1. Hash the password using bcrypt with salt rounds 12\n2. Generate unique user ID (UUID v4)\n3. Store user in database with status 'pending_verification'\n4. Create email verification token (expires in 24 hours)\n5. Return user ID and verification token",
        "agentType": "backend-architect",
        "outputPorts": ["success", "error"]
      }
    },
    {
      "id": "prompt-error-response",
      "type": "prompt",
      "position": { "x": 400, "y": 410 },
      "data": {
        "label": "Return Validation Error",
        "description": "Format and return validation error response",
        "prompt": "Format the validation errors into a user-friendly response:\n- List each validation failure with field name\n- Provide actionable guidance for fixing each error\n- Return HTTP 400 with structured error response",
        "outputPorts": ["done"]
      }
    },
    {
      "id": "mcp-send-verification",
      "type": "mcp",
      "position": { "x": 100, "y": 540 },
      "data": {
        "label": "Send Verification Email",
        "description": "Send email verification link to user",
        "serverName": "github",
        "toolName": "create_issue",
        "mode": "structured",
        "parameters": {
          "title": "Email Verification Required",
          "body": "Verification email sent to user with activation link"
        },
        "outputPorts": ["sent", "failed"]
      }
    },
    {
      "id": "qualitygate-g2",
      "type": "qualityGate",
      "position": { "x": 100, "y": 670 },
      "data": {
        "label": "G2: Implementation Complete",
        "description": "Verify registration implementation meets quality standards",
        "gateId": "G2",
        "gateName": "Implementation Gate",
        "checklistItems": [
          "Password hashing implemented correctly",
          "Email validation logic complete",
          "Database schema created",
          "Error handling comprehensive"
        ],
        "outputPorts": ["passed", "failed"]
      }
    },
    {
      "id": "prompt-success-response",
      "type": "prompt",
      "position": { "x": 100, "y": 800 },
      "data": {
        "label": "Return Success Response",
        "description": "Format successful registration response",
        "prompt": "Create success response for user registration:\n- Return HTTP 201 Created\n- Include user ID (exclude sensitive data)\n- Include message about verification email\n- Provide next steps for account activation",
        "outputPorts": ["done"]
      }
    },
    {
      "id": "end-success",
      "type": "end",
      "position": { "x": 100, "y": 930 },
      "data": {
        "label": "Registration Complete"
      }
    },
    {
      "id": "end-error",
      "type": "end",
      "position": { "x": 400, "y": 540 },
      "data": {
        "label": "Registration Failed"
      }
    }
  ],
  "connections": [
    {
      "id": "conn-1",
      "source": "start-1",
      "target": "prompt-validate-input",
      "sourceHandle": "output",
      "targetHandle": "input"
    },
    {
      "id": "conn-2",
      "source": "prompt-validate-input",
      "target": "ifelse-valid",
      "sourceHandle": "output-validated",
      "targetHandle": "input"
    },
    {
      "id": "conn-3",
      "source": "ifelse-valid",
      "target": "subagent-create-user",
      "sourceHandle": "branch-0",
      "targetHandle": "input",
      "label": "Valid"
    },
    {
      "id": "conn-4",
      "source": "ifelse-valid",
      "target": "prompt-error-response",
      "sourceHandle": "branch-1",
      "targetHandle": "input",
      "label": "Invalid"
    },
    {
      "id": "conn-5",
      "source": "subagent-create-user",
      "target": "mcp-send-verification",
      "sourceHandle": "output-success",
      "targetHandle": "input"
    },
    {
      "id": "conn-6",
      "source": "mcp-send-verification",
      "target": "qualitygate-g2",
      "sourceHandle": "output-sent",
      "targetHandle": "input"
    },
    {
      "id": "conn-7",
      "source": "qualitygate-g2",
      "target": "prompt-success-response",
      "sourceHandle": "branch-0",
      "targetHandle": "input"
    },
    {
      "id": "conn-8",
      "source": "prompt-success-response",
      "target": "end-success",
      "sourceHandle": "output-done",
      "targetHandle": "input"
    },
    {
      "id": "conn-9",
      "source": "prompt-error-response",
      "target": "end-error",
      "sourceHandle": "output-done",
      "targetHandle": "input"
    }
  ]
}
