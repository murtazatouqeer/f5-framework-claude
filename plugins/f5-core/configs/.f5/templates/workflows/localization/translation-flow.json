{
  "id": "f5-localization-translation",
  "name": "Translation Management Workflow",
  "description": "Multi-language content management with translation memory and quality checks",
  "version": "1.0.0",
  "f5Metadata": {
    "domain": "localization",
    "category": "translation",
    "complexity": "medium",
    "estimatedDuration": "20-25 minutes",
    "requiredSkills": ["f5-backend", "f5-frontend"],
    "mcpServers": ["context7", "serena"],
    "qualityGates": ["D3", "G2", "G3"],
    "argumentHint": "Implement multi-language translation management for {{projectName}}"
  },
  "nodes": [
    {
      "id": "start-1",
      "type": "start",
      "position": { "x": 300, "y": 50 },
      "data": {
        "label": "Translation Request"
      }
    },
    {
      "id": "switch-operation",
      "type": "switch",
      "position": { "x": 300, "y": 150 },
      "data": {
        "label": "Translation Operation",
        "description": "Route to translation operation",
        "evaluationTarget": "Type of translation operation",
        "cases": [
          { "id": "case-add", "label": "Add Content", "condition": "New content for translation" },
          { "id": "case-translate", "label": "Translate", "condition": "Translate to target language" },
          { "id": "case-review", "label": "Review", "condition": "Review translation quality" },
          { "id": "case-publish", "label": "Publish", "condition": "Publish translations" }
        ]
      }
    },
    {
      "id": "subagent-extract-content",
      "type": "subAgent",
      "position": { "x": 50, "y": 320 },
      "data": {
        "label": "Extract Source Content",
        "description": "Extract translatable content from source",
        "prompt": "Extract content:\n1. Parse source for translatable strings\n2. Extract with context (component, page)\n3. Identify placeholders and variables\n4. Detect plural forms\n5. Create translation keys\n6. Return extracted content map",
        "agentType": "backend-architect",
        "outputPorts": ["extracted"]
      }
    },
    {
      "id": "subagent-check-tm",
      "type": "subAgent",
      "position": { "x": 200, "y": 320 },
      "data": {
        "label": "Check Translation Memory",
        "description": "Look up existing translations",
        "prompt": "Check TM:\n1. Query translation memory for matches\n2. Calculate match percentages\n3. Return exact matches (100%)\n4. Return fuzzy matches (75-99%)\n5. Flag new strings requiring translation\n6. Return TM lookup results",
        "agentType": "backend-architect",
        "outputPorts": ["found", "not_found"]
      }
    },
    {
      "id": "subagent-review-translation",
      "type": "subAgent",
      "position": { "x": 350, "y": 320 },
      "data": {
        "label": "Review Translation",
        "description": "Quality check translation",
        "prompt": "Review translation:\n1. Check for placeholder preservation\n2. Check length constraints\n3. Check terminology consistency\n4. Check grammar/spelling\n5. Check cultural appropriateness\n6. Return review status with issues",
        "agentType": "quality-engineer",
        "outputPorts": ["approved", "needs_revision"]
      }
    },
    {
      "id": "subagent-publish-translations",
      "type": "subAgent",
      "position": { "x": 500, "y": 320 },
      "data": {
        "label": "Publish Translations",
        "description": "Deploy translations to production",
        "prompt": "Publish translations:\n1. Validate all required languages present\n2. Generate locale bundles\n3. Deploy to CDN/storage\n4. Invalidate caches\n5. Update version manifest\n6. Return publish confirmation",
        "agentType": "backend-architect",
        "outputPorts": ["published", "incomplete"]
      }
    },
    {
      "id": "askuser-translate",
      "type": "askUserQuestion",
      "position": { "x": 200, "y": 480 },
      "data": {
        "label": "Translation Method",
        "description": "Choose translation method for new strings",
        "question": "How should new strings be translated?",
        "selectionMode": "predefined",
        "options": [
          {
            "id": "machine",
            "label": "Machine Translation",
            "description": "Use AI/MT for initial translation"
          },
          {
            "id": "human",
            "label": "Human Translation",
            "description": "Queue for professional translator"
          },
          {
            "id": "crowdsource",
            "label": "Crowdsource",
            "description": "Use community translations"
          }
        ],
        "multiSelect": false
      }
    },
    {
      "id": "mcp-store-translations",
      "type": "mcp",
      "position": { "x": 300, "y": 620 },
      "data": {
        "label": "Store Translations",
        "description": "Store translations in database",
        "serverName": "serena",
        "toolName": "write_memory",
        "mode": "structured",
        "parameters": {
          "memory_file_name": "translations",
          "content": "Translations stored with metadata and status"
        },
        "outputPorts": ["stored"]
      }
    },
    {
      "id": "subagent-update-tm",
      "type": "subAgent",
      "position": { "x": 300, "y": 760 },
      "data": {
        "label": "Update Translation Memory",
        "description": "Update TM with approved translations",
        "prompt": "Update TM:\n1. Add new translation pairs\n2. Update match scores\n3. Index for fuzzy matching\n4. Track translation history\n5. Update term base if needed",
        "agentType": "backend-architect",
        "outputPorts": ["updated"]
      }
    },
    {
      "id": "qualitygate-g3",
      "type": "qualityGate",
      "position": { "x": 300, "y": 900 },
      "data": {
        "label": "G3: Testing Gate",
        "description": "Verify localization implementation",
        "gateId": "G3",
        "gateName": "Testing Complete",
        "checklistItems": [
          "All strings extracted correctly",
          "Translation memory functional",
          "Quality checks passing",
          "Locale bundles generated",
          "RTL languages supported"
        ],
        "outputPorts": ["passed", "failed"]
      }
    },
    {
      "id": "prompt-success",
      "type": "prompt",
      "position": { "x": 300, "y": 1030 },
      "data": {
        "label": "Return Success",
        "description": "Return translation operation result",
        "prompt": "Return success:\n- Include operation type\n- Include affected languages\n- Include string counts\n- Include quality metrics\n- Include next steps if any",
        "outputPorts": ["done"]
      }
    },
    {
      "id": "end-success",
      "type": "end",
      "position": { "x": 300, "y": 1160 },
      "data": {
        "label": "Translation Complete"
      }
    }
  ],
  "connections": [
    {
      "id": "conn-1",
      "source": "start-1",
      "target": "switch-operation",
      "sourceHandle": "output",
      "targetHandle": "input"
    },
    {
      "id": "conn-2",
      "source": "switch-operation",
      "target": "subagent-extract-content",
      "sourceHandle": "case-add",
      "targetHandle": "input"
    },
    {
      "id": "conn-3",
      "source": "switch-operation",
      "target": "subagent-check-tm",
      "sourceHandle": "case-translate",
      "targetHandle": "input"
    },
    {
      "id": "conn-4",
      "source": "switch-operation",
      "target": "subagent-review-translation",
      "sourceHandle": "case-review",
      "targetHandle": "input"
    },
    {
      "id": "conn-5",
      "source": "switch-operation",
      "target": "subagent-publish-translations",
      "sourceHandle": "case-publish",
      "targetHandle": "input"
    },
    {
      "id": "conn-6",
      "source": "subagent-extract-content",
      "target": "mcp-store-translations",
      "sourceHandle": "output-extracted",
      "targetHandle": "input"
    },
    {
      "id": "conn-7",
      "source": "subagent-check-tm",
      "target": "askuser-translate",
      "sourceHandle": "output-not_found",
      "targetHandle": "input"
    },
    {
      "id": "conn-8",
      "source": "subagent-check-tm",
      "target": "mcp-store-translations",
      "sourceHandle": "output-found",
      "targetHandle": "input"
    },
    {
      "id": "conn-9",
      "source": "askuser-translate",
      "target": "mcp-store-translations",
      "sourceHandle": "output-machine",
      "targetHandle": "input"
    },
    {
      "id": "conn-10",
      "source": "subagent-review-translation",
      "target": "subagent-update-tm",
      "sourceHandle": "output-approved",
      "targetHandle": "input"
    },
    {
      "id": "conn-11",
      "source": "subagent-publish-translations",
      "target": "qualitygate-g3",
      "sourceHandle": "output-published",
      "targetHandle": "input"
    },
    {
      "id": "conn-12",
      "source": "mcp-store-translations",
      "target": "subagent-update-tm",
      "sourceHandle": "output-stored",
      "targetHandle": "input"
    },
    {
      "id": "conn-13",
      "source": "subagent-update-tm",
      "target": "qualitygate-g3",
      "sourceHandle": "output-updated",
      "targetHandle": "input"
    },
    {
      "id": "conn-14",
      "source": "qualitygate-g3",
      "target": "prompt-success",
      "sourceHandle": "branch-0",
      "targetHandle": "input"
    },
    {
      "id": "conn-15",
      "source": "prompt-success",
      "target": "end-success",
      "sourceHandle": "output-done",
      "targetHandle": "input"
    }
  ]
}
