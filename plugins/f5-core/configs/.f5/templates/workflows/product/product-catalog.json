{
  "id": "f5-product-catalog",
  "name": "Product Catalog Management Workflow",
  "description": "Product catalog operations with categories, variants, pricing, and inventory sync",
  "version": "1.0.0",
  "f5Metadata": {
    "domain": "product",
    "category": "catalog",
    "complexity": "medium",
    "estimatedDuration": "20-25 minutes",
    "requiredSkills": ["f5-backend", "f5-db", "f5-frontend"],
    "mcpServers": ["serena", "context7", "github"],
    "qualityGates": ["D3", "G2", "G3"],
    "argumentHint": "Implement product catalog management for {{projectName}}"
  },
  "nodes": [
    {
      "id": "start-1",
      "type": "start",
      "position": { "x": 300, "y": 50 },
      "data": {
        "label": "Start Product Operation"
      }
    },
    {
      "id": "switch-operation",
      "type": "switch",
      "position": { "x": 300, "y": 150 },
      "data": {
        "label": "Product Operation",
        "description": "Route to product catalog operation",
        "evaluationTarget": "Requested product operation",
        "cases": [
          { "id": "case-create", "label": "Create Product", "condition": "New product creation" },
          { "id": "case-update", "label": "Update Product", "condition": "Product modification" },
          { "id": "case-list", "label": "List Products", "condition": "Catalog listing with filters" },
          { "id": "case-pricing", "label": "Update Pricing", "condition": "Price management" }
        ]
      }
    },
    {
      "id": "subagent-create-product",
      "type": "subAgent",
      "position": { "x": 50, "y": 320 },
      "data": {
        "label": "Create Product",
        "description": "Create new product with variants and categories",
        "prompt": "Create product:\n1. Validate product data schema\n2. Generate SKU based on category pattern\n3. Create product with metadata\n4. Create product variants (size, color, etc.)\n5. Assign to categories\n6. Set initial pricing\n7. Create inventory records\n8. Index for search\n9. Return created product with all relations",
        "agentType": "backend-architect",
        "outputPorts": ["success", "validation_error"]
      }
    },
    {
      "id": "subagent-update-product",
      "type": "subAgent",
      "position": { "x": 200, "y": 320 },
      "data": {
        "label": "Update Product",
        "description": "Update product with version control",
        "prompt": "Update product:\n1. Find product by ID\n2. Validate update payload\n3. Check for breaking changes to variants\n4. Apply updates with optimistic locking\n5. Update search index\n6. Invalidate related caches\n7. Trigger webhook for catalog sync\n8. Return updated product",
        "agentType": "backend-architect",
        "outputPorts": ["success", "not_found", "conflict"]
      }
    },
    {
      "id": "subagent-list-products",
      "type": "subAgent",
      "position": { "x": 350, "y": 320 },
      "data": {
        "label": "List Products",
        "description": "Query products with filtering, sorting, pagination",
        "prompt": "List products:\n1. Parse filter parameters (category, price range, attributes)\n2. Build optimized query with indexes\n3. Apply sorting (relevance, price, newest)\n4. Apply pagination (cursor-based for performance)\n5. Include aggregations for faceted search\n6. Return products with total count and facets",
        "agentType": "backend-architect",
        "outputPorts": ["success"]
      }
    },
    {
      "id": "subagent-update-pricing",
      "type": "subAgent",
      "position": { "x": 500, "y": 320 },
      "data": {
        "label": "Update Pricing",
        "description": "Manage product pricing with rules and tiers",
        "prompt": "Update pricing:\n1. Validate pricing rules\n2. Apply base price updates\n3. Calculate tiered pricing\n4. Apply promotional pricing if active\n5. Update currency conversions\n6. Schedule future price changes\n7. Update price history\n8. Return updated pricing structure",
        "agentType": "backend-architect",
        "outputPorts": ["success", "validation_error"]
      }
    },
    {
      "id": "mcp-sync-inventory",
      "type": "mcp",
      "position": { "x": 300, "y": 480 },
      "data": {
        "label": "Sync Inventory",
        "description": "Synchronize inventory levels after product changes",
        "serverName": "serena",
        "toolName": "search_for_pattern",
        "mode": "structured",
        "parameters": {
          "substring_pattern": "inventory.*sync",
          "relative_path": "src/services"
        },
        "outputPorts": ["synced"]
      }
    },
    {
      "id": "prompt-format-response",
      "type": "prompt",
      "position": { "x": 300, "y": 610 },
      "data": {
        "label": "Format Catalog Response",
        "description": "Format product response with related data",
        "prompt": "Format product response:\n- Include product details with variants\n- Include pricing information\n- Include inventory status\n- Include category hierarchy\n- Include related products\n- Add cache headers for CDN",
        "outputPorts": ["done"]
      }
    },
    {
      "id": "qualitygate-g2",
      "type": "qualityGate",
      "position": { "x": 300, "y": 740 },
      "data": {
        "label": "G2: Implementation Gate",
        "description": "Verify product catalog implementation",
        "gateId": "G2",
        "gateName": "Implementation Complete",
        "checklistItems": [
          "Product CRUD operations functional",
          "Category management working",
          "Variant handling correct",
          "Pricing calculations accurate",
          "Search indexing configured"
        ],
        "outputPorts": ["passed", "failed"]
      }
    },
    {
      "id": "end-success",
      "type": "end",
      "position": { "x": 300, "y": 870 },
      "data": {
        "label": "Product Operation Complete"
      }
    }
  ],
  "connections": [
    {
      "id": "conn-1",
      "source": "start-1",
      "target": "switch-operation",
      "sourceHandle": "output",
      "targetHandle": "input"
    },
    {
      "id": "conn-2",
      "source": "switch-operation",
      "target": "subagent-create-product",
      "sourceHandle": "case-create",
      "targetHandle": "input"
    },
    {
      "id": "conn-3",
      "source": "switch-operation",
      "target": "subagent-update-product",
      "sourceHandle": "case-update",
      "targetHandle": "input"
    },
    {
      "id": "conn-4",
      "source": "switch-operation",
      "target": "subagent-list-products",
      "sourceHandle": "case-list",
      "targetHandle": "input"
    },
    {
      "id": "conn-5",
      "source": "switch-operation",
      "target": "subagent-update-pricing",
      "sourceHandle": "case-pricing",
      "targetHandle": "input"
    },
    {
      "id": "conn-6",
      "source": "subagent-create-product",
      "target": "mcp-sync-inventory",
      "sourceHandle": "output-success",
      "targetHandle": "input"
    },
    {
      "id": "conn-7",
      "source": "subagent-update-product",
      "target": "mcp-sync-inventory",
      "sourceHandle": "output-success",
      "targetHandle": "input"
    },
    {
      "id": "conn-8",
      "source": "subagent-list-products",
      "target": "prompt-format-response",
      "sourceHandle": "output-success",
      "targetHandle": "input"
    },
    {
      "id": "conn-9",
      "source": "subagent-update-pricing",
      "target": "mcp-sync-inventory",
      "sourceHandle": "output-success",
      "targetHandle": "input"
    },
    {
      "id": "conn-10",
      "source": "mcp-sync-inventory",
      "target": "prompt-format-response",
      "sourceHandle": "output-synced",
      "targetHandle": "input"
    },
    {
      "id": "conn-11",
      "source": "prompt-format-response",
      "target": "qualitygate-g2",
      "sourceHandle": "output-done",
      "targetHandle": "input"
    },
    {
      "id": "conn-12",
      "source": "qualitygate-g2",
      "target": "end-success",
      "sourceHandle": "branch-0",
      "targetHandle": "input"
    }
  ]
}
